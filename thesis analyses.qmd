---
title: "Bioanthropological Analyses of Amvrakia (6th–2nd BC)"
author: "Kiriakos Xanthopoulos ([emailme](mailto:ancbiosoc@gmail.com))"
date: "`r Sys.Date()`"
lang: el
format: 
  html:
    toc: true
    toc-depth: 3
    number-sections: true
    theme: cosmo
  pdf:
    number-sections: true
  docx:
    number-sections: true
bibliography: Kirix_Zotero_Library.bib
editor: visual
---

## Καθορισμός εργασιακού περιβάλλοντος και δεδομένων

Δημιουργήθηκε ένα περιβάλλον εργασίας όπου ορίζεται ο φάκελος των σχετικών αρχείων και ο φάκελος της βιβλιοθήκης R packages. Ορίσαμε να φαίνονται 15000 εγγραφές όποτε καλούμε μία εντολή αποτελεσμάτων για να έχουμε καλύτερη εποπτική εικόνα των δεδομένων. Τα απαραίτητα packages της R ομαδοποιήθηκαν, εγακταστάθηκαν και κλήθηκαν.

```{r}
# SET WORKING ENVIRONMENT
setwd("C:/Users/kirix/Dropbox/APOIKIA/osteor") ### Change it according to your folder setup. You may need to set it through tools -> global options -> basic
getwd()

## Set location of personal library folder after checking library path
.libPaths()
.libPaths("C:/Users/kirix/AppData/Local/R/win-library/4.4")

## set the max print
options(max.print = 15000)

## group required pkgs
dataset_pkgs <- c("broom.helpers", "cardx", "CCA", "cluster", "corrplot", "cowplot", "dplyr", "FactoMineR", "factoextra", "forcats", "ggeffects", "ggforce", "ggplot2", "graphics","grid", "gtsummary", "Hmisc", "huxtable", "officer", "pls", "plotly", "png", "psych", "randomForest", "RColorBrewer", "readxl", "scales", "stats", "stringi", "stringr", "svglite", "tidyselect", "tidyverse", "writexl") ### install required pkgs with install.packages(dataset_pkgs) on the console before loading them

## load required pkgs
lapply(dataset_pkgs, library, character.only=TRUE)
```

## Βάση Δεδομένων

Το πρωτόκολλο καταγραφής δεδομένων περιλαμβάνει:

### Ανασκαφικά δεδομένα

```{r}
Δελτίο_Καταγραφής <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/Δελτίο Καταγραφής.xlsx")

Δελτίο_Καταγραφής_clean <- Δελτίο_Καταγραφής %>%
dplyr::select(-c(2,3, 5, 10, 14:22, 24))
```

### Αρχαιολογική χρονολόγηση

```{r}
Αρχαιολογική_Τεκμηρίωση <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/Αρχαιολογική Τεκμηρίωση.xlsx")

Αρχαιολογική_Τεκμηρίωση_clean <- Αρχαιολογική_Τεκμηρίωση %>%
dplyr::select(-c(2:11, 15))
```

### Κατάσταση σκελετού και δεδομένα δειγματοληψίας

```{r}
Δελτίο_Συντήρησης <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/Δελτίο Συντήρησης.xlsx")

Δελτίο_Συντήρησης_clean <- Δελτίο_Συντήρησης %>%
dplyr::select(-c(2, 3, 11, 14:24))
```

### Πληρότητα σκελετού

```{r}
Inventory_Recording_Form <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/Inventory Recording Form.xlsx")

Inventory_Recording_Form_clean <- Inventory_Recording_Form %>%
dplyr::select(-c(2, 3))
```

### Εκτίμηση ηλικίας

```{r}
Age_Estimation <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/1_DEMOGRAPHY/Age Estimation.xlsx")

Age_Estimation_clean <- Age_Estimation %>%
dplyr::select(-c(2, 3))
```

### Προσδιορισμό φύλου

```{r}
Sex_Determination <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/1_DEMOGRAPHY/Sex Determination.xlsx")

Sex_Determination_clean <- Sex_Determination %>%
dplyr::select(-c(2, 3, 5:35))
```

### Καταγραφή παθολογικών ενδείξεων

```{r}
# Non Dental Pathology ----
NON_DENTAL <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/3_NON DENTAL PATHOLOGY/Non Dental Pathologies.xlsx")

NON_DENTAL_clean <- NON_DENTAL %>%
dplyr::select(-c(2, 3))

# Juvenile Dental Pathology ----
DENTAL_juve <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/4_JUVENILE DENTAL PATHOLOGY/Juvenile Dental Pathologies.xlsx")

DENTAL_juve_clean <- DENTAL_juve %>%
dplyr::select(-c(2, 3))

# Dental Pathology ----
DENTAL_adult <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/5_DENTAL PATHOLOGY/Dental Pathologies.xlsx")

DENTAL_adult_clean <- DENTAL_adult %>%
dplyr::select(-c(2, 3))

# OsteoArthritis ----
LIPP <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/6_OA/OA_LIPPING.xlsx")

LIPP_clean <- LIPP %>%
dplyr::select(-c(2, 4))

POR <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/6_OA/OA_POROSITY.xlsx")

POR_clean <- POR %>%
dplyr::select(-c(2, 4))

OPH <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/6_OA/OA_OSTEOPHYTES.xlsx")

OPH_clean <- OPH %>%
dplyr::select(-c(2, 4))

EBU <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/6_OA/OA_EBURNATION.xlsx")
EBU_clean <- EBU %>%
dplyr::select(-c(2, 4))
```

### Οστεομετρήσεις

```{r}
# Metrics Postcranial ----
Metrics_postcra <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/2_OSTEOMETRY/Adult Postcranial Measurements.xlsx")

Metrics_postcra_clean <- Metrics_postcra %>%
dplyr::select(-c(2:14, 17, 20, 25:28, 31, 38:60, 63:76, 79:88, 93:95, 102:110, 115, 120:127, 130:146, 149:181))

# Metrics Cranial ----
Metrics_cra <- read_excel("C:/Users/kirix/Dropbox/APOIKIA/osteor/exported osteodata tables/2_OSTEOMETRY/Adult Cranial Measurements.xlsx")

Metrics_cra_clean <- Metrics_cra %>%
dplyr::select(c(1, 21))
```

Ενώνουμε τα datasets σε ένα κοινό dataset χρησιμοποιώντας το ID ως το κοινό στοιχείο σύνδεσης.

```{r}
# Join all datasets into one ----

## create the list of datasets
osteodata_list_of_tables <- list(Δελτίο_Καταγραφής_clean, Αρχαιολογική_Τεκμηρίωση_clean, Δελτίο_Συντήρησης_clean, Inventory_Recording_Form_clean, Age_Estimation_clean, Sex_Determination_clean, Metrics_postcra_clean, Metrics_cra_clean, NON_DENTAL_clean, DENTAL_juve_clean, DENTAL_adult_clean, LIPP_clean, POR_clean, OPH_clean, EBU_clean)

## join all datasets in the list by common ID
osteodata_joined <- osteodata_list_of_tables %>% reduce(full_join, by='ID')
```

### Tακτοποίηση δεδομένων

Οι μεταβλητές μετονομάστηκαν σε απλούστερους όρους και ταξινομήθηκαν βάσει λογικής σειράς (πχ από τη μικρότερη στη μεγαλύτερη ηλικία) για λόγους ευκρίνειας στα γραφήματα.

```{r}
# rename and reorder values ----
osteodata_joined <- osteodata_joined %>%
mutate(
`Cohort` = fct_recode(`Cohort`, ## recode cohort
"0-1" = "b-1",
"2-5" = "2-5",
"6-10" = "6-10",
"11-15" = "11-15",
"16-20" = "16-20",
"21-25" = "21-25",
"26-30" = "26-30",
"31-35" = "31-35",
"36-40" = "36-40",
"41-45" = "41-45",
"46-50" = "46-50",
"51-55" = "51-55",
"56-60" = "56-60",
"60+" = "60+"),
`Cohort` = fct_relevel(`Cohort`, ## relevel cohort
"0-1",
"2-5",
"6-10",
"11-15",
"16-20",
"21-25",
"26-30",
"31-35",
"36-40",
"41-45",
"46-50",
"51-55",
"56-60",
"60+"),
`Age Group` = fct_recode(`Age Group`, ## recode age groups
"Νεογνά" = "Fetal (<birth)",
"Βρέφη" = "Infant (b-3)",
"Παιδιά" = "Child (3-12)",
"Έφηβοι" = "Adolescent (12-20)",
"Νεαροί Ενήλικοι (20-35)" = "Young Adult (20-35)",
"Μέσοι Ενήλικοι (35-50)" = "Midle Adult (35-50)",
"Ώριμοι Ενήλικοι (50+)" = "Old Adult (50+)"),
`Age Group` = fct_relevel(`Age Group`, ## relevel age groups
"Νεογνά",
"Βρέφη",
"Παιδιά",
"Έφηβοι",
"Νεαροί Ενήλικοι (20-35)",
"Μέσοι Ενήλικοι (35-50)",
"Ώριμοι Ενήλικοι (50+)"),
`Raw Estimation` = fct_recode(`Raw Estimation`, ## recode general age
"Ενήλικοι" = "Adult",
"Ανήλικοι" = "Subadult"),
`Raw Estimation` = fct_relevel(`Raw Estimation`, ## relevel general age
"Ανήλικοι",
"Ενήλικοι"),
`Sex Determination` = fct_recode(`Sex Determination`,## recode sex
"Γυναίκα" = "Female!",
"Πιθανόν γυναίκα" = "Female?",
"Απροσδιόριστο" = "Neutral",
"Πιθανόν άνδρας" = "Male?",
"Άνδρας" = "Male!",
"Αδιάγνωστο" = "Undetermined"),
`Sex Determination` = fct_relevel(`Sex Determination`, ## relevel sex
"Γυναίκα",
"Πιθανόν γυναίκα",
"Απροσδιόριστο",
"Πιθανόν άνδρας",
"Άνδρας",
"Αδιάγνωστο"))

# rename variables
osteodata_joined <- rename(osteodata_joined,
PER_TIBIA_PD_L = "PER_TIBIA_1/3_L",
PER_TIBIA_MD_L = "PER_TIBIA_2/3_L",
PER_TIBIA_DD_L = "PER_TIBIA_3/3_L",
PER_TIBIA_PD_R = "PER_TIBIA_1/3_R",
PER_TIBIA_MD_R = "PER_TIBIA_2/3_R",
PER_TIBIA_DD_R = "PER_TIBIA_3/3_R",
H1_Humerus_maximum_length_l = "H1 Humerus: maximum length_l",
H1_Humerus_maximum_length_r = "H1 Humerus: maximum length_r",
H4_Humerus_epiphysis_width_l = "H4 Humerus: epiphysis width_l",
H4_Humerus_epiphysis_width_r = "H4 Humerus: epiphysis width_r",
H5_Humerus_maximum_diameter_of_midshaft_l = "H5 Humerus: maximum diameter of mid-shaft_l",
H5_Humerus_maximum_diameter_of_midshaft_r = "H5 Humerus: maximum diameter of mid-shaft_r",
H6_Humerus_minimum_diameter_of_midshaft_l = "H6 Humerus: minimum diameter of mid-shaft_l",
H6_Humerus_minimum_diameter_of_midshaft_r = "H6 Humerus: minimum diameter of mid-shaft_r",
H7_Humerus_least_circumference_of_shaft_l = "H7 Humerus: least circumference of shaft_l",
H7_Humerus_least_circumference_of_shaft_r = "H7 Humerus: least circumference of shaft_r",
H9_Humerus_transverse_diameter_of_head_l = "H9 Humerus: transverse diameter of head_l",
H9_Humerus_transverse_diameter_of_head_r = "H9 Humerus: transverse diameter of head_r",
H10_Humerus_sagittal_diameter_of_head_l = "H10 Humerus: sagittal diameter of head_l",
H10_Humerus_sagittal_diameter_of_head_r = "H10 Humerus: sagittal diameter of head_r",
H11_Humerus_trochlea_width_l = "H11 Humerus: trochlea width_l",
H11_Humerus_trochlea_width_r = "H11 Humerus: trochlea width_r",
U1_Ulna_maximum_length_l = "U1 Ulna: maximum length_l",
U1_Ulna_maximum_length_r = "U1 Ulna: maximum length_r",
R1_Radius_maximum_length_l = "R1 Radius: maximum length_l",
R1_Radius_maximum_length_r = "R1 Radius: maximum length_r",
F1_Femur_maximum_length_l = "F1 Femur: maximum length_l",
F1_Femur_maximum_length_r = "F1 Femur: maximum length_r",
F2_FULLY_Femur_physiological_length_l = "F2 (FULLY) Femur: physiological length_l",
F2_FULLY_Femur_physiological_length_r = "F2 (FULLY) Femur: physiological length_r",
F6_Femur_sagittal_diameter_of_midshaft_l = "F6 Femur: sagittal diameter of mid-shaft_l",
F6_Femur_sagittal_diameter_of_midshaft_r = "F6 Femur: sagittal diameter of mid-shaft_r",
F7_Femur_transverse_diameter_of_midshaft_l = "F7 Femur: transverse diameter of mid-shaft_l",
F7_Femur_transverse_diameter_of_midshaft_r = "F7 Femur: transverse diameter of mid-shaft_r",
F8_Femur_circumference_of_midshaft_l = "F8 Femur: circumference of mid-shaft_l",
F8_Femur_circumference_of_midshaft_r = "F8 Femur: circumference of mid-shaft_r",
F19_Femur_vertical_diameter_of_head_l = "F19 Femur: vertical diameter of head_l",
F19_Femur_vertical_diameter_of_head_r = "F19 Femur: vertical diameter of head_r",
F18_Femur_transverse_diameter_of_head_l = "F18 Femur: transverse diameter of head_l",
F18_Femur_transverse_diameter_of_head_r = "F18 Femur: transverse diameter of head_r",
F21_Femur_biepicondylar_width_l = "F21 Femur: biepicondylar width_l",
F21_Femur_biepicondylar_width_r = "F21 Femur: biepicondylar width_r",
F22_Femur_thickness_of_lateral_condyle_l = "F22 Femur: thickness of lateral condyle_l",
F22_Femur_thickness_of_lateral_condyle_r = "F22 Femur: thickness of lateral condyle_r",
T1_FULLY_Tibia_total_length_l = "T1 (FULLY) Tibia: total length_l",
T1_FULLY_Tibia_total_length_r = "T1 (FULLY) Tibia: total length_r",
Fibula_maximum_length_l = "Fibula: maximum length_l",
Fibula_maximum_length_r = "Fibula: maximum length_r",
TaloCalcaneal_Height_l = "(FULLY) TaloCalcaneal Height_l",
TaloCalcaneal_Height_r = "(FULLY) TaloCalcaneal Height_r"
)
```

### Site-Specific Discriminant Functions (for Sex)

Εφαρμόζοντας SSDFs (\@lonoce_western_2018 \@\_\_2015-8) προσδιορίζουμε το φύλο στις περιπτώσεις σκελετών που ο μακροσκοπικός προσδιορισμός δεν ήταν εφικτός.

```{r}
# Create Sex_Binary, calculate FHD and HHD
osteodata_joined <- osteodata_joined %>%
mutate(Sex_Binary = case_when(
`Sex Determination` %in% c('Γυναίκα', 'Πιθανόν γυναίκα') ~ 'Γυναίκα',
`Sex Determination` %in% c('Άνδρας', 'Πιθανόν άνδρας') ~ 'Άνδρας', TRUE ~ NA_character_ ),
FHD = rowMeans(across(c(F18_Femur_transverse_diameter_of_head_l, F18_Femur_transverse_diameter_of_head_r)), na.rm = TRUE),
HHD = rowMeans(across(c(H10_Humerus_sagittal_diameter_of_head_l, H10_Humerus_sagittal_diameter_of_head_r)), na.rm = TRUE) )

# Prepare separate datasets for each model (no NA in relevant predictors)
Fem_Hum_PE_clean_FHD <- osteodata_joined %>%
filter(!is.na(Sex_Binary), !is.na(FHD))

Fem_Hum_PE_clean_HHD <- osteodata_joined %>%
filter(!is.na(Sex_Binary), !is.na(HHD))

Fem_Hum_PE_clean_BOTH <- osteodata_joined %>%
filter(!is.na(Sex_Binary), !is.na(FHD), !is.na(HHD))

# Train LDA models
lda_FHD <- lda(Sex_Binary ~ FHD, data = Fem_Hum_PE_clean_FHD)
lda_HHD <- lda(Sex_Binary ~ HHD, data = Fem_Hum_PE_clean_HHD)
lda_FHD_HHD <- lda(Sex_Binary ~ FHD + HHD, data = Fem_Hum_PE_clean_BOTH)

# Assess accuracy for each model
accuracy_FHD <- mean(predict(lda_FHD)$class == Fem_Hum_PE_clean_FHD$Sex_Binary)

accuracy_HHD <- mean(predict(lda_HHD)$class == Fem_Hum_PE_clean_HHD$Sex_Binary)

accuracy_FHD_HHD <- mean(predict(lda_FHD_HHD)$class == Fem_Hum_PE_clean_BOTH$Sex_Binary)

cat("Number of observations (FHD):", nrow(Fem_Hum_PE_clean_FHD), "\n")
cat("Accuracy (FHD):", accuracy_FHD, "\n")

cat("Number of observations (HHD):", nrow(Fem_Hum_PE_clean_HHD), "\n")
cat("Accuracy (HHD):", accuracy_HHD, "\n")

cat("Number of observations (FHD + HHD):", nrow(Fem_Hum_PE_clean_BOTH), "\n")
cat("Accuracy (FHD + HHD):", accuracy_FHD_HHD, "\n")

# Predict unknown individuals
unknown_individuals <- osteodata_joined %>%
filter(is.na(Sex_Binary)) %>%
dplyr::select(ID, FHD, HHD)
predictions <- unknown_individuals %>%
rowwise() %>%
mutate(Predicted_Sex = case_when(
!is.na(FHD) & !is.na(HHD) ~ predict(lda_FHD_HHD, newdata = cur_data())$class,
!is.na(FHD) & is.na(HHD) ~ predict(lda_FHD, newdata = cur_data())$class,
is.na(FHD) & !is.na(HHD) ~ predict(lda_HHD, newdata = cur_data())$class,
TRUE ~ NA_character_ )) %>%

ungroup() ### Ignore warnings (such as `Predicted_Sex = case_when(…)` in case R had to treat rows with NAs. It is not a functional warning

# Merge predictions back into original dataset
osteodata_joined <- osteodata_joined %>%
left_join(dplyr::select(predictions, ID, Predicted_Sex), by = "ID") %>%
mutate(Predicted_Sex = ifelse(is.na(Sex_Binary), Predicted_Sex, Sex_Binary))
```

### Επιθεώρηση Δεδομένων

```{r}
# INSPECT DATA ----

## dimension
dim(osteodata_joined)

## variable names
names(osteodata_joined)

## variable types
unlist(lapply(osteodata_joined, class))

## quick inspection of all vars (via looping)
for (i in 1:ncol(osteodata_joined)) {
var_name <- names(osteodata_joined)[i]
cat("Μεταβλητή:", var_name, "\n")
print(table(osteodata_joined[[i]], exclude = NULL))
cat("\n-----------------------------\n\n")
}

## quick inspection of a variable eg Age Group
table(osteodata_joined$`Age Group`, exclude = NULL)
barplot(table(osteodata_joined$`Age Group`)) +
title("Ηλικιακή Κατανομή")

## summary of all variables (used better with numerical variables)
summary(osteodata_joined)

## describe all variables
Hmisc::describe(osteodata_joined)
```

### Ελάχιστος Αριθμός Ατόμων-ΕΑΑ (Minimum Number of Individuals-MNI)

Ο Ελάχιστος Αριθμός Ατόμωνς (ΕΑΑ) υπολογίζεται στα 393 βάσει της εγγύας διάφυσης του δεξιού μηριαίου. Η μέτρηση βασίστηκε στο κάθε οστό και δόντι ξεχωριστά ενώ στις περιπτώσεις των μακρών οστών καταμετρήθηκε περαιτέρω και το κάθε τμήμα. Η καταμέτρηση διενεργήθηκε μόνο στο δείγμα των μεμονωμένων ατόμων.

```{r}
# Count bones elements in osteodata
for (i in 2:251) {
var_name <- names(Inventory_Recording_Form_clean)[i]
cat("Μεταβλητή:", var_name, "\n")
print(table(Inventory_Recording_Form_clean[[i]], exclude = NA))
cat("\n-----------------------------\n\n")
}

# Count how many 1s each column has
one_counts <- colSums(Inventory_Recording_Form_clean == 1, na.rm = TRUE)

# Sort counts in descending order
sorted_counts <- sort(one_counts, decreasing = TRUE)

# Show the top 10 variables with the most 1s
head(sorted_counts, 10)

for (var_name in c("Femur L Complete", "Femur R Complete", "Humerus L Complete", "Humerus R Complete", "Ulna L Complete", "Ulna R Complete")) {
cat("Μεταβλητή:", var_name, "\n")
print(table(Inventory_Recording_Form_clean[[var_name]], exclude = NA))
cat("\n-----------------------------\n\n")
}
```

Όταν προστέθηκαν και τα αντίστοιχα οστέινα και οδοντικά τμήματα από τη βάση των μεμονωμένων οστών ο αριθμός ανέρχεται στα ??? .

```{r}
# Count tooth elements in osteodata
selected_vars <- DENTAL_adult_clean %>%
dplyr::select(ends_with("Development"))

for (var_name in names(selected_vars)) {
cat("Μεταβλητή:", var_name, "\n")
print(table(DENTAL_adult_clean[[var_name]], exclude = NA))
cat("\n-----------------------------\n\n")
}
```

```{r}
# Count bones elements in bonedata

```

### Κατάσταση πληρότητας

Ο βαθμός πληρότητας υπολογίστηκε στις 653 από τις 878 μεμονωμένες ταφές καθώς οι υπόλοιπες αφορούσαν περιπτώσεις ταυτισμένων οστών από ανακομιδές (μεμονωμένα κρανία, γνάθοι και πύελοι). Σε άριστη και καλή κατάσταση βρέθηκαν 47 και 102 σκελετοί αντίστοιχα (7% και 16%). Σε μέτρια κατάσταση πληρότητας βρέθηκαν 112 σκελετοί (17%). Σε κακή και πολύ κακή κατάσταση βρέθηκαν 118 και 274 σκελετοί αντίστοιχα (18% και 42%).

```{r}
inventory_table <- osteodata_joined %>%
dplyr::select(`Σωζόμενη Κατάσταση`) %>%
filter(!is.na(`Σωζόμενη Κατάσταση`)) %>%
droplevels() %>%
tbl_summary(
label = list(`Σωζόμενη Κατάσταση` ~ "Κατάσταση Πληρότητας")
) %>%
modify_header(label ~ "") %>%
modify_spanning_header(everything() ~ "")

inventory_table
```

Η κακή και πολύ κακή κατάσταση αθροιστικά παρουσιάζουν συχνότητα 60% ενώ η άριστη και καλή κατάσταση εκτιμώνται στο 23%.

Ο ελάχιστος αριθμός ατόμων για μία δημογραφική ανάλυση σε επίπεδα χρονολογικών περιόδων που ξεπερνούν τα 500 χρόνια όπως η μετάβαση από τη Μεσολιθική στη Νεολιθική θεωρείται πως πρέπει να ορίζεται στα ≥50 άτομα (Bocquet-Appel, 2002, p.643). Στον ίδιο αριθμό δείγματος καταλήγουν μελέτες για δείγματα των ιστορικών χρόνων (Koukli et al., 2023). Στην περίπτωση της Αμβρακίας τα δείγματα σε κάθε περίοδο ξεπερνούν ή βρίσκονται κοντά στο κριτήριο των ≥50 ατόμων (βλ. πίνακες κατανομής στο Παράρτημα Α)

### Αντιπροσωπευτικότητα δειγμάτων

Mελέτες (Peterson, 1998, p. 384) θεωρούν οτι η ανασκαφική διαδικασία και η διατήρηση του οστεολογικού υλικού δεν παραποιούν την αντιπροσώπευση του φύλου και της συμμετρίας των οστεολογικών δεικτών. Ωστόσο στην παρούσα διατριβή όχι μόνο δεν προεξοφλείται αυτό το αξίωμα αλλά λαμβάνονται υπόψη όλες οι παράμετροι που επηρεάζουν την παρουσία των οστών. Η αντιπροσωπευτικότητα των δειγμάτων ενός νεκροταφείου επηρεάζεται από παράγοντες πολιτισμικών διεργασιών, ταφονομικών συνθηκών, ανασκαφικών διαδικασιών και παλαιοδημογραφικών μεθόδων. Κάποιες νεκροπόλεις χρησιμοποιούνταν για συγκεκριμένες ηλικιακές ομάδες όπως τα βρεφικό νεκροταφείο της Αστυπάλαιας(FitzGerald & Hillson, 2009; Hillson, 2012). Το ταφικό μικροκλίμα επηρεάζει σε μεγάλο βαθμό τη διατήρηση του οστεολογικού υλικού όπως αναλύεται παρακάτω. Η ανασκαφική διαδικασία πολλές φορές λόγω έλλειψης βιοανθρωπολογικού προσωπικού μπορεί να παρανοήσει το οστεολογικό υλικό και να παραβλέψει σημαντικές πληροφορίες. Οι μέθοδοι εκτίμησης του φύλου μπορεί να είναι προκατειλημμένες υπέρ κάποιου συγκεκριμένου φύλου ενώ οι μέθοδοι υπολογισμού της ηλικίας μπορεί να οδηγήσουν σε υποεκτίμηση ή υπερεκτίμηση της ηλικιακής ομάδας του σκελετού (Taylor et al., 2023). Λαμβάνοντας υπόψη τους παραπάνω παράγοντες εξετάζουμε το βαθμό αντιπροσωπευτικότητας του δείγματος ενός αρχαιολογικού πληθυσμού.

Κατα την μελέτης της αντιπροσώπευσης εφαρμόζεται ο Δείκτης Αντιπροσώπευσης Οστών-ΔΑΟ (Bone Representation Index-BRI). Ο ΔΑΟ χρησιμοποιείται για τη βέλτιστη απεικόνιση της κατανομής των οστών που διατηρήθηκαν στις δευτερεύουσες ταφές όπως ανακομιδές και διάσπαρτα οστά εντός των τάφων (Klaus, 2008, p.473) και υπολογίζεται ως εξής:

BRI = (Nobserved/Nexpected)\\\*100

όπου Nobserved είναι ο αριθμός παρουσίας του οστού και Nexpected ο αριθμός των προσδοκώμενων οστών όπως ορίζονται απο τον ΕΑΑ του υλικού (στην περίπτωση της Αμβρακίας Nexpected = 878)

### Παλαιοδημογραφια

Η παλαιοδημογραφία είναι το ερευνητικό πεδίο όπου δημογραφικοί παράμετροι χρησιμοποιούνται στην ανάλυση παρελθόντων πληθυσμών με σκοπό την εξαγωγή συμπερασμάτων όσον αφορά την υγεία και την ευζωία (Hoppa & Vaupel, 2002, p. i). Η εκτίμηση της ηλικίας θανάτου και ο προσδιορισμός του φύλου είναι οι δύο δομικές παράμετροι για την μελέτη της δημογραφίας των αρχαίων βιοκοινωνιών.

Κατά την παλαιοδημογραφική ανάλυση θεωρούμε τον πληθυσμό της Αμβρακίας ως σταθερό σύμφωνα με την εικασία οτι οι προ-βιομηχανικοί ανθρώπινοι πληθυσμοί προσομοίαζαν σταθερούν πληθυσμούς βάσει της ομοιομορφικής εικασίας (Chamberlain, 2006). Η σταθερότητα των πληθυσμών υποστήριζεται επίσης από το φαινόμενο της «ασθενούς εργοδικότητας» (Hoppa & Vaupel, 2002b, pp. 135--136). Παρόλες τις αλλαγές στη γεννητικότητα, θνησιμότητα και στους ρυθμούς μετανάστευσης, ένας πληθυσμός δείχνει σταθερή ηλικιακή κατανομή κατά τη διάρκεια οποιασδήποτε χρονικής περιόδου. Συγκεκριμένα, τα μοτίβα θνησιμότητας τείνουν να ακολουθούν μία λεκανοειδής καμπύλη (bathtub curve) που ξεκινάει ψηλά στις πρώιμες ηλικίες, φτάνει το ναδίρ στην ηλικιακή ομάδα 10-15 χρόνων και έπειτα αυξάνεται στις επόμενες ηλικιακές ομάδες (Hoppa & Vaupel, 2002b, p. 137).

#### Ηλικακή Κατανομή

Σύμφωνα με την ευρεία ηλικιακή κατανομή σε όλο το δείγμα (χωρίς ελλείπουσες τιμές) οι ανήλικοι είναι 141 (16%) και ενήλικοι είναι 737(84%). Οι παρατηρούμενες τιμές διαφέρουν σημαντικά από τις αναμενόμενες (Chi-square goodness-of-fit: (df 1) = 404.57, p = 5.56e-90) . Οι παρατηρούμενες τιμές διαφέρουν απο τις αναμενόμενες και κατα τον υπολογισμό ανα χρονική περίοδο().

```{r}
# Age General ----

## no filter ----
### plot
age_general_counts <- table(osteodata_joined$`Raw Estimation`, useNA = "no")

age_general_percent <- round(100 * age_general_counts / sum(age_general_counts), 1) #### Percentages


age_general_labels <- paste0(age_general_counts, " (", age_general_percent,"%)") #### Labels "count (percent%)"

p_value_age_general <- chisq.test(age_general_counts) #### Chi-square goodness-of-fit test

osteodata_joined %>%
dplyr::select(`Raw Estimation`) %>%
filter(!is.na(`Raw Estimation`)) %>%
ggplot(aes(x = `Raw Estimation`,
y = prop.table(stat(count)),
label = paste0(stat(count), " (", round(100*prop.table(after_stat(count)), 1),"%)"))) +
geom_bar(position = "stack") +
geom_text(stat = 'count',
position = position_stack(0.5),
vjust = 0.5,
size = 4, color = "black") +
scale_y_continuous(labels = scales::percent) +
labs(x = 'Γενική Ηλικία', y = 'Ποσοστό') +
theme(axis.text.x = element_text(size =11)) +
annotate("text", x = Inf, y = Inf, label = paste(
"Chi-sq p-value:", signif(p_value_age_general$p.value, 3),
"\nDf:", p_value_age_general$parameter,
"\nX-squared:", round(p_value_age_general$statistic, 2)),
hjust = 1, vjust = 1, size = 3.5, color = "blue", parse = FALSE)

### table

rawestimation_no_filter_table <- osteodata_joined %>%
dplyr::select(`Raw Estimation`) %>%
filter(!is.na(`Raw Estimation`)) %>%
droplevels() %>%
tbl_summary(
label = list(`Raw Estimation` ~ "Γενική Ηλικία"),
statistic = list(all_categorical() ~ "{n} ({p}%)")
) %>%
modify_header(label ~ "") %>%
modify_spanning_header(everything() ~ "") %>%
modify_footnote(
everything() ~ paste0("Chi-square goodness-of-fit: Χ²(", p_value_age_general$parameter,") =",
round(p_value_age_general$statistic, 2),", p =",
signif(p_value_age_general$p.value, 3))
)

rawestimation_no_filter_table

## by Chrono ----

tab_chrono <- table(
osteodata_joined$`Raw Estimation`,
osteodata_joined$`Σχετική Χρονολόγηση`
)

# Select test depending on expected counts
expected_counts <- chisq.test(tab_chrono)$expected
if(any(expected_counts < 5)) {
test_chrono <- fisher.test(tab_chrono)
test_name <- "Fisher's Exact Test"
} else {
test_chrono <- chisq.test(tab_chrono)
test_name <- "Chi-square Test of Independence"
}

chrono_colors <- c("#edf8fb", "#bfd3e6", "#9ebcda", "#8c96c6",
"#8c6bb1", "#88419d", "#6e016b")

### plot
ggdraw(
osteodata_joined %>%
dplyr::select(`Raw Estimation`, `Σχετική Χρονολόγηση`) %>%
filter(!is.na(`Raw Estimation`) & !is.na(`Σχετική Χρονολόγηση`)) %>%
ggplot(aes(x = `Raw Estimation`,
y = prop.table(stat(count)),
fill = `Σχετική Χρονολόγηση`,
label = paste0(stat(count), " (", round(100*prop.table(after_stat(count)), 1),"%)"))) +
geom_bar(position = "stack") +
geom_text(stat = 'count',
position = position_stack(0.5),
vjust = 0.5,
size = 2, color = "black") +
scale_fill_manual(values = chrono_colors) +
scale_y_continuous(labels = scales::percent, expand = expansion(mult = c(0, 0.05))) +
labs(x = 'Γενική Ηλικία', y = 'Ποσοστό', fill = 'Χρονολόγηση') +
theme(axis.text.x = element_text(size =11))
) +
draw_text(
paste(test_name, "\nP-value:", signif(test_chrono$p.value, 3)),
x = 0.98, y = 0.98, hjust = 1, vjust = 1,
size = 10, color = "blue"
)

### table

rawestimation_by_chrono_table <- osteodata_joined %>%
dplyr::select(`Raw Estimation`, `Σχετική Χρονολόγηση`) %>%
filter(!is.na(`Raw Estimation`) & !is.na(`Σχετική Χρονολόγηση`)) %>%
droplevels() %>%
tbl_summary(
by = `Raw Estimation`,
label = list(`Σχετική Χρονολόγηση` ~ "Σχετική Χρονολόγηση"),
statistic = list(all_categorical() ~ "{n} ({p}%)")
) %>%
modify_header(label ~ "") %>%
modify_spanning_header(everything() ~ "") %>%
modify_footnote(
everything() ~ paste0(test_name, ": p =", signif(test_chrono$p.value, 3))
)

rawestimation_by_chrono_table
```

Σύμφωνα με την κατανομή ανά ηλικιακών ομάδων σε όλο το δείγμα και αποκλείοντας τις ελλείπουσες τιμές, τα βρέφη είναι .....++++

```{r}
for (variable in c("Raw Estimation", "Age Group", "Cohort")) {
freq_table <- table(osteodata_joined[[variable]], useNA = "no")
percent_table <- round(100 * freq_table / sum(freq_table), 1) #### Percentages

labels <- paste0(freq_table, " (", percent_table,"%)") #### Labels with counts

labeled_table <- setNames(labels, names(freq_table)) #### name the labels

# Print
cat("Μεταβλητή:", variable, "\n")
print(labeled_table)

# Barplot in percentages
bar_positions <- barplot(height = percent_table,
main = paste("Κατανομή -", variable),
xlab = variable,
ylab = "Ποσοστό (%)",
col = "#1D3A5F",
names.arg = names(freq_table))

text(x = bar_positions,
y = percent_table,
labels = labels,
pos = 3,
cex = 0.8,
col = "white")
cat("\n-----------------------------\n\n")
}
```

να ελέγξω αν είναι ή δεν είναι τυχαίες αναφέροντας τις τιμές p και μετά να το κάνω copy paste στη συζήτηση στην ενότητα Ηλικιακή κατανομή

Οι τιμές στα γραφήματα και στους πίνακες καταδεικνύουν οτι είναι/δεν είναι τυχαίες και ακολουθούν/δεν ακολουθούν την αναμενόμενη κατανομή. Παράγοντες που ίσως να επηρέασαν τα αποτελέσματα μπορούν να αναζητηθο΄υν στην προκατάληψη του δείγματος και τις ανασκαφικές τεχνικές. Πρέπει να αποκλείσουμε καταστροφικά γεγονότα ή δημογραφικά προβλήματα καθώς η αρχαιολογική πληροφορία δείχνει ένα σχετικά σταθερό πληθυσμό τουλάχιστον κατα την αρχαϊκή και κλασσική περίοδο. Κατα την ανάλυση λάβαμε σοβαρά υπόψη το γεγονός πως ο υπολογισμός ηλικίας στους ανήλικους βασίζεται στην αναπτυξιακή διαδικασία η οποία χαρακτηρίζεται από σταθερή και ευκρινή ομοιομορφία σε παγκόσμιο επίπεδο. Ο υπολογισμός ηλικίας στους ενήλικους βασίζεται στην εκφυλιστική διαδικασία η οποία χαρακτηρίζεται από πολυπαραγοντικές μεταβλητές σε ατομικό και πληθυσμιακό επίπεδο (Hoppa & Vaupel, 2002, p.75).

Η κατανομή των ηλικιακών ομάδων εμφανίζει αυξημένη συχνότητα των παιδικών ηλικιακών ομάδων (\\\<12 ετών) μειώνεται στην εφηβική, αυξάνεται στους νεαρούς και έτι ελάχιστα στους μέσους ενήλικες και μειώνεται στους γηραιούς.

```{r}

```

Η κατανομή των κοόρτων εμφανίζει ++++

```{r}

```

#### Φυλετική Κατανομή

Το φύλο προσδιορίστηκε σε 479 άτομα βάσει μορφοσκοπικών χαρακτηριστικών και υπολογίσαμε την κατανομή βάσει πεντε κατηγοριών(γυναίκα, πιθανόν γυναίκα, απρόσδιοριστο, πιθανόν άνδρας, άνδρας). Παρατηρείται πως οι γυναίκες και οι πιθανόν γυναίκες είναι 121(25%) και 115(24%) αντίστοιχα, οι απροσδιόριστοι είναι 36(8%) και οι άνδρες και πιθανόν άνδρες είναι 141(29%) και 66(14%). Οι παρατηρούμενες τιμές διαφέρουν εξαιρετικά από τις αναμενόμενες (Chi-square goodness-of-fit: Χ²(4) = 78.4, p = 3.8e-16). Μη συνυπολογίζοντας τα άτομα απροσδιόριστου φύλου οι γυναίκες και οι πιθανόν γυναίκες έφτασαν το 27% και 26% αντίστοιχα, και οι άνδρες και πιθανόν άνδρες το 32% και 15%. Οι παρατηρούμενες τιμές διαφέρουν σε μεγάλο βαθμό από τις αναμενόμενες (Chi-square goodness-of-fit: Χ²(3) = 27.46, p = 4.72e-06).

Οι γυναίκες ήταν 1 (2%) κατά την εποχή του Χαλκού, καμία κατα τον 6ο αι. (0%), 14(23%) κατά τον 5ο αι., 16(27%) κατά τον 4ο αι., 16(27%) κατά τον 3ο αι. 11(18%) κατά τον 2ο αι. και 2(3%) κατά τον 1ο αι..

Δεν βρέθηκε καμία πιθανόν γυναίκα (0%) κατά την εποχή του Χαλκού, 2(4%) κατά τον 6ο αι., 9(16%) κατά τον 5ο αι., 16(29%) κατά τον 4ο αι., 19(35%) κατά τον 3ο αι. 7(13%) κατά τον 2ο αι. και 2(4%) κατά τον 1ο αι..

Δεν βρέθηκε κανένας απροσδιόριστος φυλετικά σκελετός (0%) κατά την εποχή του Χαλκού, 1(7%) κατά τον 6ο αι., 3(20%) κατά τον 5ο αι., 3(20%) κατά τον 4ο αι., 6(40%) κατά τον 3ο αι., 2(13%) κατά τον 2ο αι. και κανένας (0%) κατά τον 1ο αι..

Οι πιθανόν άνδρες ήταν 1(3%) κατά την εποχή του Χαλκού, κανένας κατά τον 6ο αι., 1(3%) κατά τον 5ο αι., 11(32%) κατά τον 4ο αι., 13(38%) κατά τον 3ο αι., 8(24%) κατά τον 2ο αι. και κανένας (0%) κατά τον 1ο αι..

Δεν βρέθηκε κανένας άνδρας κατά την εποχή του Χαλκού(0%) ή τον 6ο αι.(0%), 19(26%) κατά τον 5ο αι., 23(31%) κατά τον 4ο αι., 21(28%) κατά τον 3ο αι., 10(14%) κατά τον 2ο αι. και 1(1%) κατά τον 1ο αι.. Οι παρατηρούμενες τιμές διαφέρουν απο τις αναμενόμενες και κατα τον υπολογισμό ανα χρονική περίοδο (Fisher's Exact Test: p = 0.287).

Αποκλείοντας τους απροσδιόριστους σκελετούς η τιμή p (0.186) του Fisher's Exact Test μειώνεται αλλά και σε αυτή την περίπτωση αποτυγχάνει να απορρίψει την μηδενική υπόθεση. Κατά συνέπεια οι παρατηρούμενες τιμές διαφέρουν σημαντικά απο τις αναμενόμενες και στην περίπτωση της κατανομής ανά χρονική περίοδο.

Στο σύνολο του δείγματος παρατηρείται πως οι πιθανόν άνδρες έναντι των ανδρών εμφανίζουν χαμηλότερο ποσοστό από το αναμενόμενο αν λάμβουμε υπόψη τη μικρή διαφορά μεταξύ των γυναικών και πιθανών γυναικών.

```{r}
# Sex ----

## no filter ----

### w/out 'Αδιάγνωστο' but w/ 'Απροσδιόριστο' ----
# subset
sex_wout_with <- osteodata_joined %>%
filter(!is.na(`Sex Determination`), `Sex Determination` != "Αδιάγνωστο") %>%
droplevels()

# p values
sex_wout_with_counts <- table(sex_wout_with$`Sex Determination`)
p_value_sex_wout_with <- chisq.test(sex_wout_with_counts)

# plot
sex_wout_with %>%
ggplot(aes(x = `Sex Determination`,
y = after_stat(prop.table(count)),
label = paste0(after_stat(count), " (",
round(100*after_stat(prop.table(count)), 1), "%)"))) +
geom_bar() +
geom_text(stat = "count",
position = position_stack(0.5),
vjust = 0.5, size = 4) +
scale_y_continuous(labels = scales::percent) +
labs(x = "Φύλο", y = "Ποσοστό") +
theme(axis.text.x = element_text(size = 11)) +
annotate("text", x = Inf, y = Inf,
label = paste0("Chi-sq p =", signif(p_value_sex_wout_with$p.value, 3),
"\nDf =", p_value_sex_wout_with$parameter,
"\nΧ² =", round(p_value_sex_wout_with$statistic, 2)),
hjust = 1, vjust = 1, size = 3.5, color = "blue")

# table
sex_no_filter_wout_with_table <- sex_wout_with %>%
dplyr::select(`Sex Determination`) %>%
tbl_summary(
label = list(`Sex Determination` ~ "Κατανομή Φύλου"),
statistic = list(all_categorical() ~ "{n} ({p}%)")) %>%
modify_header(label ~ "") %>%
modify_spanning_header(everything() ~ "") %>%
modify_caption("**Κατανομή Φύλου (χωρίς Αδιάγνωστο, με Απροσδιόριστο)**") %>%
modify_footnote(
everything() ~ paste0("Chi-square goodness-of-fit: Χ²(",
p_value_sex_wout_with$parameter, ") =",
round(p_value_sex_wout_with$statistic, 2),
", p =", signif(p_value_sex_wout_with$p.value, 3))
)

sex_no_filter_wout_with_table

### w/out 'Αδιάγνωστο' and w/out 'Απροσδιόριστο' ----

# subset
sex_wout_wout <- osteodata_joined %>%
filter(!is.na(`Sex Determination`),
!`Sex Determination` %in% c("Αδιάγνωστο","Απροσδιόριστο")) %>%
droplevels()

# p values
sex_wout_wout_counts <- table(sex_wout_wout$`Sex Determination`)
p_value_sex_wout_wout <- chisq.test(sex_wout_wout_counts)

# plot
sex_wout_wout %>%
ggplot(aes(x = `Sex Determination`,
y = after_stat(prop.table(count)),
label = paste0(after_stat(count), " (",
round(100*after_stat(prop.table(count)), 1), "%)"))) +
geom_bar() +
geom_text(stat = "count",
position = position_stack(0.5),
vjust = 0.5, size = 4) +
scale_y_continuous(labels = scales::percent) +
labs(x = "Φύλο", y = "Ποσοστό") +
theme(axis.text.x = element_text(size = 11)) +
annotate("text", x = Inf, y = Inf,
label = paste0("Chi-sq p =", signif(p_value_sex_wout_wout$p.value, 3),
"\nDf =", p_value_sex_wout_wout$parameter,
"\nΧ² =", round(p_value_sex_wout_wout$statistic, 2)),
hjust = 1, vjust = 1, size = 3.5, color = "blue")

# table
sex_no_filter_wout_wout_table <- sex_wout_wout %>%
dplyr::select(`Sex Determination`) %>%
tbl_summary(
label = list(`Sex Determination` ~ "Κατανομή Φύλου"),
statistic = list(all_categorical() ~ "{n} ({p}%)")) %>%
modify_header(label ~ "") %>%
modify_spanning_header(everything() ~ "") %>%
modify_caption("**Κατανομή Φύλου (χωρίς Αδιάγνωστο & Απροσδιόριστο)**") %>%
modify_footnote(
everything() ~ paste0("Chi-square goodness-of-fit: Χ²(",
p_value_sex_wout_wout$parameter, ") =",
round(p_value_sex_wout_wout$statistic, 2),
", p =", signif(p_value_sex_wout_wout$p.value, 3))
)

sex_no_filter_wout_wout_table

## by Chrono ----

### by Chrono w/out 'Αδιάγνωστο' but w/ 'Απροσδιόριστο' ----
# subset
sex_chrono_wout_with <- sex_wout_with %>%
filter(!is.na(`Σχετική Χρονολόγηση`)) %>%
droplevels()

# p values
tab_chrono_wout_with <- table(sex_chrono_wout_with$`Sex Determination`, sex_chrono_wout_with$`Σχετική Χρονολόγηση`)

expected_wout_with <- suppressWarnings(chisq.test(tab_chrono_wout_with)$expected)

if (any(expected_wout_with < 5)) {
test_wout_with <- fisher.test(tab_chrono_wout_with, simulate.p.value = TRUE, B = 10000)
test_name_wout_with <- "Fisher's Exact Test"
} else {
test_wout_with <- chisq.test(tab_chrono_wout_with)
test_name_wout_with <- "Chi-square Test of Independence"
}

# plot
sex_chrono_wout_with %>%
ggplot(aes(x = `Sex Determination`,
y = after_stat(prop.table(count)),
fill = `Σχετική Χρονολόγηση`,
label = paste0(after_stat(count), " (",
round(100*after_stat(prop.table(count)), 1), "%)"))) +
geom_bar(position = "stack") +
geom_text(stat = "count",
position = position_stack(0.5),
vjust = 0.5, size = 3) +
scale_y_continuous(labels = scales::percent,
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Φύλο", y = "Ποσοστό", fill = "Χρονολόγηση") +
theme(axis.text.x = element_text(size = 11)) +
annotate("text", x = Inf, y = Inf,
label = paste0(test_name_wout_with,
"\np =", signif(test_wout_with$p.value, 3)),
hjust = 1, vjust = 1, size = 3.5, color = "blue")

# table
sex_by_chrono_wout_with_table <- sex_chrono_wout_with %>%
dplyr::select(`Sex Determination`, `Σχετική Χρονολόγηση`) %>%

tbl_summary(
by = `Sex Determination`,
label = list(`Σχετική Χρονολόγηση` ~ "Σχετική Χρονολόγηση"),
statistic = list(all_categorical() ~ "{n} ({p}%)")) %>%
modify_header(label ~ paste0(test_name_wout_with, ": p =", signif(test_wout_with$p.value, 3))) %>%
modify_spanning_header(everything() ~ "") %>%
modify_caption("**Κατανομή Φύλου ανά Χρονολόγηση (χωρίς Αδιάγνωστο, με Απροσδιόριστο)**")

sex_by_chrono_wout_with_table

### by Chrono w/out 'Αδιάγνωστο' and w/out 'Απροσδιόριστο' ----
# subset
sex_chrono_wout_wout <- sex_wout_wout %>%
filter(!is.na(`Σχετική Χρονολόγηση`)) %>%

droplevels()

# p values
tab_chrono_wout_wout <- table(sex_chrono_wout_wout$`Sex Determination`, sex_chrono_wout_wout$`Σχετική Χρονολόγηση`)

expected_wout_wout <- suppressWarnings(chisq.test(tab_chrono_wout_wout)$expected)

if (any(expected_wout_wout < 5)) {
test_wout_wout <- fisher.test(tab_chrono_wout_wout, simulate.p.value = TRUE, B = 10000)
test_name_wout_wout <- "Fisher's Exact Test"
} else {
test_wout_wout <- chisq.test(tab_chrono_wout_wout)
test_name_wout_wout <- "Chi-square Test of Independence"
}

# plot
sex_chrono_wout_wout %>%
ggplot(aes(x = `Sex Determination`,
y = after_stat(prop.table(count)),
fill = `Σχετική Χρονολόγηση`,
label = paste0(after_stat(count), " (",
round(100*after_stat(prop.table(count)), 1), "%)"))) +
geom_bar(position = "stack") +
geom_text(stat = "count",
position = position_stack(0.5),
vjust = 0.5, size = 3) +
scale_y_continuous(labels = scales::percent,
expand = expansion(mult = c(0, 0.05))) +
labs(x = "Φύλο", y = "Ποσοστό", fill = "Χρονολόγηση") +
theme(axis.text.x = element_text(size = 11)) +
annotate("text", x = Inf, y = Inf,
label = paste0(test_name_wout_wout,
"\np =", signif(test_wout_wout$p.value, 3)),
hjust = 1, vjust = 1, size = 3.5, color = "blue")

# table
sex_by_chrono_wout_wout_table <- sex_chrono_wout_wout %>%
dplyr::select(`Sex Determination`, `Σχετική Χρονολόγηση`) %>%

tbl_summary(
by = `Sex Determination`,
label = list(`Σχετική Χρονολόγηση` ~ "Σχετική Χρονολόγηση"),
statistic = list(all_categorical() ~ "{n} ({p}%)")) %>%
modify_header(label ~ paste0(test_name_wout_wout, ": p =", signif(test_wout_wout$p.value, 3))) %>%
modify_spanning_header(everything() ~ "") %>%
modify_caption("**Κατανομή Φύλου ανά Χρονολόγηση (χωρίς Αδιάγνωστο & Απροσδιόριστο)**")

sex_by_chrono_wout_wout_table
```

#### Δημογραφική Κατανομή

Η κατανομή του φύλου βάσει ηλικίας εμφανίζει μεγαλύτερη συχνότητα των γυναικών στη νεαρή, ίδια συχνότητα στη μέση ενήλικη ηλικιακή ομάδα και μεγαλύτερη των ανδρών στη γηραιή ενήλικη ηλικιακή ομάδα.  Αξίζει να αναφερθεί πως στις περιπτώσεις που ήταν αδύνατη η εκτίμηση της ηλικίας παρουσιάζεται ομοιομορφία στην κατανομή μεταξύ ανδρών και γυναικών.

```{r}

```

### Παλαιοπαθολογικές ενδείξεις

Κατά την στατιστική ανάλυση των παλαιοπαθολογικών ενδείξεων λήφθηκε υπόψη ο ηλικιακός παράγοντας ως επιβαρυντικός περιπτώσεις των παθήσεων που Σε αυτές τις περιπτώσεις οι ερευνητές οφείλουν να λαμβάνουν σοβαρά υπόψη τις ηλικιακές κατανομές κατά την στατιστική ανάλυση και ερμηνεία (DeWitte, 2014, p. 43). Ο φυλετικός παράγοντας διερευνήθηκε με σκοπό τον προσδιορισμό της ευπάθειας μεταξύ των φύλων. Τελος, εκτιμήθηκε η πλευρικότητα εμφάνισης των αλλοιώσεων στις περιπτώσεις αμφίπλευρων ενδείξεων.

#### Κρανιακή παθολογία

##### Περιοστικές αντιδράσεις

Οι Mensforth et al.(1978, p. 22-23)

Παρόλο που αποφεύγουν να αναλύσουν στατιστικά τις μεγαλύτερες ηλικίες λόγω της πιθανής αλληλεπίδρασης του φύλετικών ορμόνων με τα επίπεδα σιδήρου, στην παρούσα διατριβή μελετώνται όλες οι ηλικιακές ομάδες.

###### PH - Πορώδης Υπερόστωση

H Πορώδης Υπερόστωση (PH) εμφανίζεται σε χαμηλά ποσοστά στο σύνολο του πληθυσμού με το αριστερό βρεγματικό εξωτερικά να παρουσιάζει τη μεγαλύτερη συχνότητα (23%) και το μετωπιαίο εσωτερικά τη μικρότερη (4%). Ενδεικτικά, για το αριστερό βρεγματικό εξωτερικά οτι οι παρατηρούμενες τιμές διαφέρουν σημαντικά από τις αναμενόμενες (Binomial test (p=0.5): n = 191, successes = 43 → p = 1.07e-14). Παρόμοια αποτελέσματα καταγράφηκαν και στα υπόλοιπα οστικά σημεία.

```{r}
# PH ----

## Subset
ph_subset <- osteodata_joined %>%
dplyr::select(starts_with("PH_"))

ph_to_plot <- c(
"PH_FRONTAL_ext", "PH_OCCIPITAL_ext",
"PH_PARIETAL_L_ext", "PH_PARIETAL_R_ext",
"PH_FRONTAL_int", "PH_OCCIPITAL_int",
"PH_PARIETAL_L_int", "PH_PARIETAL_R_int"
)

## Loop

results_binom <- list()

for (variable in ph_to_plot) {

### mutate into binom

ph_binary <- ph_subset %>%
dplyr::mutate(
Presence = ifelse(.data[[variable]] == "0", "Απουσία", "Παρουσία")
)

### Binomial test (H0: 50/50)
freq_table <- table(ph_binary$Presence)
binom_test <- binom.test(freq_table, p = 0.5)

### Table
tbl_PH_binom <- ph_binary %>%
dplyr::select(Presence) %>%

tbl_summary(
label = list(Presence ~ variable),
statistic = list(all_categorical() ~ "{n} ({p}%)"), missing = "no"
) %>%
modify_header(label ~ "") %>%
modify_spanning_header(everything() ~ "") %>%
modify_caption(paste0("**Κατανομή:", variable, "**")) %>%
modify_footnote(
everything() ~ paste0("Binomial test (p=0.5):",
"n =", sum(freq_table),
", successes =", freq_table["Παρουσία"],
" → p = ", signif(binom_test$p.value, 3))
)

results_binom[[variable]] <- tbl_PH_binom
}

### Print
for (variable in ph_to_plot) {
print(results_binom[[variable]])
}
```

Παρατηρείται συχνότερα η μεσαία βαθμίδα έντασης της πορώδους υπερόστωσης. Ενδεικτικά, το αριστερό βρεγματικό οστό εξωτερικά εμφανίζει ήπια ένδειξη στο 6,3%, μέτρια στο 6,7%, σοβαρή στο 5,2% και πολύ σοβαρή στο 4,1%. Όσον αφορά τα επίπεδα ίασης στο ίδιο οστικό σημείο, η αλλοίωση παρατηρείται ως ενεργή στο 4,1% ενώ υπό ίαση στο 18,9%. Οι παρατηρούμενες τιμές διαφέρουν σημαντικά από τις αναμενόμενες (Chi-square GOF: Χ²(16) = 1771,65, p = 0). Όλα τα οστικά σημεία παρουσιάζουν παρόμοια κατανομή με το αριστερό βρεγματικό εξωτερικά.

```{r}
# PH ----

ph_subset <- osteodata_joined %>%
dplyr::select(starts_with("PH_"))

ph_to_plot <- c("PH_FRONTAL_ext", "PH_OCCIPITAL_ext", "PH_PARIETAL_L_ext", "PH_PARIETAL_R_ext", "PH_FRONTAL_int", "PH_OCCIPITAL_int", "PH_PARIETAL_L_int", "PH_PARIETAL_R_int")

new_levels <- c('Απουσία',
'Ήπια ένδειξη-Ενεργή',
'Ήπια ένδειξη-Πρώιμη ίαση',
'Ήπια ένδειξη-Προχωρημένη ίαση',
'Ήπια ένδειξη-Πλήρης ίαση',
'Μέτρια ένδειξη-Ενεργή',
'Μέτρια ένδειξη-Πρώιμη ίαση',
'Μέτρια ένδειξη-Προχωρημένη ίαση',
'Μέτρια ένδειξη-Πλήρης ίαση',
'Σοβαρή ένδειξη-Ενεργή',
'Σοβαρή ένδειξη-Πρώιμη ίαση',
'Σοβαρή ένδειξη-Προχωρημένη ίαση',
'Σοβαρή ένδειξη-Πλήρης ίαση',
'Πολύ σοβαρή ένδειξη-Ενεργή',
'Πολύ σοβαρή ένδειξη-Πρώιμη ίαση',
'Πολύ σοβαρή ένδειξη-Προχωρημένη ίαση',
'Πολύ σοβαρή ένδειξη-Πλήρης ίαση')

## Plot (Chi-Square Test) ----

results <- list()

for (variable in ph_to_plot) {

# Chi-square goodness-of-fit
freq_table <- table(ph_subset[[variable]])
chi2GofF <- suppressWarnings(chisq.test(freq_table))

# table
tbl_PH <- ph_subset %>%
dplyr::select(dplyr::all_of(variable)) %>%
tbl_summary(
label = list(all_of(variable) ~ variable),
statistic = list(all_categorical() ~ "{n} ({p}%)"),missing = "no"
) %>%
modify_header(label ~ "") %>%
modify_spanning_header(everything() ~ "") %>%
modify_caption(paste0("**Κατανομή:", variable, "**")) %>%
modify_footnote(
everything() ~ paste0("Chi-square GOF: Χ²(",
chi2GofF$parameter, ") =",
round(chi2GofF$statistic, 2),
", p =", signif(chi2GofF$p.value, 3))
)

results[[variable]] <- tbl_PH
}

for (variable in ph_to_plot) {
print(results[[variable]])
}
```

Για την συνεκτίμηση των ανεξάρτητων μεταβλητών της ηλικίας, του φύλου και της χρονικής περιόδου η ΠΥ υπολογίστηκε ως διχοτομημένη μεταβλητή καθώς η περαιτέρω κατηγοριοποίηση θα δημιουργούσε υπερβολικό κατακερματισμό του δείγματος με συνέπεια τα στατιστικά τεστ να υπερέβαλαν στις εκτιμήσεις τους.

Αρχικά γίνεται συνεκτίμηση με την ηλικία.+++

```{r}
# PH by Age Group ----

# Subset (Age Group NAs removed)

ph_subset <- osteodata_joined %>%

dplyr::select(starts_with("PH_"), `Age Group`) %>%

filter(!is.na(`Age Group`))

ph_to_plot <- c(

"PH_FRONTAL_ext", "PH_OCCIPITAL_ext",

"PH_PARIETAL_L_ext", "PH_PARIETAL_R_ext",

"PH_FRONTAL_int", "PH_OCCIPITAL_int",

"PH_PARIETAL_L_int", "PH_PARIETAL_R_int"

)

results_tables <- list()

results_plots <- list()

for (variable in ph_to_plot) {

# Make binary

ph_binary <- ph_subset %>%

filter(!is.na(.data[[variable]])) %>%

mutate(Presence = ifelse(.data[[variable]] == "0", "Απουσία", "Παρουσία"))

# Calculate Fisher (Monte Carlo)

tab <- table(ph_binary$Presence, ph_binary$`Age Group`)

fisher_mc <- fisher.test(tab, simulate.p.value = TRUE, B = 10000)

# Table

tbl <- ph_binary %>%

dplyr::select(Presence, `Age Group`) %>%

droplevels() %>%

tbl_summary(

by = `Age Group`,

label = list(Presence ~ variable),

statistic = list(all_categorical() ~ "{n} ({p}%)"),

missing = "no"

) %>%

modify_header(label ~ "") %>%

modify_spanning_header(everything() ~ "") %>%

modify_caption(paste0("**", variable, " by Age Group**")) %>%

modify_footnote(

everything() ~ paste0("Fisher's exact test (MC, B=10000): p =",

signif(fisher_mc$p.value, 3))

)

results_tables[[variable]] <- tbl

# Plot

summary_df <- ph_binary %>%

dplyr::count(`Age Group`, Presence) %>%

group_by(`Age Group`) %>%

mutate(prop = n / sum(n),

label = paste0(n, " (", round(100 * prop, 1),"%)")) %>%

ungroup()

p <- ggplot(summary_df, aes(x = `Age Group`, y = prop, fill = Presence)) +

geom_col() +

geom_text(aes(label = label),

position = position_stack(vjust = 0.5),

size = 3.2, color = "black") +

scale_y_continuous(labels = scales::percent_format()) +

scale_fill_manual(values = c("Απουσία" = "#B22222", "Παρουσία" = "#228B22")) +

labs(

title = paste0("PH by Age Group:", variable),

x = "Ηλικιακή Ομάδα", y = "Ποσοστό", fill = "PH"

) +

theme(axis.text.x = element_text(angle = 30, hjust = 1)) +

annotate("text", x = Inf, y = Inf,

label = paste0("Fisher MC p =", signif(fisher_mc$p.value, 3)),

hjust = 1.05, vjust = 1.5, size = 3.5, color = "darkblue") +

coord_flip()

results_plots[[variable]] <- p

}

# Print all tables and plots

for (variable in ph_to_plot) {

print(results_tables[[variable]])

print(results_plots[[variable]])

}
```

Έπειτα εφαρμόζεται συνεκτίμηση με το φύλο.+++

```{r}
# PH by Sex ----

# Subset (Sex_Binary NAs removed)

ph_subset <- osteodata_joined %>%

dplyr::select(starts_with("PH_"), `Sex_Binar`) %>%

filter(!is.na(`Age Group`), !is.na(`Sex_Binary`), !is.na(`Σχετική Χρονολόγηση`))

ph_to_plot <- c(

"PH_FRONTAL_ext", "PH_OCCIPITAL_ext",

"PH_PARIETAL_L_ext", "PH_PARIETAL_R_ext",

"PH_FRONTAL_int", "PH_OCCIPITAL_int",

"PH_PARIETAL_L_int", "PH_PARIETAL_R_int"

)

results_tables <- list()

results_plots <- list()

for (variable in ph_to_plot) {

# Make binary

ph_binary <- ph_subset %>%

filter(!is.na(.data[[variable]])) %>%

mutate(Presence = ifelse(.data[[variable]] == "0", "Απουσία", "Παρουσία"))

# Calculate Chi Square test-of-indipendence & φ

tab <- table(ph_binary$Presence, ph_binary$`Sex_Binary`)

chi2_toi <- chisq.test(tab, correct = FALSE )

phi <- sqrt(chi2_toi$statistic/sum(tab))

# Table

tbl <- ph_binary %>%

dplyr::select(Presence, `Sex_Binary`) %>%

droplevels() %>%

tbl_summary(

by = `Sex_Binary`,

label = list(Presence ~ variable),

statistic = list(all_categorical() ~ "{n} ({p}%)"),

missing = "no"

) %>%

modify_header(label ~ "") %>%

modify_spanning_header(everything() ~ "") %>%

modify_caption(paste0("**", variable, " βάσει Φύλου**")) %>%

modify_footnote(

everything() ~ paste0(

"Chi Square: p =", signif(chi2_toi$p.value, 3),

"φ =", signif(phi))

)

results_tables[[variable]] <- tbl

# Plot

summary_df <- ph_binary %>%

dplyr::count(`Sex_Binary`, Presence) %>%

group_by(`Sex_Binary`) %>%

mutate(prop = n / sum(n),

label = paste0(n, " (", round(100 * prop, 1),"%)")) %>%

ungroup()

p <- ggplot(summary_df, aes(x = `Sex_Binary`, y = prop, fill = Presence)) +

geom_col() +

geom_text(aes(label = label),

position = position_stack(vjust = 0.5),

size = 3.2, color = "black") +

scale_y_continuous(labels = scales::percent_format()) +

scale_fill_manual(values = c("Απουσία" = "#B22222", "Παρουσία" = "#228B22")) +

labs(

title = paste0("PH βάσει Φύλου:", variable),

x = "Φύλο", y = "Ποσοστό", fill = "PH"

) +

theme(axis.text.x = element_text(angle = 30, hjust = 1)) +

annotate("text", x = Inf, y = Inf,

label = paste0(

"Chi Square: p =", signif(chi2_toi$p.value, 3),

"φ =", signif(phi)),

hjust = 1.05, vjust = 1.5, size = 3.5, color = "darkblue")

results_plots[[variable]] <- p

}

# Print all tables and plots

for (variable in ph_to_plot) {

print(results_tables[[variable]])

print(results_plots[[variable]])

}


Εφαρμόζεται, συνεκτίμηση βάσει χρονικής περιόδου.+++


# PH by Σχετική Χρονολόγηση ----

# Subset (Σχετική Χρονολόγηση NAs removed)

ph_subset <- osteodata_joined %>%

dplyr::select(starts_with("PH_"), `Σχετική Χρονολόγηση`) %>%

filter(!is.na(`Σχετική Χρονολόγηση`))

ph_to_plot <- c(

"PH_FRONTAL_ext", "PH_OCCIPITAL_ext",

"PH_PARIETAL_L_ext", "PH_PARIETAL_R_ext",

"PH_FRONTAL_int", "PH_OCCIPITAL_int",

"PH_PARIETAL_L_int", "PH_PARIETAL_R_int"

)

results_tables <- list()

results_plots <- list()

for (variable in ph_to_plot) {

# Make binary

ph_binary <- ph_subset %>%

filter(!is.na(.data[[variable]])) %>%

mutate(Presence = ifelse(.data[[variable]] == "0", "Απουσία", "Παρουσία"))

# Calculate Fisher (Monte Carlo)

tab <- table(ph_binary$Presence, ph_binary$`Σχετική Χρονολόγηση`)

fisher_mc <- fisher.test(tab, simulate.p.value = TRUE, B = 10000)

# Table

tbl <- ph_binary %>%

dplyr::select(Presence, `Σχετική Χρονολόγηση`) %>%

droplevels() %>%

tbl_summary(

by = `Σχετική Χρονολόγηση`,

label = list(Presence ~ variable),

statistic = list(all_categorical() ~ "{n} ({p}%)"),

missing = "no"

) %>%

modify_header(label ~ "") %>%

modify_spanning_header(everything() ~ "") %>%

modify_caption(paste0("**", variable, " βάσει Χρονικής Περιόδου**")) %>%

modify_footnote(

everything() ~ paste0("Fisher's exact test (MC, B=10000): p =", signif(fisher_mc$p.value, 3))

)

results_tables[[variable]] <- tbl

# Plot

summary_df <- ph_binary %>%

dplyr::count(`Σχετική Χρονολόγηση`, Presence) %>%

group_by(`Σχετική Χρονολόγηση`) %>%

mutate(prop = n / sum(n),

label = paste0(n, " (", round(100 * prop, 1),"%)")) %>%

ungroup()

p <- ggplot(summary_df, aes(x = `Σχετική Χρονολόγηση`, y = prop, fill = Presence)) +

geom_col() +

geom_text(aes(label = label),

position = position_stack(vjust = 0.5),

size = 3.2, color = "black") +

scale_y_continuous(labels = scales::percent_format()) +

scale_fill_manual(values = c("Απουσία" = "#B22222", "Παρουσία" = "#228B22")) +

labs(

title = paste0("PH βάσει Χρονικής Περιόδου:", variable),

x = "Χρονολόγηση", y = "Ποσοστό", fill = "PH"

) +

theme(axis.text.x = element_text(angle = 30, hjust = 1)) +

annotate("text", x = Inf, y = Inf,

label = paste0("Fisher MC p =", signif(fisher_mc$p.value, 3)),

hjust = 1.05, vjust = 1.5, size = 3.5, color = "darkblue") +

coord_flip()

results_plots[[variable]] <- p

}

# Print all tables and plots

for (variable in ph_to_plot) {

print(results_tables[[variable]])

print(results_plots[[variable]])

}
```

Τέλος, συνεκτιμάται βάσει φύλου, ηλικίας, φύλου και χρονικής περιόδου μόνο στις περιπτώσεις ενηλίκων καθώς το φύλο δεν είναι εφικτό να προσδιοριστεί στους ανηλίκους. Αποκλείοντας τις μη χρονολογημένες ταφές και τις ταφές όπου δεν ήταν εφικτός ο υπολογισμός της ηλικιακής ομάδας καταλήγουμε με ένα μικρό δείγμα. Ωστόσο, επιχειρούμε να ερμηνεύσουμε τα πιθανά μοτίβα.

Η πιθανότητα να εμφανιστεί η ΠΥ εσωτερικά του κρανιακού θολου σπάνια ξεπερνούσε το 12% σε όλες τις χρονικές περιόδους για τον ενήλικο πληθυσμό ανεξαρτήτως φύλου ή ήλικίας. Εξαίρεση αποτελεί η ΠΥ εσωτερικά του ινιακού και των βρεγματικών κατα τον 5ο αιώνα όπου η πιθανότητα έφτανε στο 25% για τους άνδρες. Εξωτερικά του κρανιακού θόλου κυμαινόταν σε χαμηλά επίπεδα (15-20%) με εξαίρεση μετά τον 2ο αιώνα όταν εμφανίζει ποσοστά που ξεπερνούν το 60%.

Σε όλες τις περιόδους η πιθανότητα να εμφανιστεί η ΠΥ κυμαινόταν στις ίδιες τιμές μεταξύ των ηλικιακών ομάδων (διαφορά \\\~5%). Εξαίρεση αποτελεί το ινιακό όπου διαφορά της πιθανότητας εμφάνισης μεταξύ των ηλικιακών ομάδων έφτανε το 15%.

Σε όλες τις περιοδους οι άνδρες ήταν πιο πιθανό να εμφανίσουν ΠΥ έναντι των γυναικών. στο ινιακό και στα βρεγματικά Οι γυναίκες ήταν πιο πιθανό μόνο μετά τον 2ο αιώνα όταν και φτάνουν στη μεγαλύτερη πιθανότητα όλου του δείγματος (\\\~60%) εσωτερικά και εξωτερικά του ινιακού. Στο ινιακό παρατηρείται η μεγαλύτερη διαφορά μεταξύ ανδρών και γυναικών. Εξωτερικά του ινιακού η διαφορά φτάνει μετά τον 2ο αιώνα να ξεπερνάει τις 20 ποσοστιαίες μονάδες.

```{r}
# PH ~ Age Group, Sex & Chronology ----

ph_to_model <- c(

"PH_FRONTAL_ext", "PH_OCCIPITAL_ext",

"PH_PARIETAL_L_ext", "PH_PARIETAL_R_ext",

"PH_FRONTAL_int", "PH_OCCIPITAL_int",

"PH_PARIETAL_L_int", "PH_PARIETAL_R_int"

)

results_tables <- list()

results_plots <- list()

for (variable in ph_to_model) {

# Subset: remove NAs in DV + IVs, recode DV as 0/1 numeric

ph_subset <- osteodata_joined %>%

dplyr::select(all_of(variable), `Age Group`, Sex_Binary, `Σχετική Χρονολόγηση`) %>%

filter(!is.na(.data[[variable]]),

!is.na(`Age Group`),

!is.na(Sex_Binary),

!is.na(`Σχετική Χρονολόγηση`)) %>%

mutate(!!variable :=as.numeric(.data[[variable]] != "0")) %>%

mutate(

`Age Group` = factor(`Age Group`),

`Sex_Binary` = factor(Sex_Binary),

`Σχετική Χρονολόγηση` = factor(`Σχετική Χρονολόγηση`))

# GLM logistic regression

glm_model <- glm(as.formula(paste(variable, "~ `Age Group` + Sex_Binary + `Σχετική Χρονολόγηση`")),

data = ph_subset,

family = binomial)

# Odds ratios table

glm_table <- tbl_regression(glm_model, exponentiate = TRUE) %>%

modify_caption(paste0("**Logistic regression for", variable, "**")) %>%

modify_footnote(everything() ~ "GLM (binomial logistic regression), OR = Odds Ratio, CI = 95% Confidence Interval")

results_tables[[variable]] <- glm_table

# Predicted probabilities

pred_data <- ggeffects::ggpredict(glm_model,

terms = c("Age Group", "Sex_Binary", "Σχετική Χρονολόγηση"))

glm_plot <- ggplot(pred_data, aes(x = x, y = predicted, color = group)) +

geom_point(position = position_dodge(width = 0.5)) +

geom_errorbar(aes(ymin = conf.low, ymax = conf.high),

width = 0.2, position = position_dodge(width = 0.5)) +

facet_wrap(~facet, nrow = 1) +

scale_y_continuous(labels = scales::percent_format()) +

labs(

title = paste0("Predicted probability of", variable),

x = "", y ="Predicted probability", color = "Sex"

) +

theme(axis.text.x = element_text(angle = 30, hjust = 1))

results_plots[[variable]] <- glm_plot

}

# Print all results

for (variable in ph_to_model) {

print(results_tables[[variable]])

print(results_plots[[variable]])

}
```

###### CO - Cribra Orbitalia

H Cribra Orbitalia (CO) εμφανίζεται σε υψηλό ποσοστό στο σύνολο του πληθυσμού με την δεξιά οφθαλμική κόγχη να παρουσιάζει ελαφρώς μεγαλύτερη συχνότητα (39%) από την αριστερή (35%). Οι παρατηρούμενες συχνότητες διαφέρουν σημαντικά από τις αναμενόμενες στην αριστερή (Binomial test (p=0.5): n = 200, successes = 69 → p = 1.39e-05) και δεξιά πλευρά (Binomial test (p=0.5): n = 174, successes = 67 → p = 0.003).

```{r}
# CO ----

## Subset

co_subset <- osteodata_joined %>%

dplyr::select(starts_with("Cribra Orbitalia_"))

co_to_plot <- c("Cribra Orbitalia_l", "Cribra Orbitalia_r")

## Loop

results_binom <- list()

for (variable in co_to_plot) {

### mutate into binom

co_binary <- co_subset %>%

dplyr::mutate(

Presence = ifelse(.data[[variable]] == "0", "Απουσία", "Παρουσία")

)

### Binomial test (H0: 50/50)

freq_table <- table(co_binary$Presence)

binom_test <- binom.test(freq_table, p = 0.5)

### Table

tbl_co_binom <- co_binary %>%

dplyr::select(Presence) %>%

tbl_summary(

label = list(Presence ~ variable),

statistic = list(all_categorical() ~ "{n} ({p}%)"),

missing = "no"

) %>%

modify_header(label ~ "") %>%

modify_spanning_header(everything() ~ "") %>%

modify_caption(paste0("**Κατανομή:", variable, "**")) %>%

modify_footnote(

everything() ~ paste0("Binomial test (p=0.5):",

"n =", sum(freq_table),

", successes =", freq_table["Παρουσία"],

" → p = ", signif(binom_test$p.value, 3))

)

results_binom[[variable]] <- tbl_co_binom

}

### Print

for (variable in co_to_plot) {

print(results_binom[[variable]])

}
```

Παρατηρείται συχνότερα η ήπια ένδειξη της Cribra Orbitalia. Ενδεικτικά, η δεξιά οφθαλμική κόγχη εμφανίζει ήπια ένδειξη στο 14,9%, μέτρια στο 7,5%, σοβαρή στο 10,3% και πολύ σοβαρή στο 5,7%. Όσον αφορά τα επίπεδα ίασης στο ίδιο οστικό σημείο, η αλλοίωση παρατηρείται ως ενεργή στο 25,2% ενώ υπό ίαση στο 18,9%. Οι παρατηρούμενες συχνότητες διαφέρουν σημαντικά από τις αναμενόμενες (Chi-square GOF: Χ²(12) = 728.38, p = 3.7e-148). Όλα τα οστικά σημεία παρουσιάζουν παρόμοια κατανομή με την δεξιά οφθαλμική κόγχη.

```{r}
# CO ----

co_subset <- osteodata_joined %>%

dplyr::select(starts_with("Cribra Orbitalia_"))

co_to_plot <- c("Cribra Orbitalia_l", "Cribra Orbitalia_r")

new_levels <- c('Απουσία',

'Ήπια ένδειξη-Ενεργή',

'Ήπια ένδειξη-Πρώιμη ίαση',

'Ήπια ένδειξη-Προχωρημένη ίαση',

'Ήπια ένδειξη-Πλήρης ίαση',

'Μέτρια ένδειξη-Ενεργή',

'Μέτρια ένδειξη-Πρώιμη ίαση',

'Μέτρια ένδειξη-Προχωρημένη ίαση',

'Μέτρια ένδειξη-Πλήρης ίαση',

'Σοβαρή ένδειξη-Ενεργή',

'Σοβαρή ένδειξη-Πρώιμη ίαση',

'Σοβαρή ένδειξη-Προχωρημένη ίαση',

'Σοβαρή ένδειξη-Πλήρης ίαση',

'Πολύ σοβαρή ένδειξη-Ενεργή',

'Πολύ σοβαρή ένδειξη-Πρώιμη ίαση',

'Πολύ σοβαρή ένδειξη-Προχωρημένη ίαση',

'Πολύ σοβαρή ένδειξη-Πλήρης ίαση')

## Plot (Chi-Square Test) ----

results <- list()

for (variable in co_to_plot) {

# Chi-square goodness-of-fit

freq_table <- table(co_subset[[variable]])

chi2GofF <- suppressWarnings(chisq.test(freq_table))

# table

tbl_co <- co_subset %>%

dplyr::select(dplyr::all_of(variable)) %>%

tbl_summary(

label = list(all_of(variable) ~ variable),

statistic = list(all_categorical() ~ "{n} ({p}%)"),

missing = "no"

) %>%

modify_header(label ~ "") %>%

modify_spanning_header(everything() ~ "") %>%

modify_caption(paste0("**Κατανομή:", variable, "**")) %>%

modify_footnote(

everything() ~ paste0("Chi-square GOF: Χ²(",

chi2GofF$parameter, ") =",

round(chi2GofF$statistic, 2),

", p =", signif(chi2GofF$p.value, 3))

)

results[[variable]] <- tbl_co

}

for (variable in co_to_plot) {

print(results[[variable]])

}
```

Για την συνεκτίμηση των ανεξάρτητων μεταβλητών της ηλικίας, του φύλου και της χρονικής περιόδου η CO υπολογίστηκε ως διχοτομημένη μεταβλητή καθώς η περαιτέρω κατηγοριοποίηση θα δημιουργούσε υπερβολικό κατακερματισμό του δείγματος με συνέπεια τα στατιστικά τεστ να υπερέβαλαν στις εκτιμήσεις τους.

Αρχικά γίνεται συνεκτίμηση με την ηλικία. Οι νεαροί ενήλικοι εμφανίζουν τη συχνότερη παρουσία στην αριστερή οφθαλμική κόγχη (58,9%) και οι έφηβοι στη δεξιά (78,3%). Η δοκιμή Fisher έδειξε στατιστικά σημαντική συσχέτιση (p \\\< 0,001) και των δύο πλευρών με την ηλικία..

```{r}
# CO by Age Group ----

# Subset (Age Group NAs removed)
co_subset <- osteodata_joined %>%
dplyr::select(starts_with("Cribra Orbitalia_"), `Age Group`) %>%
filter(!is.na(`Age Group`))

co_to_plot <- c("Cribra Orbitalia_l", "Cribra Orbitalia_r")

results_tables <- list()
results_plots <- list()

for (variable in co_to_plot) {
# Make binary
co_binary <- co_subset %>%
filter(!is.na(.data[[variable]])) %>%
mutate(Presence = ifelse(.data[[variable]] == "0", "Απουσία", "Παρουσία"))

# Calculate Fisher (Monte Carlo)
tab <- table(co_binary$Presence, co_binary$`Age Group`)
fisher_mc <- fisher.test(tab, simulate.p.value = TRUE, B = 10000)

# Table
tbl <- co_binary %>%
dplyr::select(Presence, `Age Group`) %>%
droplevels() %>%
tbl_summary(
by = `Age Group`,
label = list(Presence ~ variable),
statistic = list(all_categorical() ~ "{n} ({p}%)"), missing = "no")%>%
modify_header(label ~ "") %>%
modify_spanning_header(everything() ~ "") %>%
modify_caption(paste0("**", variable, " by Age Group**")) %>%
modify_footnote(
everything() ~ paste0("Fisher's exact test (MC, B=10000): p =",
signif(fisher_mc$p.value, 3))
)

results_tables[[variable]] <- tbl

# Plot
summary_df <- co_binary %>%
dplyr::count(`Age Group`, Presence) %>%
group_by(`Age Group`) %>%
mutate(prop = n / sum(n),
label = paste0(n, " (", round(100 * prop, 1),"%)")) %>%
ungroup()

p <- ggplot(summary_df, aes(x = `Age Group`, y = prop, fill = Presence)) +
geom_col() +
geom_text(aes(label = label),
position = position_stack(vjust = 0.5),
size = 3.2, color = "black") +
scale_y_continuous(labels = scales::percent_format()) +
scale_fill_manual(values = c("Απουσία" = "#B22222", "Παρουσία" = "#228B22")) +
labs(
title = paste0("CO by Age Group:", variable),
x = "Ηλικιακή Ομάδα", y = "Ποσοστό", fill = "CO"
) +
theme(axis.text.x = element_text(angle = 30, hjust = 1)) +
annotate("text", x = Inf, y = Inf,
label = paste0("Fisher MC p =", signif(fisher_mc$p.value, 3)),
hjust = 1.05, vjust = 1.5, size = 3.5, color = "darkblue") +
coord_flip()

results_plots[[variable]] <- p
}

# Print all tables and plots
for (variable in co_to_plot) {
print(results_tables[[variable]])
print(results_plots[[variable]])
}
```

Τα δύο φύλα παρουσιάζουν παρόμοιες συχνότητες εμφάνισης. Η αριστερή οφθλαμική κόγχη εμφανίζει CO στο 34,8% των ανδρών και στο 33,8% των γυναικών. Η δεξιά κόγχη εμφανίζει CO στο 33,3% των ανδρών και στο 35,7 των γυναικών. Οι παρατηρούμενες τιμές διαφέρουν σημαντικά από τις αναμενόμενες στην αριστερή (Chi-square p = 0.882, φ = 0.011373) και δεξιά οφθαλμική κόγχη (Chi-square p = 0.761, φ = 0.0250136)).

```{r}
# CO by Sex ----

# Subset (Sex_Binary NAs removed)

co_subset <- osteodata_joined %>%

dplyr::select(starts_with("Cribra Orbitalia_"), `Sex_Binary`) %>%

filter(!is.na(`Sex_Binary`))

co_to_plot <- c("Cribra Orbitalia_l", "Cribra Orbitalia_r")

results_tables <- list()

results_plots <- list()

for (variable in co_to_plot) {

# Make binary

co_binary <- co_subset %>%

filter(!is.na(.data[[variable]])) %>%

mutate(Presence = ifelse(.data[[variable]] == "0", "Απουσία", "Παρουσία"))

# Calculate Chi Square test-of-indipendence & φ

tab <- table(co_binary$Presence, co_binary$`Sex_Binary`)

chi2_toi <- chisq.test(tab, correct = FALSE )

phi <- sqrt(chi2_toi$statistic/sum(tab))

# Table

tbl <- co_binary %>%

dplyr::select(Presence, `Sex_Binary`) %>%

droplevels() %>%

tbl_summary(

by = `Sex_Binary`,

label = list(Presence ~ variable),

statistic = list(all_categorical() ~ "{n} ({p}%)"),

missing = "no"

) %>%

modify_header(label ~ "") %>%

modify_spanning_header(everything() ~ "") %>%

modify_caption(paste0("**", variable, " βάσει Φύλου**")) %>%

modify_footnote(

everything() ~ paste0(

"Chi Square: p =", signif(chi2_toi$p.value, 3),

"φ =", signif(phi))

)

results_tables[[variable]] <- tbl

# Plot

summary_df <- co_binary %>%

dplyr::count(`Sex_Binary`, Presence) %>%

group_by(`Sex_Binary`) %>%

mutate(prop = n / sum(n),

label = paste0(n, " (", round(100 * prop, 1),"%)")) %>%

ungroup()

p <- ggplot(summary_df, aes(x = `Sex_Binary`, y = prop, fill = Presence)) +

geom_col() +

geom_text(aes(label = label),

position = position_stack(vjust = 0.5),

size = 3.2, color = "black") +

scale_y_continuous(labels = scales::percent_format()) +

scale_fill_manual(values = c("Απουσία" = "#B22222", "Παρουσία" = "#228B22")) +

labs(

title = paste0("CO βάσει Φύλου:", variable),

x = "Φύλο", y = "Ποσοστό", fill = "CO"

) +

theme(axis.text.x = element_text(angle = 30, hjust = 1)) +

annotate("text", x = Inf, y = Inf,

label = paste0(

"Chi Square: p =", signif(chi2_toi$p.value, 3),

"φ =", signif(phi)),

hjust = 1.05, vjust = 1.5, size = 3.5, color = "darkblue")

results_plots[[variable]] <- p

}

# Print all tables and plots

for (variable in co_to_plot) {

print(results_tables[[variable]])

print(results_plots[[variable]])

}
```

Η αριστερή οφθαλμική κόγχη εμφανίζει διακυμάνσεις της Cribra Orbitalia από τον 5ο έως τον 1ο αιώνα. Τον 5ο αι. εμφανίζει το υψηλότερο ποσοστό (56%), μειώνεται τον 4ο (24%), αυξάνεται ξανά στον 3ο (40%), ξανά μειώνεται στον 2ο (25%) και αυξάνεται ξανά στον 1ο (33%). Αξίζει να σημειώθεί πως παρόλες τις διακυμάνσεις βαίνει μειούμενο από τον 5ο έως τον 1ο αιώνα. Παρομοίως, η δεξιά οφθαλμική κόγχη εμφανίζει διακυμάνσεις της Cribra Orbitalia από τον 5ο έως τον 1ο αιώνα. Τον 5ο αι. εμφανίζει υψηλό ποσοστό (53%), μειώνεται τον 4ο (18%), αυξάνεται ξανά στον 3ο (50%), ξανά μειώνεται στον 2ο (31%) και αυξάνεται ξανά στον 1ο (67%). Εδώ παρατηρείται οτι βαίνει αυξανόμενο από τον 5ο έως τον 1ο αιώνα. Η δοκιμή Fisher δεν έδειξε στατιστικά σημαντική συσχέτιση της αριστερής (p = 0,272) ή της δεξιάς (p = 0,081) Cribra Orbitalia έναντι της χρονολόγησης. Κατα συνέπεια, δεν απορρίπτεται η υπόθεση ανεξαρτησίας των δύο μεταβλητών.

```{r}
# CO by Σχετική Χρονολόγηση ----

# Subset (Σχετική Χρονολόγηση NAs removed)

co_subset <- osteodata_joined %>%

dplyr::select(starts_with("Cribra Orbitalia_"), `Σχετική Χρονολόγηση`) %>%

filter(!is.na(`Σχετική Χρονολόγηση`))

co_to_plot <- c("Cribra Orbitalia_l", "Cribra Orbitalia_r")

results_tables <- list()

results_plots <- list()

for (variable in co_to_plot) {

# Make binary

co_binary <- co_subset %>%

filter(!is.na(.data[[variable]])) %>%

mutate(Presence = ifelse(.data[[variable]] == "0", "Απουσία", "Παρουσία"))

# Calculate Fisher (Monte Carlo)

tab <- table(co_binary$Presence, co_binary$`Σχετική Χρονολόγηση`)

fisher_mc <- fisher.test(tab, simulate.p.value = TRUE, B = 10000)

# Table

tbl <- co_binary %>%

dplyr::select(Presence, `Σχετική Χρονολόγηση`) %>%

droplevels() %>%

tbl_summary(

by = `Σχετική Χρονολόγηση`,

label = list(Presence ~ variable),

statistic = list(all_categorical() ~ "{n} ({p}%)"),

missing = "no"

) %>%

modify_header(label ~ "") %>%

modify_spanning_header(everything() ~ "") %>%

modify_caption(paste0("**", variable, " βάσει Χρονικής Περιόδου**")) %>%

modify_footnote(

everything() ~ paste0("Fisher's exact test (MC, B=10000): p =", signif(fisher_mc$p.value, 3))

)

results_tables[[variable]] <- tbl

# Plot

summary_df <- co_binary %>%

dplyr::count(`Σχετική Χρονολόγηση`, Presence) %>%

group_by(`Σχετική Χρονολόγηση`) %>%

mutate(prop = n / sum(n),

label = paste0(n, " (", round(100 * prop, 1),"%)")) %>%

ungroup()

p <- ggplot(summary_df, aes(x = `Σχετική Χρονολόγηση`, y = prop, fill = Presence)) +

geom_col() +

geom_text(aes(label = label),

position = position_stack(vjust = 0.5),

size = 3.2, color = "black") +

scale_y_continuous(labels = scales::percent_format()) +

scale_fill_manual(values = c("Απουσία" = "#B22222", "Παρουσία" = "#228B22")) +

labs(

title = paste0("CO βάσει Χρονικής Περιόδου:", variable),

x = "Χρονολόγηση", y = "Ποσοστό", fill = "CO"

) +

theme(axis.text.x = element_text(angle = 30, hjust = 1)) +

annotate("text", x = Inf, y = Inf,

label = paste0("Fisher MC p =", signif(fisher_mc$p.value, 3)),

hjust = 1.05, vjust = 1.5, size = 3.5, color = "darkblue") +

coord_flip()

results_plots[[variable]] <- p

}

# Print all tables and plots

for (variable in co_to_plot) {

print(results_tables[[variable]])

print(results_plots[[variable]])

}
```

Τέλος, συνεκτιμάται βάσει φύλου, ηλικίας, φύλου και χρονικής περιόδου μόνο στις περιπτώσεις ενηλίκων καθώς το φύλο δεν είναι εφικτό να προσδιοριστεί στους ανηλίκους. Αποκλείοντας τις μη χρονολογημένες ταφές και τις ταφές όπου δεν ήταν εφικτός ο υπολογισμός της ηλικιακής ομάδας καταλήγουμε με ένα μικρό δείγμα. Ωστόσο, επιχειρούμε να ερμηνεύσουμε τα πιθανά μοτίβα. +++

```{r}
# CO ~ Age Group, Sex & Chronology ----

co_to_model <- c("Cribra Orbitalia_l", "Cribra Orbitalia_r")

results_tables <- list()

results_plots <- list()

for (variable in co_to_model) {

# Subset: remove NAs in DV + IVs, recode DV as 0/1 numeric

co_subset <- osteodata_joined %>%

dplyr::select(all_of(variable), `Age Group`, Sex_Binary, `Σχετική Χρονολόγηση`) %>%

filter(!is.na(.data[[variable]]),

!is.na(`Age Group`),

!is.na(Sex_Binary),

!is.na(`Σχετική Χρονολόγηση`)) %>%

mutate(!!variable :=as.numeric(.data[[variable]] != "0")) %>%

mutate(

`Age Group` = factor(`Age Group`),

`Sex_Binary` = factor(Sex_Binary),

`Σχετική Χρονολόγηση` = factor(`Σχετική Χρονολόγηση`))

# GLM logistic regression

glm_model <- glm(as.formula(paste0("`", variable, "` ~ `Age Group` + Sex_Binary + `Σχετική Χρονολόγηση`")),

data = co_subset,

family = binomial)

# Odds ratios table

glm_table <- tbl_regression(glm_model, exponentiate = TRUE) %>%

modify_caption(paste0("**Logistic regression for", variable, "**")) %>%

modify_footnote(everything() ~ "GLM (binomial logistic regression), OR = Odds Ratio, CI = 95% Confidence Interval")

results_tables[[variable]] <- glm_table

# Predicted probabilities

pred_data <- ggeffects::ggpredict(glm_model,

terms = c("Age Group", "Sex_Binary", "Σχετική Χρονολόγηση"))

glm_plot <- ggplot(pred_data, aes(x = x, y = predicted, color = group)) +

geom_point(position = position_dodge(width = 0.5)) +

geom_errorbar(aes(ymin = conf.low, ymax = conf.high),

width = 0.2, position = position_dodge(width = 0.5)) +

facet_wrap(~facet, nrow = 1) +

scale_y_continuous(labels = scales::percent_format()) +

labs(

title = paste0("Predicted probability of", variable),

x = "", y ="Predicted probability", color = "Sex"

) +

theme(axis.text.x = element_text(angle = 30, hjust = 1))

results_plots[[variable]] <- glm_plot

}

# Print all results

for (variable in co_to_model) {

print(results_tables[[variable]])

print(results_plots[[variable]])

}
```

#### Μετακρανιακή παθολογία

###### PER - Περιοστίτιδα

Η περιοστίτιδα στις κνήμες υπολογίστηκε ως διωνυμική κατόπιν συνυπολογισμού της βαθμίδας 1 ( έντονες διαμήκες γραμμώσεις) στη βαθμίδα της απουσίας.

```{r}
# PER ----

## Subset
per_subset <- osteodata_joined %>%
dplyr::select(starts_with("PER_TIBIA_"))

per_to_plot <- c("PER_TIBIA_PD_L","PER_TIBIA_MD_L","PER_TIBIA_DD_L","PER_TIBIA_PD_R","PER_TIBIA_MD_R","PER_TIBIA_DD_R")

## Loop
results_binom <- list()
for (variable in per_to_plot) {

### mutate into binom
per_binary <- per_subset %>%
dplyr::mutate(
Presence = ifelse(.data[[variable]] %in% c("0", "1"), "Απουσία", "Παρουσία")) %>%
filter(!is.na(.data[[variable]]))

### Binomial test (H0: 50/50)
freq_table <- table(per_binary$Presence)
binom_test <- binom.test(freq_table, p = 0.5)

### Table
tbl_per_binom <- per_binary %>%
dplyr::select(Presence) %>%
tbl_summary(
label = list(Presence ~ variable),
statistic = list(all_categorical() ~ "{n} ({p}%)"),
missing = "no") %>%
modify_header(label ~ "") %>%
modify_spanning_header(everything() ~ "") %>%
modify_caption(paste0("**Κατανομή:", variable, "**")) %>%
modify_footnote(
everything() ~ paste0("Binomial test (p=0.5):",
"n =", sum(freq_table),
", successes =", freq_table["Παρουσία"],
" → p = ", signif(binom_test$p.value, 3))
)

results_binom[[variable]] <- tbl_per_binom
}

### Print
for (variable in per_to_plot) {
print(results_binom[[variable]])
}
```

Ως διωνυμική υπολογίστηκε και αφού φιλτραρίστηκε ανα κνήμη. Επιλέχθηκαν μόνο όσες κνήμες είχαν και τα τρία μέρη της διάφυσης (απορρίπτονται όσες περιπτώσεις είχαν τουλάχιστον μία ελλιπούσα τιμή). Η παθολογία στην εκάστοτε κνήμη κνήμη οριζόταν ως παρούσα όταν έστω ένα μέρης της σχετικής διάφυσης είχε παθολογική ένδειξη μεγαλύτερη ή ίση της 2ης βαθμίδας. Σε αυτή την περίπτωση υπολογίζεται όταν ένα άτομο έχει έστω και μία κνήμη παρούσα.

```{r}
## Subset
per_subset <- osteodata_joined %>%
dplyr::select(starts_with("PER_TIBIA_"))

results_binom <- list()

# Ομαδοποιήσεις για Αριστερή και Δεξιά
tibia_groups <- list(
Left = c("PER_TIBIA_PD_L","PER_TIBIA_MD_L","PER_TIBIA_DD_L"),
Right = c("PER_TIBIA_PD_R","PER_TIBIA_MD_R","PER_TIBIA_DD_R")
)

for (side in names(tibia_groups)) {
tibia_vars <- tibia_groups[[side]]

# Φτιάχνουμε subset μόνο αν έχουν όλα τα τμήματα (όχι NA)
tibia_binary <- per_subset %>%
filter(!if_any(all_of(tibia_vars), is.na)) %>% # κρατάει μόνο κνήμες με όλα τα τμήματα
mutate(
Presence = if_else(
if_any(all_of(tibia_vars), ~ .x %in% c("2","3","4","5","6","7")), "Παρουσία", "Απουσία"))

# Binomial test
freq_table <- table(tibia_binary$Presence)
binom_test <- binom.test(freq_table, p = 0.5)

# Table
tbl_tibia_binom <- tibia_binary %>%
select(Presence) %>%
tbl_summary(
label = list(Presence ~ side),
statistic = list(all_categorical() ~ "{n} ({p}%)"),
missing = "no") %>%
modify_header(label ~ "") %>%
modify_spanning_header(everything() ~ "") %>%
modify_caption(paste0("**Κατανομή:", side, " Tibia**")) %>%
modify_footnote(
everything() ~ paste0("Binomial test (p=0.5):",
"n =", sum(freq_table),
", successes =", freq_table["Παρουσία"],
" → p = ", signif(binom_test$p.value, 3))
)

results_binom[[side]] <- tbl_tibia_binom
}

# Print
for (side in names(results_binom)) {
print(results_binom[[side]])
}
```

Ακολουθήθηκε η ίδια μεθοδολογία εκτιμώντας μόνο τα άτομα που είχαν και τις δύο κνήμες.

```{r}
# PER: Αριστερή vs Δεξιά κνήμη ----
## Subset: μόνο κνήμες
per_subset <- osteodata_joined %>%
dplyr::select(ID, starts_with("PER_TIBIA_"))

## Κρατάμε μόνο τα άτομα με πλήρη L & R (3/3 τμήματα η καθεμία)
per_complete <- per_subset %>%
filter(
!is.na(PER_TIBIA_PD_L), !is.na(PER_TIBIA_MD_L), !is.na(PER_TIBIA_DD_L), !is.na(PER_TIBIA_PD_R), !is.na(PER_TIBIA_MD_R), !is.na(PER_TIBIA_DD_R)) %>%
mutate(
Presence_L = ifelse(
PER_TIBIA_PD_L %in% c("0","1") &
PER_TIBIA_MD_L %in% c("0","1") &
PER_TIBIA_DD_L %in% c("0","1"), "Απουσία", "Παρουσία"),
Presence_R = ifelse(
PER_TIBIA_PD_R %in% c("0","1") &
PER_TIBIA_MD_R %in% c("0","1") &
PER_TIBIA_DD_R %in% c("0","1"), "Απουσία", "Παρουσία")
)

## Συχνότητες
tbl_per_lr <- per_complete %>%
dplyr::select(Presence_L, Presence_R) %>%

tbl_summary(
statistic = list(all_categorical() ~ "{n} ({p}%)"),
missing = "no") %>%
modify_caption("**Συχνότητες περιόστωσης: Αριστερή vs Δεξιά κνήμη**")

## Fisher test
freq_table_lr <- table(per_complete$Presence_L, per_complete$Presence_R)
fisher_lr <- fisher.test(freq_table_lr)

## Προσθήκη αποτελέσματος στο υποσέλιδο
tbl_per_lr <- tbl_per_lr %>%
modify_footnote(
everything() ~ paste0("Fisher’s Exact Test: p = ", signif(fisher_lr$p.value, 3))
)

## Print
print(tbl_per_lr)
print(freq_table_lr)
```

Η περιοστίτιδα εμφανίζεται στο 13% των μέσων ενηλίκων, στο 11% των ώριμων και στο 6% των νεαρών ενηλίκων. Δεν παρατηρήθηκε στους ανήλικους (να μπει στη συζήτηση: λόγω της επιλογής ατόμων και με τις δύο κνήμες παρούσες στη συγκεκριμένη ανάλυση το δείγμα ανηλίκων κατέληξε εξαιρετικά μικρό \<10 ατόμων).

```{r}
# PER by Age Group ----

## Subset (Age Group NAs removed)
per_subset <- osteodata_joined %>%
  dplyr::select(PER_TIBIA_PD_L, PER_TIBIA_MD_L, PER_TIBIA_DD_L,
                PER_TIBIA_PD_R, PER_TIBIA_MD_R, PER_TIBIA_DD_R,
                `Age Group`) %>%
  filter(!is.na(`Age Group`))

results_tables <- list()
results_plots <- list()

## Collapse to one DV per individual:
## Presence if at least one tibia (left or right) has any part >= 2
per_binary <- per_subset %>%
  filter(!is.na(PER_TIBIA_PD_L), !is.na(PER_TIBIA_MD_L), !is.na(PER_TIBIA_DD_L),
         !is.na(PER_TIBIA_PD_R), !is.na(PER_TIBIA_MD_R), !is.na(PER_TIBIA_DD_R)) %>%
mutate(
Left  = ifelse(PER_TIBIA_PD_L %in% c("0","1") &
               PER_TIBIA_MD_L %in% c("0","1") &
               PER_TIBIA_DD_L %in% c("0","1"), "Απουσία", "Παρουσία"),
Right = ifelse(PER_TIBIA_PD_R %in% c("0","1") &
               PER_TIBIA_MD_R %in% c("0","1") &
               PER_TIBIA_DD_R %in% c("0","1"), "Απουσία", "Παρουσία"),
Presence = ifelse(Left == "Παρουσία" | Right == "Παρουσία", "Παρουσία", "Απουσία")
)

## Fisher’s exact (MC)
tab <- table(per_binary$Presence, per_binary$`Age Group`)
fisher_mc <- fisher.test(tab, simulate.p.value = TRUE, B = 10000)

## Table
tbl <- per_binary %>%
  dplyr::select(Presence, `Age Group`) %>%
  droplevels() %>%
  tbl_summary(
    by = `Age Group`,
    label = list(Presence ~ "Periostitis"),
    statistic = list(all_categorical() ~ "{n} ({p}%)"),
    missing = "no"
  ) %>%
  modify_header(label ~ "") %>%
  modify_spanning_header(everything() ~ "") %>%
  modify_caption("**Periostitis by Age Group (both tibiae present)**") %>%
  modify_footnote(
    everything() ~ paste0("Fisher's exact test (MC, B=10000): p = ",
                          signif(fisher_mc$p.value, 3))
  )

results_tables[["PER"]] <- tbl

## Plot
summary_df <- per_binary %>%
  dplyr::count(`Age Group`, Presence) %>%
  group_by(`Age Group`) %>%
  mutate(prop = n / sum(n),
         label = paste0(n, " (", round(100 * prop, 1), "%)")) %>%
  ungroup()

p <- ggplot(summary_df, aes(x = `Age Group`, y = prop, fill = Presence)) +
  geom_col() +
  geom_text(aes(label = label),
            position = position_stack(vjust = 0.5),
            size = 3.2, color = "black") +
  scale_y_continuous(labels = scales::percent_format()) +
  scale_fill_manual(values = c("Απουσία" = "#B22222", "Παρουσία" = "#228B22")) +
  labs(
    title = "Periostitis by Age Group (both tibiae present)",
    x = "Ηλικιακή Ομάδα", y = "Ποσοστό", fill = "Periostitis"
  ) +
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +
  annotate("text", x = Inf, y = Inf,
           label = paste0("Fisher MC p = ", signif(fisher_mc$p.value, 3)),
           hjust = 1.05, vjust = 1.5, size = 3.5, color = "darkblue") +
  coord_flip()

results_plots[["PER"]] <- p

## Print
print(results_tables[["PER"]])
print(results_plots[["PER"]])

```

Η περιοστίτιδα εμφανίζεται ελαφρώς συχνότερα στους άνδρες (13%) από ότι στις γυναίκες (10%).

```{r}
# PER by Sex ----

## Subset (Sex_Binary NAs removed)
per_subset <- osteodata_joined %>%
  dplyr::select(PER_TIBIA_PD_L, PER_TIBIA_MD_L, PER_TIBIA_DD_L,
                PER_TIBIA_PD_R, PER_TIBIA_MD_R, PER_TIBIA_DD_R,
                Sex_Binary) %>%
  filter(!is.na(Sex_Binary))

results_tables <- list()
results_plots <- list()

## Collapse to one DV per individual:
## Presence if at least one tibia (left or right) has any part >= 2
per_binary <- per_subset %>%
  filter(!is.na(PER_TIBIA_PD_L), !is.na(PER_TIBIA_MD_L), !is.na(PER_TIBIA_DD_L),
         !is.na(PER_TIBIA_PD_R), !is.na(PER_TIBIA_MD_R), !is.na(PER_TIBIA_DD_R)) %>%
  mutate(
    Left  = ifelse(PER_TIBIA_PD_L %in% c("0","1") &
                   PER_TIBIA_MD_L %in% c("0","1") &
                   PER_TIBIA_DD_L %in% c("0","1"), "Απουσία", "Παρουσία"),
    Right = ifelse(PER_TIBIA_PD_R %in% c("0","1") &
                   PER_TIBIA_MD_R %in% c("0","1") &
                   PER_TIBIA_DD_R %in% c("0","1"), "Απουσία", "Παρουσία"),
    Presence = ifelse(Left == "Παρουσία" | Right == "Παρουσία", "Παρουσία", "Απουσία")
  )

## Fisher’s exact (MC)
tab <- table(per_binary$Presence, per_binary$Sex_Binary)
fisher_mc <- fisher.test(tab, simulate.p.value = TRUE, B = 10000)

## Table
tbl <- per_binary %>%
  dplyr::select(Presence, Sex_Binary) %>%
  droplevels() %>%
  tbl_summary(
    by = Sex_Binary,
    label = list(Presence ~ "Periostitis"),
    statistic = list(all_categorical() ~ "{n} ({p}%)"),
    missing = "no"
  ) %>%
  modify_header(label ~ "") %>%
  modify_spanning_header(everything() ~ "") %>%
  modify_caption("**Periostitis by Sex (both tibiae present)**") %>%
  modify_footnote(
    everything() ~ paste0("Fisher's exact test (MC, B=10000): p = ",
                          signif(fisher_mc$p.value, 3))
  )

results_tables[["PER_sex"]] <- tbl

## Plot
summary_df <- per_binary %>%
  dplyr::count(Sex_Binary, Presence) %>%
  group_by(Sex_Binary) %>%
  mutate(prop = n / sum(n),
         label = paste0(n, " (", round(100 * prop, 1), "%)")) %>%
  ungroup()

p <- ggplot(summary_df, aes(x = Sex_Binary, y = prop, fill = Presence)) +
  geom_col() +
  geom_text(aes(label = label),
            position = position_stack(vjust = 0.5),
            size = 3.2, color = "black") +
  scale_y_continuous(labels = scales::percent_format()) +
  scale_fill_manual(values = c("Απουσία" = "#B22222", "Παρουσία" = "#228B22")) +
  labs(
    title = "Periostitis by Sex (both tibiae present)",
    x = "Φύλο", y = "Ποσοστό", fill = "Periostitis"
  ) +
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +
  annotate("text", x = Inf, y = Inf,
           label = paste0("Fisher MC p = ", signif(fisher_mc$p.value, 3)),
           hjust = 1.05, vjust = 1.5, size = 3.5, color = "darkblue") +
  coord_flip()

results_plots[["PER_sex"]] <- p

## Print
print(results_tables[["PER_sex"]])
print(results_plots[["PER_sex"]])
```

Η περιοστίτιδα εμφανίζεται συχνότερα (20%) κατα τον 3ο αιώνα.

```{r}
# PER by Chronology ----

## Subset (Chronology NAs removed)
per_subset <- osteodata_joined %>%
  dplyr::select(PER_TIBIA_PD_L, PER_TIBIA_MD_L, PER_TIBIA_DD_L,
                PER_TIBIA_PD_R, PER_TIBIA_MD_R, PER_TIBIA_DD_R,
                `Σχετική Χρονολόγηση`) %>%
  filter(!is.na(`Σχετική Χρονολόγηση`))

results_tables <- list()
results_plots <- list()

## Collapse to one DV per individual:
per_binary <- per_subset %>%
  filter(!is.na(PER_TIBIA_PD_L), !is.na(PER_TIBIA_MD_L), !is.na(PER_TIBIA_DD_L),
         !is.na(PER_TIBIA_PD_R), !is.na(PER_TIBIA_MD_R), !is.na(PER_TIBIA_DD_R)) %>%
mutate(
Left  = ifelse(PER_TIBIA_PD_L %in% c("0","1") &
               PER_TIBIA_MD_L %in% c("0","1") &
               PER_TIBIA_DD_L %in% c("0","1"), "Απουσία", "Παρουσία"),
Right = ifelse(PER_TIBIA_PD_R %in% c("0","1") &
               PER_TIBIA_MD_R %in% c("0","1") &
               PER_TIBIA_DD_R %in% c("0","1"), "Απουσία", "Παρουσία"),
Presence = ifelse(Left == "Παρουσία" | Right == "Παρουσία", "Παρουσία", "Απουσία")
)

## Fisher’s exact (MC)
tab <- table(per_binary$Presence, per_binary$`Σχετική Χρονολόγηση`)
fisher_mc <- fisher.test(tab, simulate.p.value = TRUE, B = 10000)

## Table
tbl <- per_binary %>%
  dplyr::select(Presence, `Σχετική Χρονολόγηση`) %>%
  droplevels() %>%
  tbl_summary(
    by = `Σχετική Χρονολόγηση`,
    label = list(Presence ~ "Periostitis"),
    statistic = list(all_categorical() ~ "{n} ({p}%)"),
    missing = "no"
  ) %>%
  modify_header(label ~ "") %>%
  modify_spanning_header(everything() ~ "") %>%
  modify_caption("**Periostitis by Chronology (both tibiae present)**") %>%
  modify_footnote(
    everything() ~ paste0("Fisher's exact test (MC, B=10000): p = ",
                          signif(fisher_mc$p.value, 3))
  )

results_tables[["PER_chrono"]] <- tbl

## Plot
summary_df <- per_binary %>%
  dplyr::count(`Σχετική Χρονολόγηση`, Presence) %>%
  group_by(`Σχετική Χρονολόγηση`) %>%
  mutate(prop = n / sum(n),
         label = paste0(n, " (", round(100 * prop, 1), "%)")) %>%
  ungroup()

p <- ggplot(summary_df, aes(x = `Σχετική Χρονολόγηση`, y = prop, fill = Presence)) +
  geom_col() +
  geom_text(aes(label = label),
            position = position_stack(vjust = 0.5),
            size = 3.2, color = "black") +
  scale_y_continuous(labels = scales::percent_format()) +
  scale_fill_manual(values = c("Απουσία" = "#B22222", "Παρουσία" = "#228B22")) +
  labs(
    title = "Periostitis by Chronology (both tibiae present)",
    x = "Σχετική Χρονολόγηση", y = "Ποσοστό", fill = "Periostitis"
  ) +
  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +
  annotate("text", x = Inf, y = Inf,
           label = paste0("Fisher MC p = ", signif(fisher_mc$p.value, 3)),
           hjust = 1.05, vjust = 1.5, size = 3.5, color = "darkblue") +
  coord_flip()

results_plots[["PER_chrono"]] <- p

## Print
print(results_tables[["PER_chrono"]])
print(results_plots[["PER_chrono"]])
```

Η περιοστίτιδα συνυπολογίζοντας τους ανεξάρτητους παράγοντες της ηλικίας, του φύλου και της χρονολόγησης έχει παρόμοιες πιθανότητες να εμφανιστεί σε όλες τις ηλικιακές ομάδες των ενηλίκων. Από τον 5ο έως τον 3ο αιώνα εμφανίζει μικρή πιθανότητα (\<5%) να εμφανιστεί ενω αυξάνεται κατα τον 3ο αιώνα (\~10%) και ξαναμειώνεται στον 2ο αιώνα στις ίδιες τιμές προ 3ου αιώνα (\<5%). Κατα τους 6ο και 1ο αιώνα οι πιθανότητες δεν είναι ενδεικτικές καθώς βασίζονται σε μικρό δείγμα (1 και 4 άτομα αντίστοιχα). Σε όλες τις περιόδους και ηλικιακές ομάδες παρουσιάζει ελαφρώς μεγαλύτερη πιθανότητα να εμφανιστεί στους άνδρες από ότι στις γυναίκες.

```{r}
# PER ~ Age Group, Sex & Chronology (per individual) ----

# Create binary DV per individual
per_subset <- osteodata_joined %>%
  dplyr::select(starts_with("PER_TIBIA_"), `Age Group`, Sex_Binary, `Σχετική Χρονολόγηση`) %>%
  mutate(
    Periostitis_any = if_else(
      rowSums(across(starts_with("PER_TIBIA_"),
                     ~ as.numeric(.x) >= 2,
                     .names = "tmp_{col}"),
              na.rm = TRUE) > 0, 1, 0)) %>%
  filter(!is.na(`Age Group`),
         !is.na(Sex_Binary),
         !is.na(`Σχετική Χρονολόγηση`))

# Recode factors
per_subset <- per_subset %>%
  mutate(
    `Age Group` = factor(`Age Group`),
    `Sex_Binary` = factor(Sex_Binary),
    `Σχετική Χρονολόγηση` = factor(`Σχετική Χρονολόγηση`)
  )

# GLM logistic regression
glm_model <- glm(Periostitis_any ~ `Age Group` + Sex_Binary + `Σχετική Χρονολόγηση`,
                 data = per_subset, family = binomial)

# Odds ratios table
glm_table <- tbl_regression(glm_model, exponentiate = TRUE) %>%
  modify_caption("**Logistic regression for Periostitis (per individual)**") %>%
  modify_footnote(everything() ~
    "GLM (binomial logistic regression), OR = Odds Ratio, CI = 95% Confidence Interval")

# Predicted probabilities
pred_data <- ggeffects::ggpredict(glm_model,
                                  terms = c("Age Group", "Sex_Binary", "Σχετική Χρονολόγηση"))

glm_plot <- ggplot(pred_data, aes(x = x, y = predicted, color = group)) +
  geom_point(position = position_dodge(width = 0.5)) +
  geom_errorbar(aes(ymin = conf.low, ymax = conf.high),
                width = 0.2, position = position_dodge(width = 0.5)) +
  facet_wrap(~facet, nrow = 1) +
  scale_y_continuous(labels = scales::percent_format()) +
  labs(
    title = "Predicted probability of Periostitis (per individual)",
    x = "", y = "Predicted probability", color = "Sex"
  ) +
  theme(axis.text.x = element_text(angle = 30, hjust = 1))

# Print
print(glm_table)
print(glm_plot)
```

###### Έλεγχος συσχέτισης μεταξύ PH, CO και PER

Θα ελεγχθεί κατά τη στατιστική ανάλυση και η συσχέτιση της Πορώδους Υπερόστωσης, της Cribra Orbitalia και της Περιοστίτιδας καθώς οι πρώτες δύο εμφανίζονται στην κρανιακή περιοχή ενώ η τελευταία στα μακρά οστά και συχνότερα στην κνήμη (Mensforth et al., 1978, p. 8, 12). Θεωρείται οτι εμφανίζεται συχνότερα στα βρέφη, στα παιδιά και στις γυναίκες (Manzon & Gualdi-Russo, 2016, p. 498) λόγω της ευαισθησίας αυτών των ομάδων στη διατροφή, στις μολυσματικές ασθένειες και σε αναπτυξιακούς παράγοντες (Mensforth et al., 1978, pp. 13--21). Με σκοπό την όσο τον δυνατόν μεγαλύτερη αντιπροσώπευση των παθολογικών ενδείξεων στη συγκεκριμένη ανάλυση επιλέχθηκαν άτομα που είχαν τουλάχιστον ένα απο τα δύο βρεγματικά παρόντα για την περιοστίτιδα (είτε εσωτερικά είτε εξωτερικά), μία από τις δύο οφθαλμικές κογχες παρούσες, μία απο τις δύο κνήμες παρούσες και στις περιπτώσεις όπου υπήρχαν και οι δύο αναλύθηκε η αριστερή. Ως παρουσία στην περιοστίτιδα ορίστηκε η ≥2 βαθμίδα.

Παρατηρείται συσχέτιση (p = 0,0431) μεταξύ Πορώδους Υπερόστωσης και Cribra Orbitalia. Το μέγεθος επίδρασης είναι ασθενές έως μέτριο (φ = 0,205). Η Περιοστίτιδα δεν παρουσιάζει καμία συσχέτιση με την Πορώδη Υπερόστωση (p = 0,712) ή την Cribra Orbitalia (p = 0,102).

```{r}
# Pairwise Fisher’s exact tests for PH, CO, PER (per-individual aggregation) ----
# individuals w/ at least 1 parietal, 1 eye socket, 1 tibia (preferably left if both present)

# define var names
ph_vars <- c("PH_PARIETAL_L_ext","PH_PARIETAL_R_ext",
              "PH_PARIETAL_L_int","PH_PARIETAL_R_int")

co_left <- "Cribra Orbitalia_l"
co_right <- "Cribra Orbitalia_r"

per_left_vars  <- c("PER_TIBIA_PD_L","PER_TIBIA_MD_L","PER_TIBIA_DD_L")
per_right_vars <- c("PER_TIBIA_PD_R","PER_TIBIA_MD_R","PER_TIBIA_DD_R")

# Build analysis dataset with per-individual binary indicators
analysis_df <- osteodata_joined %>%
  dplyr::select(all_of(ph_vars),
                all_of(c(co_left, co_right)),
                all_of(per_left_vars), all_of(per_right_vars)) %>%
  # include at least one parietal present, one orbit present, one tibia present
  mutate(
    parietal_present = if_any(all_of(ph_vars), ~ !is.na(.x)),
    orbit_present = if_any(all_of(c(co_left, co_right)), ~ !is.na(.x)),
    tibia_present = if_any(all_of(c(per_left_vars, per_right_vars)), ~ !is.na(.x))
  ) %>%
  filter(parietal_present, orbit_present, tibia_present) %>%
  # mutate per-individual binary outcomes
  mutate(
    # PH presence: any of the PH vars != "0" (and not NA)
    PH_any = as.numeric(if_any(all_of(ph_vars), ~ !is.na(.x) & .x != "0")),
    
    # CO presence: prefer left if present, else right; presence if chosen value != "0"
    CO_choice = if_else(!is.na(.data[[co_left]]), .data[[co_left]], .data[[co_right]]),
    CO_any = as.numeric(!is.na(CO_choice) & CO_choice != "0"),
    
    # PER presence: prefer left if any left part present, else right; presence if any part >= 2
    left_exists  = if_any(all_of(per_left_vars),  ~ !is.na(.x)),
    right_exists = if_any(all_of(per_right_vars), ~ !is.na(.x)),
    left_has_path  = if_any(all_of(per_left_vars),  ~ !is.na(.x) & .x %in% c("2","3","4","5","6","7")),
    right_has_path = if_any(all_of(per_right_vars), ~ !is.na(.x) & .x %in% c("2","3","4","5","6","7")),
    PER_any = case_when(
      left_exists  ~ as.numeric(left_has_path),
      right_exists ~ as.numeric(right_has_path),
      TRUE ~ NA_real_
    )
  ) %>%
  # keep only binary columns
  dplyr::select(PH_any, CO_any, PER_any) %>%
  # drop NAs
  filter(!is.na(PH_any) & !is.na(CO_any) & !is.na(PER_any))

# Pairwise Fisher tests (PH vs CO, PH vs PER, CO vs PER)
pairs <- list(c("PH_any","CO_any"), c("PH_any","PER_any"), c("CO_any","PER_any"))

for (p in pairs) {
  a <- p[1]; b <- p[2]
  tab <- table(analysis_df[[a]], analysis_df[[b]])
  
  cat("\n-------------------------------------------\n")
  cat("Pair:", a, "vs", b, "\n\n")
  print(tab)
  
  # make 2X2 tables
  if (all(dim(tab) == c(2,2))) {
    fisher_res <- fisher.test(tab, simulate.p.value = FALSE)
    # compute phi as effect size from Pearson chi-square (no Yates)
    chisq_res <- suppressWarnings(chisq.test(tab, correct = FALSE))
    phi <- sqrt(as.numeric(chisq_res$statistic) / sum(tab))
    
    cat("\nFisher's exact test (2x2): p =", signif(fisher_res$p.value, 3), "\n")
    cat("Phi (effect size) =", round(phi, 3), "\n")
  } else {
    # if not 2x2 (e.g., a side has only 0s or only 1s), skip and inform
    cat("\nTest not applicable: contingency table is not 2x2 (dimensions = ",
        paste(dim(tab), collapse = " x "), ").\n")
    # still try fisher with simulate.p.value if possible (for non-2x2), wrapped in tryCatch
    try({
      fisher_mc <- fisher.test(tab, simulate.p.value = TRUE, B = 10000)
      cat("Fisher (MC): p =", signif(fisher_mc$p.value, 3), "\n")
    }, silent = TRUE)
  }
}
```

```{r}
# Logistic regression (per-individual DVs) coevaluating Age + Sex + Chrono ----

# define var names
ph_vars <- c("PH_PARIETAL_L_ext", "PH_PARIETAL_R_ext",
             "PH_PARIETAL_L_int", "PH_PARIETAL_R_int")

co_left  <- "Cribra Orbitalia_l"
co_right <- "Cribra Orbitalia_r"

per_left_vars  <- c("PER_TIBIA_PD_L","PER_TIBIA_MD_L","PER_TIBIA_DD_L")
per_right_vars <- c("PER_TIBIA_PD_R","PER_TIBIA_MD_R","PER_TIBIA_DD_R")

# analysis
analysis_df <- osteodata_joined %>%
  dplyr::select(all_of(ph_vars), all_of(c(co_left, co_right)),
                all_of(per_left_vars), all_of(per_right_vars),
                `Age Group`, Sex_Binary, `Σχετική Χρονολόγηση`) %>%
  mutate(
    ## in PH
    PH_available = rowSums(across(all_of(ph_vars), ~ !is.na(.x))) > 0,
    PH_any = case_when(
      PH_available ~ as.numeric(rowSums(across(all_of(ph_vars), ~ !is.na(.x) & .x != "0")) > 0),
      TRUE ~ NA_real_
    ),
    ## in CO
    CO_choice = dplyr::coalesce(.data[[co_left]], .data[[co_right]]),
    CO_available = !is.na(CO_choice),
    CO_any = case_when(
      CO_available ~ as.numeric(CO_choice != "0"),
      TRUE ~ NA_real_
    ),
    ## in PER (collapse tibia parts)
    PER_left = case_when(
      rowSums(across(all_of(per_left_vars),  ~ !is.na(.x))) == 3 ~
        as.numeric(rowSums(across(all_of(per_left_vars),  ~ .x %in% c("2","3","4","5","6","7"))) > 0),
      TRUE ~ NA_real_
    ),
    PER_right = case_when(
      rowSums(across(all_of(per_right_vars), ~ !is.na(.x))) == 3 ~
        as.numeric(rowSums(across(all_of(per_right_vars), ~ .x %in% c("2","3","4","5","6","7"))) > 0),
      TRUE ~ NA_real_
    ),
    PER_any = case_when(
      !is.na(PER_left) ~ PER_left,
      is.na(PER_left) & !is.na(PER_right) ~ PER_right,
      TRUE ~ NA_real_
    )
  ) %>%
  # mutate covariates (IVs) to factors
  mutate(
    `Age Group` = factor(`Age Group`),
    Sex_Binary = factor(Sex_Binary),
    `Σχετική Χρονολόγηση` = factor(`Σχετική Χρονολόγηση`)
  ) %>%
  dplyr::select(PH_any, CO_any, PER_any, `Age Group`, Sex_Binary, `Σχετική Χρονολόγηση`)

# Loop GLM for each DV with the other 2 DVs + IVs
dv_list <- c("PH_any", "CO_any", "PER_any")
results_tables <- list()
results_plots  <- list()

for (dv in dv_list) {
  other_dvs <- setdiff(dv_list, dv)
  
  reg_subset <- analysis_df %>%
    filter(!is.na(.data[[dv]]),
           !is.na(.data[[other_dvs[1]]]),
           !is.na(.data[[other_dvs[2]]]),
           !is.na(`Age Group`),
           !is.na(Sex_Binary),
           !is.na(`Σχετική Χρονολόγηση`))
  
  formula_str <- paste0("`", dv, "` ~ ", 
                        paste(other_dvs, collapse = " + "), 
                        " + `Age Group` + Sex_Binary + `Σχετική Χρονολόγηση`")
  
  glm_model <- glm(as.formula(formula_str), data = reg_subset, family = binomial)
  
  # table ORs
  glm_table <- tbl_regression(glm_model, exponentiate = TRUE) %>%
    modify_caption(paste0("**Logistic regression for ", dv, "**")) %>%
    modify_footnote(everything() ~ "GLM (binomial logistic regression), OR = Odds Ratio, CI = 95% CI")
  
  results_tables[[dv]] <- glm_table
  
  # predict probabilities
  pred_data <- ggeffects::ggpredict(glm_model,
                                    terms = c("Age Group", "Sex_Binary", "Σχετική Χρονολόγηση"))
  
  glm_plot <- ggplot(pred_data, aes(x = x, y = predicted, color = group)) +
    geom_point(position = position_dodge(width = 0.5)) +
    geom_errorbar(aes(ymin = conf.low, ymax = conf.high),
                  width = 0.2, position = position_dodge(width = 0.5)) +
    facet_wrap(~facet, nrow = 1) +
    scale_y_continuous(labels = scales::percent_format()) +
    labs(title = paste0("Predicted probability of ", dv),
         x = "", y = "Predicted probability", color = "Group") +
    theme(axis.text.x = element_text(angle = 30, hjust = 1))
  
  results_plots[[dv]] <- glm_plot
}

# print all tables and plots
for (dv in names(results_tables)) {
  print(results_tables[[dv]])
  print(results_plots[[dv]])
}
```

Το γράφημα MCA παρουσιάζει τους νεαρούς νεήλικου πιο κοντά στην εμφάνιση της CO. Οι μέσοι και οι ώριμοι ενήλικοι βρίσκονται μακριά από την εμφάνιση των παθολογικών ενδείξεων. Οι γυναίκες παρατηρούνται πιο κοντά στην εμφάνιση CO

```{r}
# MCA ----
# individuals w/ at least 1 parietal, 1 eye socket, 1 tibia (preferably left if both present)

# define var names
ph_vars <- c("PH_PARIETAL_L_ext","PH_PARIETAL_R_ext",
              "PH_PARIETAL_L_int","PH_PARIETAL_R_int")

co_left <- "Cribra Orbitalia_l"
co_right <- "Cribra Orbitalia_r"

per_left_vars  <- c("PER_TIBIA_PD_L","PER_TIBIA_MD_L","PER_TIBIA_DD_L")
per_right_vars <- c("PER_TIBIA_PD_R","PER_TIBIA_MD_R","PER_TIBIA_DD_R")

# Build analysis dataset with per-individual binary indicators
analysis_df <- osteodata_joined %>%
  dplyr::select(all_of(ph_vars),
                all_of(c(co_left, co_right)),
                all_of(per_left_vars), all_of(per_right_vars),`Age Group`, Sex_Binary, `Σχετική Χρονολόγηση`) %>%
  # include at least one parietal present, one orbit present, one tibia present
  mutate(
    parietal_present = if_any(all_of(ph_vars), ~ !is.na(.x)),
    orbit_present = if_any(all_of(c(co_left, co_right)), ~ !is.na(.x)),
    tibia_present = if_any(all_of(c(per_left_vars, per_right_vars)), ~ !is.na(.x))
  ) %>%
  filter(parietal_present, orbit_present, tibia_present) %>%
  # mutate per-individual binary outcomes
  mutate(
    # PH presence: any of the PH vars != "0" (and not NA)
    PH_any = as.numeric(if_any(all_of(ph_vars), ~ !is.na(.x) & .x != "0")),
    
    # CO presence: prefer left if present, else right; presence if chosen value != "0"
    CO_choice = if_else(!is.na(.data[[co_left]]), .data[[co_left]], .data[[co_right]]),
    CO_any = as.numeric(!is.na(CO_choice) & CO_choice != "0"),
    
    # PER presence: prefer left if any left part present, else right; presence if any part >= 2
    left_exists  = if_any(all_of(per_left_vars),  ~ !is.na(.x)),
    right_exists = if_any(all_of(per_right_vars), ~ !is.na(.x)),
    left_has_path  = if_any(all_of(per_left_vars),  ~ !is.na(.x) & .x %in% c("2","3","4","5","6","7")),
    right_has_path = if_any(all_of(per_right_vars), ~ !is.na(.x) & .x %in% c("2","3","4","5","6","7")),
    PER_any = case_when(
      left_exists  ~ as.numeric(left_has_path),
      right_exists ~ as.numeric(right_has_path),
      TRUE ~ NA_real_)
  )

# Subset only the binary DVs + covariates and exclude NAs
mca_subset <- analysis_df %>%
  dplyr::select(PH_any, CO_any, PER_any, `Age Group`, Sex_Binary, `Σχετική Χρονολόγηση`) %>%
  filter(!is.na(PH_any), !is.na(CO_any), !is.na(PER_any),
         !is.na(`Age Group`), !is.na(Sex_Binary), !is.na(`Σχετική Χρονολόγηση`)) %>%
  mutate(across(everything(), as.factor))

# Run MCA
res_mca <- MCA(mca_subset, graph = FALSE)

# Plot MCA
fviz_mca_biplot(res_mca,
                repel = TRUE,
                ggtheme = theme_minimal(),
                title = "MCA of PH, CO, PER and covariates")
```

H Multivariate Multiple Logistic Regression εμφανίζει

```{r}
# Tetrachoric Corr Matrix ----
# Logistic regression models for PH_any, CO_any, PER_any

# define var names
ph_vars <- c("PH_PARIETAL_L_ext","PH_PARIETAL_R_ext",
             "PH_PARIETAL_L_int","PH_PARIETAL_R_int")

co_left <- "Cribra Orbitalia_l"
co_right <- "Cribra Orbitalia_r"

per_left_vars  <- c("PER_TIBIA_PD_L","PER_TIBIA_MD_L","PER_TIBIA_DD_L")
per_right_vars <- c("PER_TIBIA_PD_R","PER_TIBIA_MD_R","PER_TIBIA_DD_R")

# Build analysis dataset with per-individual binary indicators
analysis_df <- osteodata_joined %>%
  dplyr::select(all_of(ph_vars),
                all_of(c(co_left, co_right)),
                all_of(per_left_vars), all_of(per_right_vars),
                `Age Group`, Sex_Binary, `Σχετική Χρονολόγηση`) %>%
  # require at least one parietal, orbit, tibia
  mutate(
    parietal_present = if_any(all_of(ph_vars), ~ !is.na(.x)),
    orbit_present = if_any(all_of(c(co_left, co_right)), ~ !is.na(.x)),
    tibia_present = if_any(all_of(c(per_left_vars, per_right_vars)), ~ !is.na(.x))
  ) %>%
  filter(parietal_present, orbit_present, tibia_present) %>%
  # binary outcomes
  mutate(
    PH_any = as.numeric(if_any(all_of(ph_vars), ~ !is.na(.x) & .x != "0")),
    CO_choice = if_else(!is.na(.data[[co_left]]), .data[[co_left]], .data[[co_right]]),
    CO_any = as.numeric(!is.na(CO_choice) & CO_choice != "0"),
    left_exists  = if_any(all_of(per_left_vars),  ~ !is.na(.x)),
    right_exists = if_any(all_of(per_right_vars), ~ !is.na(.x)),
    left_has_path  = if_any(all_of(per_left_vars),  ~ !is.na(.x) & .x %in% c("2","3","4","5","6","7")),
    right_has_path = if_any(all_of(per_right_vars), ~ !is.na(.x) & .x %in% c("2","3","4","5","6","7")),
    PER_any = case_when(
      left_exists  ~ as.numeric(left_has_path),
      right_exists ~ as.numeric(right_has_path),
      TRUE ~ NA_real_)
  )

# Subset complete cases for modeling
corr_subset <- analysis_df %>%
  dplyr::select(PH_any, CO_any, PER_any) %>%
  filter(!is.na(PH_any), !is.na(CO_any), !is.na(PER_any)) %>%
  mutate(across(everything(), as.numeric))

# Phi / tetrachoric correlations
tetra <- tetrachoric(corr_subset)$rho

# Plot correlation matrix
corrplot(tetra, method = "color", addCoef.col = "black",
         title = "Tetrachoric correlations between PH, CO, PER",
         mar = c(0,0,2,0))
```

##### ΕΑΑ και ΟΑ \-- Εκφυλιστική Ασθένεια των Αρθρώσεων-ΕΑΑ και ΟστεοΑρθρίτιδα-ΟΑ (Degenerative Joint Disease-DJD & Osteoarthritis-OA)OA)

Για να μειωθεί η επίδραση των τελευταίων δύο παραγόντων θα αποκλειστούν οι περιπτώσεις οστών με τραυματικούς δείκτες και θα γίνει έλεγχος της στατιστικής συσχέτισης με τις σωματικές αναλογίες των σκελετικών ατόμων. Οι πρώτοι δύο παράγοντες είναι αδύνατον να αποφευχθούν ή να μετρηθεί η συσχέτισή τους με μία επιφύλαξη για μελλοντικές μελέτες που θα συνδυάσουν παλαιογενετικούς δείκτες εμφάνισης. (Klaus et al., 2009, p.209)

###### LIPP \-- LIPPing

```{r}
# LIPP ----

## Subset LIPP_clean
lipp_subset <- LIPP_clean %>%
  dplyr::select(starts_with("LIPP_"))

## List results
results_lipp <- list()

## Loop
for (variable in names(lipp_subset)) {
  
  # Extract subset as data frame
  lipp_df <- data.frame(LIPP = lipp_subset[[variable]])
  
  # Skip empty or single-value variables
  if (length(unique(na.omit(lipp_df$LIPP))) < 2) {
    message("Δεν υπολογίζεται: ", variable, " (ανεπαρκή δεδομένα)")
    next
  }
  
  # Chi-square GoF
  lipp_counts <- table(lipp_df$LIPP, useNA = "no")
  lipp_percent <- round(100 * lipp_counts / sum(lipp_counts), 1)
  p_value_lipp <- chisq.test(lipp_counts)
  
  # Tables
  lipp_no_filter_table <- lipp_df %>%
    droplevels() %>%
    tbl_summary(
      label = list(LIPP ~ "Χειλέωση"),
      statistic = list(all_categorical() ~ "{n} ({p}%)")
    ) %>%
    modify_header(label ~ "") %>%
    modify_spanning_header(everything() ~ "") %>%
    modify_caption(paste0("**Κατανομή: ", variable, "**")) %>%
    modify_footnote(
      everything() ~ paste0(
        "Chi-square goodness-of-fit: Χ²(",
        p_value_lipp$parameter, ") = ",
        round(p_value_lipp$statistic, 2),
        ", p = ", signif(p_value_lipp$p.value, 3)
      )
    )
  
  # Save results
  results_lipp[[variable]] <- lipp_no_filter_table
  
  # Print tables
  print(lipp_no_filter_table)
}
```

###### OPH - OsteoPHytosis

```{r}
# OPH ----

## Subset OPH_clean
oph_subset <- OPH_clean %>%
  dplyr::select(starts_with("OPH_"))

## List results
results_oph <- list()

## Loop
for (variable in names(oph_subset)) {
  
  # Extract subset as data frame
  oph_df <- data.frame(OPH = oph_subset[[variable]])
  
  # Skip empty or single-value variables
  if (length(unique(na.omit(oph_df$OPH))) < 2) {
    message("Δεν υπολογίζεται: ", variable, " (ανεπαρκή δεδομένα)")
    next
  }
  
  # Chi-square GoF
  oph_counts <- table(oph_df$OPH, useNA = "no")
  oph_percent <- round(100 * oph_counts / sum(oph_counts), 1)
  p_value_oph <- chisq.test(oph_counts)
  
  # Tables
  oph_no_filter_table <- oph_df %>%
    droplevels() %>%
    tbl_summary(
      label = list(OPH ~ "Οστεόφυτα"),
      statistic = list(all_categorical() ~ "{n} ({p}%)")
    ) %>%
    modify_header(label ~ "") %>%
    modify_spanning_header(everything() ~ "") %>%
    modify_caption(paste0("**Κατανομή: ", variable, "**")) %>%
    modify_footnote(
      everything() ~ paste0(
        "Chi-square goodness-of-fit: Χ²(",
        p_value_oph$parameter, ") = ",
        round(p_value_oph$statistic, 2),
        ", p = ", signif(p_value_oph$p.value, 3)
      )
    )
  
  # Save results
  results_oph[[variable]] <- oph_no_filter_table
  
  # Print tables
  print(oph_no_filter_table)
}
```

###### POR \-- PORosity

```{r}
# POR ----

## Subset POR_clean
por_subset <- POR_clean %>%
  dplyr::select(starts_with("POR_"))

## List results
results_por <- list()

## Loop
for (variable in names(por_subset)) {
  
  # Extract subset as data frame
  por_df <- data.frame(POR = por_subset[[variable]])
  
  # Skip empty or single-value variables
  if (length(unique(na.omit(por_df$POR))) < 2) {
    message("Δεν υπολογίζεται: ", variable, " (ανεπαρκή δεδομένα)")
    next
  }
  
  # Chi-square GoF
  por_counts <- table(por_df$POR, useNA = "no")
  por_percent <- round(100 * por_counts / sum(por_counts), 1)
  p_value_por <- chisq.test(por_counts)
  
  # Tables
  por_no_filter_table <- por_df %>%
    droplevels() %>%
    tbl_summary(
      label = list(POR ~ "Πορότητα"),
      statistic = list(all_categorical() ~ "{n} ({p}%)")
    ) %>%
    modify_header(label ~ "") %>%
    modify_spanning_header(everything() ~ "") %>%
    modify_caption(paste0("**Κατανομή: ", variable, "**")) %>%
    modify_footnote(
      everything() ~ paste0(
        "Chi-square goodness-of-fit: Χ²(",
        p_value_por$parameter, ") = ",
        round(p_value_por$statistic, 2),
        ", p = ", signif(p_value_por$p.value, 3)
      )
    )
  
  # Save results
  results_por[[variable]] <- por_no_filter_table
  
  # Print tables
  print(por_no_filter_table)
}
```

###### EBU \-- EBUrnation

```{r}
# EBU ----

## Subset EBU_clean
ebu_subset <- EBU_clean %>%
  dplyr::select(starts_with("EBU_"))

## List results
results_ebu <- list()

## Loop
for (variable in names(ebu_subset)) {
  
  # Extract subset as data frame
  ebu_df <- data.frame(EBU = ebu_subset[[variable]])
  
  # Skip empty or single-value variables
  if (length(unique(na.omit(ebu_df$EBU))) < 2) {
    message("Δεν υπολογίζεται: ", variable, " (ανεπαρκή δεδομένα)")
    next
  }
  
  # Chi-square GoF
  ebu_counts <- table(ebu_df$EBU, useNA = "no")
  ebu_percent <- round(100 * ebu_counts / sum(ebu_counts), 1)
  p_value_ebu <- chisq.test(ebu_counts)
  
  # Tables
  ebu_no_filter_table <- ebu_df %>%
    droplevels() %>%
    tbl_summary(
      label = list(EBU ~ "Λείανση"),
      statistic = list(all_categorical() ~ "{n} ({p}%)")
    ) %>%
    modify_header(label ~ "") %>%
    modify_spanning_header(everything() ~ "") %>%
    modify_caption(paste0("**Κατανομή: ", variable, "**")) %>%
    modify_footnote(
      everything() ~ paste0(
        "Chi-square goodness-of-fit: Χ²(",
        p_value_ebu$parameter, ") = ",
        round(p_value_ebu$statistic, 2),
        ", p = ", signif(p_value_ebu$p.value, 3)
      )
    )
  
  # Save results
  results_ebu[[variable]] <- ebu_no_filter_table
  
  # Print tables
  print(ebu_no_filter_table)
}
```

###### ΕΑΑ -- Συνδυασμος LIPP, OPH και POR για την Σπονδυλική Στήλη.

Οι δείκτες LIPP, POR, OPH συγχωνεύτηκαν και κατηγοριοποιήθηκαν σε 4 βαθμίδες (0 = απουσία, 1 = χαμηλού βαθμού, 2 = μεσαίος βαθμός, 3 = υψηλός βαθμός) ανα οστικό σημείο.

```{r}
# DJD
## Regrade(lipp, por, oph)
calc_DJD_grade <- function(lipp, por, oph) {
  recode_value <- function(x) {
    case_when(
      is.na(x) ~ NA_real_,
      x == 0 ~ 0,
      x %in% c(11, 12, 13, 14, 21) ~ 1,
      x %in% c(22, 23, 24, 31, 32, 33) ~ 2,
      x %in% c(34, 41, 42, 43, 44) ~ 3,
      TRUE ~ NA_real_
    )
  }
  
  lipp_r <- recode_value(lipp)
  por_r  <- recode_value(por)
  
  oph_r <- case_when(
    is.na(oph) ~ NA_real_,
    oph == 0 ~ 0,
    oph == 1 ~ 1,
    oph == 2 & (pmax(lipp_r, por_r, na.rm = TRUE) < 3) ~ 1,
    oph == 2 & (pmax(lipp_r, por_r, na.rm = TRUE) >= 3) ~ 2,
    TRUE ~ NA_real_
  )
  
  # Take the max grade
  pmax(lipp_r, por_r, oph_r, na.rm = TRUE)
}

## Select vertebral sites only
vertebral_sites <- names(DJD_recode) %>%
  grep("^LIPP_(C|T|L|S)\\d", ., value = TRUE) %>%
  gsub("^LIPP_", "", .)

## Create DJD grades and tables
results_DJD <- list()

for (site in vertebral_sites) {
  lipp_col <- paste0("LIPP_", site)
  por_col  <- paste0("POR_", site)
  oph_col  <- paste0("OPH_", site)
  new_col  <- paste0("DJD_", site)
  
  # Skip missing combos
  if (!all(c(lipp_col, por_col, oph_col) %in% names(DJD_recode))) next
  
  DJD_recode[[new_col]] <- calc_DJD_grade(
    DJD_recode[[lipp_col]],
    DJD_recode[[por_col]],
    DJD_recode[[oph_col]]
  )
  
  # Data frame
  EAA_df <- data.frame(DJD = DJD_recode[[new_col]])
  
  # Skip if only NAs or single category
  if (length(unique(na.omit(EAA_df$DJD))) < 2) next
  
  # Table
  tbl_DJD <- EAA_df %>%
    tbl_summary(
      label = list(DJD ~ paste0("DJD ", site)),
      statistic = list(all_categorical() ~ "{n} ({p}%)"),
      missing = "no"
    ) %>%
    modify_caption(paste0("**Κατανομή Εκφυλιστικής Αρθριτικής Ασθένειας (DJD): ", site, "**")) %>%
    modify_header(label ~ "") %>%
    modify_spanning_header(everything() ~ "")
  
  # Save to list
  results_DJD[[site]] <- tbl_DJD
  
  # Print table
  print(tbl_DJD)
}
```

Με την ίδια μέθοδο ομαδοποιήσαμε περαιτέρω ανα περιοχή. Οι αυχενικοί...

Οι θωρακικοί...

Οι οσφυικοί...

Η αριστερή πλευρά...

Η δεξιά πλευρά...

```{r}
# DJD Vertebral Column Heatmap (Prototype using LIPP, POR, OPH integration)
# -------------------------------------------------------

library(dplyr)
library(ggplot2)
library(png)
library(grid)

# === 1. Recode function for LIPP / POR / OPH ===
recode_value <- function(x) {
  x_num <- suppressWarnings(as.numeric(as.character(x)))
  dplyr::case_when(
    is.na(x_num) ~ NA_real_,
    x_num == 0 ~ 0,
    x_num %in% c(11,12,13,14,21) ~ 1,
    x_num %in% c(22,23,24,31,32,33) ~ 2,
    x_num %in% c(34,41,42,43,44) ~ 3,
    TRUE ~ NA_real_
  )
}

# === 2. Compute composite DJD per vertebra (max of LIPP, POR, OPH) ===
vertebrae <- c(paste0("C", 1:7), paste0("T", 1:12), paste0("L", 1:5), "S1")

djd_data <- lapply(vertebrae, function(v) {
  lipp_cols <- grep(paste0("^LIPP_", v), names(osteodata_joined), value = TRUE)
  por_cols  <- grep(paste0("^POR_",  v), names(osteodata_joined), value = TRUE)
  oph_cols  <- grep(paste0("^OPH_",  v), names(osteodata_joined), value = TRUE)
  
  lipp <- if (length(lipp_cols) > 0) apply(osteodata_joined[lipp_cols], 1, function(x) max(recode_value(x), na.rm = TRUE)) else NA
  por  <- if (length(por_cols)  > 0) apply(osteodata_joined[por_cols],  1, function(x) max(recode_value(x), na.rm = TRUE)) else NA
  oph  <- if (length(oph_cols)  > 0) apply(osteodata_joined[oph_cols],  1, function(x) max(as.numeric(x), na.rm = TRUE)) else NA
  
  djd <- pmax(lipp, por, oph, na.rm = TRUE)
  data.frame(vertebra = v, DJD = djd)
}) %>% bind_rows()

# === 3. Compute median DJD grade per vertebra ===
djd_summary <- djd_data %>%
  group_by(vertebra) %>%
  summarise(
    median_grade = median(DJD, na.rm = TRUE)
  ) %>%
  mutate(
    grade_cat = cut(median_grade,
                    breaks = c(-Inf, 0.5, 1.5, 2.5, Inf),
                    labels = c("0 (absent)", "1 (low)", "2 (moderate)", "3 (high)")),
    y = rev(seq_along(vertebra))  # position top to bottom
  )

# === 4. Define color scale ===
grade_colors <- c(
  "0 (absent)"  = "#006400",  # dark green
  "1 (low)"     = "#FFD580",  # light orange
  "2 (moderate)"= "#FF8C00",  # dark orange
  "3 (high)"    = "#D7261E"   # red
)

# === 5. Load vertebral column image (placeholder: the “third graph”) ===
# Replace this path with the actual PNG/SVG path when you have it
# For now, we simulate as if "vertebral_column.png" is in the working directory.
img <- readPNG("vertebral_column.png")
background <- rasterGrob(img, width = unit(1, "npc"), height = unit(1, "npc"))

# === 6. Plot overlay ===
vertebrae_plot <- ggplot(djd_summary, aes(y = y, x = 1, fill = grade_cat)) +
  annotation_custom(background, xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf) +
  geom_tile(width = 0.6, height = 0.8, color = "black") +
  scale_fill_manual(values = grade_colors, na.value = "grey90") +
  scale_y_continuous(breaks = djd_summary$y, labels = djd_summary$vertebra) +
  theme_void() +
  theme(
    legend.position = "bottom",
    legend.title = element_blank(),
    plot.title = element_text(hjust = 0.5, size = 14)
  ) +
  ggtitle("DJD Distribution along Vertebral Column")

# === 7. Display in Quarto output ===
vertebrae_plot

# === 8. Optionally save as SVG ===
ggsave("DJD_spine_overlay.svg", vertebrae_plot, width = 7, height = 10, device = "svg")
```

Συγκρίναμε ανα ηλικία

r

Συγκρίναμε ανα φύλο

r

Συγκρίναμε ανα χρονική περίοδο

r

Θα μελετηθεί στατιστικά η συσχέτιση μεταξύ σπονδυλικής στήλης και άνω και κάτω άκρων για να διαμορφωθεί η εικόνα του υγειονομικού και εργασιακού στρες κατά ηλικιακή ομάδα και φύλο. Κατά τη στατιστική ανάλυση της σπονδυλικής στήλης γίνεται διαχωρισμός σε τέσσερεις σπονδυλικές περιοχές βάσει της βιομηχανικής και φυσιολογικής διαφοροποίησης μεταξύ των καμπύλων της σπονδυλικής στήλης. Η κινητικότητα μεταξύ των περιοχών παρουσιάζει μεγάλες διαφορές και κατά συνέπεια διαφορετικές αντιδράσεις σε εκφυλιστικές διαδικασίες(Kinkopf et al., 2021, p. 506) . Οι περιοχές ορίζονται ως εξής:

1\. Αυχενική (Α1-Α7)

2\. Ανω Θωρακική (Θ1-Θ7)

3\. Κάτω Θωρακική (Θ8-Θ12)

4\. Οσφυϊκή (Ο1-Ο5)

Οι μεταβλητές αναλύονται ως πολυώνυμες όπως ορίζεται στη μεθοδολογία καταγραφής για να επιτευχθεί λεπτομερέστερη αποτύπωση της εξέλιξης της παθολογίας και τη συσχέτισή της με άλλους παράγοντες όπως τον ηλικιακό και φυλετικό. Επίσης, αποσκοπώντας στην αύξηση της στατιστικής δύναμης θα αναλυθούν οι μεταβλητές ως διώνυμες (Kinkopf et al., 2021, p. 506).

να βρω το

\`\`\`{r}

\# FIND THE SCRIPT FOR ISOTOPE BINARY PATHOLOGY

\`\`\`

Tέλος, θα γίνει χρήση της Ανάλυσης Κύριων Συνιστωσών (Principal Component Analysis) καθώς θεωρείται η καταλληλότερη μέθοδος διερεύνησης πολυπαραγοντικών δεικτών (Calce et al., 2017, pp. 484--485).

\`\`\`{r}

\`\`\`

#### Οδοντική Παθολογία

Η μελέτη της οδοντικής παθολογίας μπορεί να συνεισφέρει πλούσιες πληροφορίες σχετικά με την παλαιοδιατροφή, την επεξεργασία τροφίμων, τη στοματική υγιεινή και τη χρήση των οδόντων ως εργαλεία(Radini & Nikita, 2023). Στην παρούσα διατριβή επιλέχθηκαν οι οδοντικές ασθένειες που αφήνουν ίχνη στο οστεοαρχαιολογικό υλικό και παρέχουν πληθώρα πληροφοριών (Scott, 1979; Smith, 1984; Buikstra & Ubelaker, 1994; Schwartz, 1995; Dobney & Ervynck, 1998; Šlaus et al., 2004; Hillson, 2005; Boldsen, 2007; Keenleyside, 2008; Klaus & Tam, 2009; Garcin et al., 2010; D'Anastasio et al., 2013; Παπαγεωργοπούλου et al., 2015c; Šlaus et al., 2018; Primeau et al., 2018; Bartholdy et al., 2019; Radini & Nikita, 2023; Caruso & Nikita, 2024)

Όσα δόντια εμφανίζουν έντονη ταφονομική φθορά ή αποτελούν ιδιαίτερες μελέτες περίπτωσεις

σε τέτοιο βαθμό που να επηρεάζουν τη καταγραφή των άλλων δεικτών (πχ calculus υψηλού βαθμού που εμποδίζει την καταγραφή τερηδονικών αλλοιώσεων) ή που να επηρεάζουν την εμφάνιση των άλλων δεικτών (πχ caries μεγάλου βαθμού δεν επιτρέπουν την καταγραφή της αποτριβής) αποκλείστηκαν από την ανάλυση (Keenleyside, 2008, p. 267). Η κωδικοποίηση των οδόντων βασίζεται στο σύστημα ονοματοδοσίας FDI της Παγκόσμιας Οδοντιατρικής Ομοσπονδίας (Leatherman, 1971).

###### Προθανάτια Απώλεια Οδόντων (AnteMortem Tooth Loss \-- AMTL)

Παρόλο που η βιβλιογραφία συστήνει τη μη συμπερίληψη της ΠΑΟ στη μελέτη της οδοντικής παθολογίας λόγω της πολυπαραγοντικής αιτιολόγησης, στην παρούσα διατριβή θεωρείται σημαντικό να συμπεριληφθεί λόγω των πληροφοριών που δύναται να παρέχει σε συνδυασμό με τις υπόλοιπες οδοντικές αλλοιώσεις. Συγκεκριμένα, λαμβάνεται υπόψη ως confounding παράγοντας της τερηδόνας και της αποτριβής. Η βαθμονόμηση ορίστηκε ως απουσία (0) και παρουσία (1) όπου παρουσία θεωρείται η απώλεια οδόντος και η πλήρης συνοστέωση του αντίστοιχου φατνίου εμφάνιση. Στις περιπτώσεις μερικής συνοστέωσης του φατνίου το δόντι καταγράφεται ως μη παρατηρήσιμο (ΝΑ) και ομοίως οι υπόλοιπες παθολογικές αλλοιώσεις που επηρεάζονται. Η παρούσα διατριβή καταγράφει μόνο τα δόντια ενηλίκων καθώς η ανήλικη οδοντοστοιχεία λόγω της αναπτυξιακής διαδικασίας δεν εμφανίζει τέτοια πάθηση (Buikstra & Ubelaker, 1994; Šlaus et al., 2004; Keenleyside, 2008; Παπαγεωργοπούλου et al., 2015c)

###### Οδοντικό Απόστημα (Dental Abscess -DA)

Οι Reitsema et al. (2022) χρησιμοποιούν την τερηδόνα, το απόστημα και την προθανάτια απώλεια οδόντος ως δείκτες που μπορούν να συνδυαστούν με ισοτοπικά δεδομένα για να μελετήσουν τη σχέση του διατροφικού προφίλ στα πλαίσια της παλαιοκινητικότητας. Στην παρούσα διατριβή θεωρήθηκε ως δείκτης υψηλής ευπάθειας καθώς για να εμφανιστεί το απόστημα απαιτείται είτε μακροχρόνια ασθένεια είτε οξύ παθολογικό επεισόδιο (Šlaus et al., 2004, 2018).

Η βαθμονόμηση ορίστηκε ως απουσία (0) και παρουσία (1) όπου παρουσία θεωρείται η εμφάνιση μη διαμπερούς οπής στη γνάθο εσωτερικά ή εξωτερικά στην περιοχή του εκάστοτε οδόντος. Η παρούσα διατριβή καταγράφει μόνο τα δόντια ενηλίκων καθώς η πάθηση σπανίζει σε ανήλικες οδοντοστοιχείες. Αν εμφανίζεται σε ανήλικη οδοντοστοιχεία, οφείλεται σε οξύ παθολογικό επεισόδιο και ως τέτοιο καταγράφεται σε ξεχωριστό πεδίο παθήσεων. (Buikstra & Ubelaker, 1994; Šlaus et al., 2004; Keenleyside, 2008; Παπαγεωργοπούλου et al., 2015c).

###### Τρυγία (Calculus)

H τρυγία ορίζεται ως το αποτέλεσμα της αποτιτάνωσης της βακτηριακής πλάκας στις επιφάνειες των δοντιών(Šlaus et al., 2018) . Παρόλο που δεν θεωρείται ως βασική παθολογία των οδόντων per se αλλά ως αποτέλεσμα άλλων διεργασιών που σχετίζονται με την οδοντική μορφολογία και μηχανική, η βιοανθρωπολογική έρευνα (Radini & Nikita, 2023; Caruso & Nikita, 2024) την χρησιμοποιεί συχνά ως proxy για κατανάλωση πρωτεϊνών στις πληθυσμιακές μελέτες.

Η βαθμονόμηση ορίστηκε ως απουσία (0), ελαφριά παρουσία σε τουλάχιστον μία επιφάνεια δοντιού (1), διακριτή παρουσία σε τουλάχιστον μία επιφάνεια δοντιού (2) και έντονη παρουσία περιμετρικά του δοντιού (3) κατόπιν τροποποίησης της μεθοδολογίας στη σχετική βιβλιογραφία (Buikstra & Ubelaker, 1994; Šlaus et al., 2004; Keenleyside, 2008; Παπαγεωργοπούλου et al., 2015c). Ως παρουσία ορίζεται η εμφάνιση απόθεσης πλάκας οργανικών και μη οργανικών στοιχείων στις οδοντικές επιφάνειες. Ιδιαίτερη προσοχή δίνεται στη διάκριση μεταξύ πραγματικής τρυγίας και αποθέσεων χώματος από το ταφικό περιβάλλον (Šlaus et al., 2018). Καταγράφηκαν ως ελαφριά παρουσία ακόμη και ίχνη τρυγίας όταν ήταν εφικτό να αναγνωριστεί πως η διαδικασία καθαρισμού εκ παραδρομής αφαίρεσε τρυγιακό υλικό από την περιοχή. Η επισφάλεια υπερεκτίμησης του δείκτη λαμβάνεται υπόψη κατά τη στατιστική ανάλυση ουτως ώστε να αμβλυνθεί το πιθανό bias που προκαλεί μία υποεκτίμηση.

###### Τερηδόνα (Caries)

Η τερηδόνα είναι μια προοδευτική παθολογική διεργασία των δοντιών που χαρακτηρίζεται από απομεταλλικοποίηση (αποασβεστοποίηση) και καταστροφή της αδαμαντίνης, της οδοντίνης και, ενίοτε, του κεγχροειδούς (cementum), ως αποτέλεσμα της δράσης οξέων που παράγονται από τον μεταβολισμό σακχάρων από στοματικά βακτήρια (Kubehl & Temple, 2020, p.376).

Η τερηδόνα καταγράφεται βάσει μεθοδολογίας (Šlaus et al., 2004; Keenleyside, 2012) όπου ορίζεται ως το νεκροτικό βοθρίο που διεισδύει στην επιφάνεια της αδαμαντίνης και της ρίζας. Για τις περιπτώσεις που η εξέταση δια γυμνού οφθαλμού δημιουργεί αμφιβολίες χρησιμοποιείται οδοντιατρικός καθετήρας (dental probe) και μεγεθυντικός φακός έως Χ10.

Η βαθμονόμηση ορίστηκε ως απουσία (0), παρουσία μικρής όπης ή μικρών οπών (1), επέκταση στην πολφική κοιλότητα (2) κατόπιν τροποποίησης της μεθοδολογίας στη σχετική βιβλιογραφία (Buikstra & Ubelaker, 1994; Šlaus et al., 2004; Keenleyside, 2008; Παπαγεωργοπούλου et al., 2015c).

###### Αποτριβή Οδόντων (Dental Wear)

Η αποτριβή οδόντων ορίζεται ως η αποδόμηση των μασητικών επιφανειών των οδόντων η οποία οφείλεται στη τριβή των οδόντων με εξωγενής ουσίες, στη διεπαφή μεταξύ των οδόντων και στην εγγενή χημική διάβρωση (Bartholdy et al., 2019, p. 623). Παρόλο που η αποτριβή δεν θεωρείται άμεσος δείκτης παλαιοδιατροφής αφού επηρεάζεται και από εξωγενείς παράγοντες, θεωρείται ως proxy για κοινωνικοοικονομικούς παράγοντες που σχετίζονται με διατροφικές συνήθειες όπως η σύσταση και η επεξεργασία τροφών (Radini & Nikita, 2023). Υπολογίζονται οι διακυμάνσεις των μέσων τιμών φθοράς στο κάθε δόντι καθώς και οι σχετικοί outliers (Bartholdy et al., 2019, pp. 629--630) με σκοπό την εξαγωγή συμπερασμάτων σε ηλικιακό και φυλετικό επίπεδο. Παρόλο που έρευνες υποστηρίζουν την μελέτη της φθοράς σε δόντια ανηλίκων (Bartholdy et al., 2019), η παρούσα διατριβή καταγράφει μόνο τα δόντια ενηλίκων καθώς κατά την προκαταρκτική εξέταση του υλικού ο ανήλικος πληθυσμός της Αμβρακίας δεν επέδειξε σημάδια εμφάνισης της αποτριβής.

Τροποποιήθηκε η περιγραφική μεθοδολογία των Scott (1979) για τους γομφίους για να ταιριάζει στην απεικονιστική μεθοδολογία των Smith (1984) για τους κοπτήρες, κυνόδοντες και προγόμφιους με περαιτέρω τροποποίηση στη χωρική καταγραφή των τιμών στους γομφίους ανα τεταρτημόριο μασητικής επιφάνειας (Beck & Smith, 2019) δημιουργώντας κατά συνέπεια 4ψήφιες τιμές για τους γομφίους. Για μονοψήφια τιμή στη στατιστική ανάλυση των γομφίων χρησιμοποιείται ο μέσος όρος των τεταρτημόριων. Το ελάχιστο απαιτούμενο για την καταγραφή είναι η απρόσκοπτη ορατότητα της μασητικής επιφάνειας (Bartholdy et al., 2019, p. 625) χωρίς της χρήση μεγεθυντικού φακού για την αποφυγή bias υπερεκτίμησης. Υπολογίζεται ο μέσος όρος της οδοντοστοιχίας του σκελετικού ατόμου στις περιπτώσεις κατά χώρα μέσω της διαίρεσης της συνολικής τιμής φθοράς των διαθέσιμων οδόντων με τον αριθμό των οδόντων (Bartholdy et al., 2019, p. 625). Προς αποφυγή bias στην παρούσα διατριβή υπολογίζονται στατιστικά μόνο όσα σκελετικά άτομα διέθεταν τουλάχιστον 8 δόντια (25% της οδοντοστοιχίας) από οποιοδήποτε τεταρτημόρια κι αν προέρχονται. Για τον βαθμό έντασης η βιβλιογραφία θεωρεί πως οι περιπτώσεις άνω της βαθμίδας 6 του Scott και της 7 του Smith θεωρούνται υψηλού βαθμού (Ragsdale & Velemínský, 2023). Στην παρούσα μελέτη θεωρείται πως περαιτέρω κατηγοριοποίηση μπορεί να οριστεί μεταξύ 4-6 του Scott και 4-7 του Smith ως μεσαίου βαθμού ενώ οι περιπτώσεις ≤4 ορίζονται ως χαμηλού βαθμού. Ο βαθμός 4 θεωρείται κατώφλι στην συγκεκριμένη κατηγοριοποίηση καθώς η βασική παράμετρος ορισμού της είναι η παρουσία ολοκληρωτικής πεπλάτυνσης της μασητικής επιφάνειας (Scott, 1979; Smith, 1984). Κατά τη στατιστική ανάλυση εκτιμάται η ερμηνευτική δυναμική των οδόντων από τα μεμονωμένα άτομα σε σχέση με την αντίστοιχη από τα μεμονωμένα δόντια. Τέλος, αναλύονται η πλευρικότητα, η πρόσθιο-οπίσθια σχέση, η διαφορά μεταξύ των 3 λειτουργικών οδοντικών ομάδων \-- πρόσθια, προγόμφιοι και γομφίοι- (Lovejoy, 1985, p. 48) και η σχέση μεταξύ των γνάθων.

Η βαθμονόμηση ορίζεται ως εξής:

1 = απουσία

2 = ελαφριά εξομάλυνση των μασητικών επιφανειών

3 = ίχνη επίπεδης επιφάνειας

4 = επίπεδη επιφάνεια με ίχνη βαθουλωμάτων στην μασητική επιφάνεια

5 = όπως προηγουμένως αλλά πλέον τα βαθουλωμάτα καταλαμβάνουν έως το 25% της μασητικής επιφάνειας

6 = βαθουλώματα στο 25-75% της μασητικής επιφάνειας

7 = Η αδαμαντίνη είναι παρούσα σε λιγότερο από το 50% της μασητικης επιφάνειας

8 = Όπως προηγουμένως αλλά πλέον η αδαμαντίνη είναι εξαιρετικά λεπτή περιμετρικά (για κοπτήρες κυνόδοντες και προγόμφιους σε αυτή τη βαθμίδα εντάσσονται και οι περιπτώσεις ολοκληρωτικής απώλειας της αδαμαντίνης)

9 = Η αδαμαντίνη διασώζεται σε μία πλευρά του δοντιού (ισχύει μόνο για την καταγραφή των γομφίων)

10 = ολοκληρωτική απώλεια αδαμαντίνης (ισχύει μόνο για την καταγραφή των γομφίων). Κατά τη στατιστική ανάλυση η κατηγορίες 9 και 10 συγχωνεύτηκαν στην κατηγορία 9 καθώς ο αριθμός 10 ως διψήφιος ήταν επισφαλής να χρησιμοποιηθεί σε 4ψήφια τιμή.

###### Γραμμική Υποπλασία Αδαμαντίνης (Linear Enamel Hypoplasia \-- LEH)

Η γραμμική υποπλασία της αδαμαντίνης αποτελεί έναν από τους πιο αξιόπιστους δείκτες φυσιολογικού στρες (Klaus & Tam, 2009; Παπαγεωργοπούλου et al., 2015c; Šlaus et al., 2018). Τα αίτια μπορούν να αναζητηθούν σε ασθένειες (Boldsen, 2007) και σε δύσκολες συνθήκες διατροφής (Goodman & Armelagos, 1988; Viva et al., 2020). Η ΓΥΑ ορίζεται ως ατέλειες στο πάχος του σμάλτου λόγω της ανεπαρκούς εναπόθεσης αδαμαντίνης που προκύπτουν από φυσιολογικές διαταράξεις (στρες) κατά τη διάρκεια της εκκριτικής φάσης της αμελογένεσης (D'Anastasio et al., 2013) στα πρώτα χρόνια της ανάπτυξης των οδόντων και ιδιαίτερα στη βρεφική και παιδική ηλικία. Συγκεκριμένα, χαρακτηρίζεται από οριζόντιες γραμμές υποπλασίας στην χειλική επιφάνεια των οδόντων (Boldsen, 2007) όπως φαίνεται στην εικόνα 1.

Η LEH επιλέχθηκε λόγω της συσχέτισής της με το συστημικό στρες σε ενδοπληθυσμιακό και διαπληθυσμιακό επίπεδο (Boldsen, 2007, p.59) και κατ'επέκταση με δύσκολες συνθήκες διαβίωσης όπως περιόδους εχθροπραξιών (Goodman & Armelagos, 1988, p.936; Viva et al., 2020, p.315). Σε ενδοπληθυσμιακό επίπεδο μπορεί να αποτελεί έναν αξιόλογο δείκτη της εξέλιξης του προφίλ υγείας ενός πληθυσμού καθώς η αδυναμία ανάπλασης των οδόντων και η δαχτυλιοειδής μορφή ανάπτυξης των οδόντων επιτρέπει την χρονολογική διάκριση των στρεσσογόνων περιόδων (Goodman & Armelagos, 1988, p. 936). Επιπλέον, οι Goodman & Armelagos (1988, p. 942) θεωρούν πως επηρεάζεται μεν γενετικά αλλά μεγαλύτερη επίδραση έχουν οι κοινωνικοί (χαμηλότερο status) και διατροφικοί (ελλιπής σίτιση) παράγοντες στρες.

Επιλέχθηκε να μετρηθεί μόνο ο κυνόδοντας σε όλα τα τεταρτημόρια καθώς είναι πιο ευαίσθητος στους στρεσογόνους παράγοντες από τα υπόλοιπα δόντια και έχει μεγάλη αναπτυξιακή περίοδο από τους 4 μήνες έως 6 χρόνια (Šlaus et al., 2004, p.244; Primeau et al., 2018, p.5) Επιλέχθηκε η καταγραφή των κυνόδοντων σε όλα τα τεταρτημόρια (FDI = 13, 23, 33, 43) καθώς η συστημική υποπλασία διακρίνεται από τις κληρονομικές και τραυματικές υποπλασίες μέσω της παρουσίας της σε παραπάνω από ένα δόντι (Goodman & Armelagos, 1988, p. 936). Aποκλείστηκαν τα υπόλοιπα δόντια -όπως και οι κοπτήρες που θεωρούνται εξίσου ευαίσθητοι- καθώς θα καθιστούσε τα δεδομένα πιο επιρρεπή σε bias λόγω των διαφορών στο βαθμό διατήρησης και της προθάνάτιας απώλειας οδόντων (Boldsen, 2007, p.60, 65; Primeau et al., 2018, p.5). Οι κυνόδοντες εμφανίζουν καλύτερη κατάσταση διατήρησης λόγω μικρότερης φθοράς-αποτριβής σπανιότερης εμφάνισης τερηδονικών αλλοιώσεων. Ένας ακόμα παράγοντας που τους καθιστά ιδανικούς είναι η καθυστερημένη προθανάτια απώλεια που εμφανίζουν έναντι των άλλων οδόντων.

Για την μέθοδο παρατήρησης χρησιμοποιήθηκε η μέθοδος των Dobney & Ervynck (1998, p. 265) όπου με πλάγιο φωτισμό εντοπίζονται οι υποπλαστικές γραμμές. Για τη βαθμονόμηση χρησιμοποιήθηκε η μεθοδολογία όπου καταγράφεται ως οστεομετρική μεταβλητή μέσω της μέτρησης της απόστασης σε χιλιοστά από την CEJ (cervico-enamel joint) όλων των γραμμών υποπλασίας που καλύπτουν τουλάχιστον τα ¾ της παρειακής επιφάνειας του δοντιού χωρίς περαιτέρω καταγραφή της μορφολογίας με σκοπό να δοθεί βαρύτητα στην ανάλυση της εξέλιξης της πάθησης (Dobney & Ervynck, 1998;Boldsen, 2007; Keenleyside, 2008; Garcin et al., 2010; Primeau et al., 2018). Δεν μετρήθηκαν όσες περιπτώσεις ήταν δύσκολο να εντοπιστεί η CEJ λόγω αφύσικης φθοράς, κακής διατήρησης, ασυνήθιστης μορφολογίας και confounding αλλοιώσεων (Dobney & Ervynck, 1998, p.269).

#### Οστεομετρικές ενδείξεις

Οι οστεομετρικοί ενδείξεις παρουσιάζουν παρουσιάζουν μικρό εύρος τιμών χωρίς outliers.

```{r}
# ---- Descriptive summary table ----
# Select only numeric columns for summary
metrics_postcra_vars <- Metrics_postcra_clean %>%
  dplyr::select(-c(1))

# Create descriptive statistics table
osteometry_postcra_tbl <- metrics_postcra_vars %>%
  tbl_summary(
    statistic = all_continuous() ~ "{mean} ± {sd} ({min}–{max})",
    digits = all_continuous() ~ 2,
    missing_text = "Missing"
  ) %>%
  modify_header(label ~ "**Οστεομέτρηση**") %>%
  modify_caption("**Περιγραφική Στατιστική Οστεομετρήσεων**")

osteometry_postcra_tbl

# Violin
# Pivot
osteometry_postcra_pivot <- metrics_postcra_vars %>%
  pivot_longer(
    cols = everything(),
    names_to = "Variable",
    values_to = "Value"
  )%>%
  mutate(
    Side = case_when(
      str_detect(Variable, "_l$") ~ "Left",
      str_detect(Variable, "_r$") ~ "Right",
      TRUE ~ "Midline"
    ),
    # Remove side suffix
    BaseVar = str_remove(Variable, "_[lr]$")
  )

# Unique vars ----
base_vars <- unique(osteometry_postcra_pivot$BaseVar)

# Loop through base variables and plot ----
for (b in base_vars) {
  
  subset_data <- osteometry_postcra_pivot %>% 
    filter(BaseVar == b)

# Violin + jittered points (no grouping yet)
print(
  ggplot(subset_data, aes(x = fct_reorder(Variable, Value, .fun = median, .desc = TRUE), y = Value)) +
  geom_violin(fill = "lightblue", alpha = 0.5, trim = FALSE, na.rm = TRUE) +
  geom_jitter(width = 0.1, alpha = 0.7, size = 1.5, color = "darkblue") +
  labs(
    title = paste("Κατανομή", str_to_title(b)),
    x = "Πλευρά",
    y = "Τιμές (χιλιοστά)"
  ) +
  theme_minimal(base_size = 12) +
  theme(
    axis.text.x = element_text(angle = 60, hjust = 1),
    plot.title = element_text(face = "bold"),
    legend.position = "none"
  ) +
  scale_fill_brewer(palette = "Set2")
)
}
```

Οι οστεομετρήσεις χρησιμοποιούνται παράλληλα και για τη διερεύνηση συσχετίσεων με παλαιοπαθολογικούς δείκτες στους σπονδύλους, στο βραχιόνιο, στην ωλένη, στο μηριαίο και στην κνήμη.

##### Ασυμμετρία

Εφαρμόζονται μεθοδολογίες που σχετίζονται με την ασυμμετρία των αμφίπλευρων οστών.

Ο (Wilczak, 1998) ορίζει το κατώφλι ορισμού ασυμμετρίας στις οστεομετρήσεις μήκους μεταξύ των ζευγαριών οστών στο 1mm. Στο ίδιο άρθρο υπολογίζει την ασυμμετρία στο μέγεθος των ενθέσεων ορίζοντας το κατώγφλι ασυμμετρίας στο 3% μεταξύ των εμβαδών των ενθέσεων καθώς αποτελεί τον μέσο όρο μεταξύ των εμβαδών συν 1 SD (Wilczak, 1998, p. 316). Στην παρούσα μελέτη υπολογίζεται το αντίστοιχο ποσοστό και εφαρμόζεται σε όλα τα οστά για τον έλεγχο της ασυμμετρίας των οστεομετρήσεων μεταξύ των αμφίπλευρων οστών. Βασική εξίσωση υπολογισμού της πλευρικότητας (Peterson, 1998, p. 386) είναι η εξής

\\\[(mean left score) / (mean right score)\\\]×100

Περαιτέρω διερεύνηση της πλευρικότητας ακολουθεί τη μεθοδολογία Κυμαινόμενη Ασυμμετρία- ΚυΑ (Fluctuating Asymmetry-FA) των O'Donnell & Moes (2021, p.157--158) αφου προσαρμοστεί στις μετρήσεις μετακρανιακών οστών βάσει των οδόντων που αφορούσε το άρθρο. Η ΚυΑ μαζί με την αντισυμμετρία και την κατευθυντική ασυμμετρία αποτελούν τους τρεις τύπους συμμετρίας. Η αντισυμμετρία αφορά τις περιπτώσεις όπου ένα χαρακτηριστικό εμφανίζει κορυφώσεις στις δύο πλευρές εκατέρωθεν της αμφιπλευρικής εμφάνισής του. Η κατευθυντική ασυμμετρία αφορά ένα χαρακτηριστικό το οποίο εμφανίζεται μεγαλύτερο σε μία πλευρά με συνέπεια σε όλο τον υπο εξέταση πληθυσμό. Η κυμαινόμενη ασυμμετρία αφορά τις περιπτώσεις όπου ένα χαρακτηριστικό εμφανίζει τυχαία απόκλιση από την τέλεια συμμετρία.

Παρόλο που θεωρείται πως η οδοντική FA (DFA) είναι λιγότερη επηρεασμένη από τους περιβαλλοντικούς παράγοντες σε σχέση με το μετακρανιακό σκελετό και προτιμάται έναντι της μετακρανιακής FA (skeletal FA), στο ίδιο άρθρο υποστηρίζεται η χρήση κρανιακης FA (facial FA) σε μελλοντικές μελέτες (O'Donnell & Moes, 2021, pp. 167--168). Στην παρούσα μελέτη θα εφαρμοστεί η μεθοδολογία για οδοντική FA (DFA) λόγω της συσχέτισης με δείκτες ευπάθειας (PH, CO, LEH) και θα δοκιμαστεί η μετακρανιακή FA (SFA) για να ελεγχθεί η υπόθεση οτι παρουσιάζει μεγαλύτερες τιμές συγκριτικά με την DFA (O'Donnell & Moes, 2021, p. 167). Ενώ υπάρχουν διάφοροι δείκτες υπολογισμού της ΚυΑ, στην παρούσα μελέτη υπολογίζεται ως η απόλυτη τιμή της διαφοράς αριστερού μείον δεξιού χαρακτηριστικού.

Η ΚυΑ θεωρείται πως αποτυπώνει την Αναπτυξιακή Αστάθεια-ΑΑ (Developmental Instability-DI) η οποία σχετίζεται με χαμηλό βάρος γέννησης οργανικές ανωμαλίες και υψηλότερο ρίσκο ευπάθειας σε μολυσματικές και παρασιτικές ασθένειες. Υψηλότερη ΚυΑ καταδεικνύει την αδυναμία του οργανισμού να ανταποκριθεί πιέσεις φυσιολογικού στρες (O'Donnell & Moes, 2021, p. 157).

Ιδιαίτερη προσοχή δίνεται στο φαινόμενο του Οστεολογικού Παράδοξου (Wood et al., 1992) καθώς στη περίπτωση της ΚυΑ πρέπει να λαμβάνεται υπόψη κατά την ανάλυση (O'Donnell & Moes, 2021, pp. 157--158). Η ΚυΑ είναι απροσδιόριστος δείκτης στρες και πρέπει να λαμβάνεται υπόψη με προσοχή. Οι σκελετοί από τα αρχαιολογικά πληθυσμούς θεωρούνται μη-επιζώντες (non survivors) που υπόκειντο σε διαφορετικούς παράγοντες ευπάθειας, και ρίσκα νοσηρότητας και θνησιμότητας. Η εμφάνιση παθολογικών αλλοιώσεων σε ένα σκελετικό άτομοα δεν σημαίνει αυτόματα πως αυτό το άτομο δεν ήταν υγιές εν ζωή. Στις περισσότερες περιπτώσεις αυτό το άτομο πρέπει να θεωρείται πως είχε ισχυρότερο ανοσοποιητικό σύστημα ή έχαιρε μεγαλύτερης ιατροφαρμακευτικής φροντίδας. Όπως η απουσία αλλοιώσεων έτσι και η αυξημένη ΚυΑ πιθανόν να καταδεικνύει ανεπαρκής ανοσοποιητική αντίδραση.

Οι O'Donnell & Moes (2021, p. 158) δημιούργησαν 4 Υποθέσεις για να μελετήσουν την πληθυσμιακή υγεία μέσω της FA. Οι ίδιοι τις ονομάζουν προβλέψεις αλλά στις παρενθέσεις χρησιμοποιούν το σύμβολο H που στη στατιστική χρησιμοποιείται κατά κόρον για τον όρο της Υπόθεσης (Hypothesis). Παρακάτω αναφέρονται οι εν λόγω υποθέσεις:

1\. (H1) άτομα με ενεργές αλλοιώσεις εμφανίζουν μεγαλύτερη DFA

2\. (H2) άτομα χωρίς αλλοιώσεις εμφανίζουν μεγαλύτερη DFA από άτομα με επουλωμένες αλλοιώσεις

3\. (H3) Η DFA δεν παρουσιάζει στατιστικά σημαντική συσχέτιση με τη ΓΥΑ αφού η τελευταία οφείλεται σε συστημικό στρες ενώ η πρώτη σε φυσιολογικό στρες.

4\. (H4) Η DFA είναι ανεξάρτητος παράγοντας πρόβλεψης των κινδύνων θνησιμότητας

Η εξίσωση της DFA παρατίθεται εδώ:

(O'Donnell & Moes, 2021, p.160,162)

Το πρωτόκολλο στατιστικής ανάλυσης της DFA παρατίθεται εδώ:

Ελέγχουμε αρχικά την παρουσία αντισυμμετρίας και κατευθυνόμενης ασυμμετρίας. και προχωρούμε στα επόμενα βήματα αν δεν εμφανίζεται καμία από τις δύο. Δεν αποκλείσαμε κανένα χαρακτηριστικό καθώς ο έλεγχος των (O'Donnell & Moes, 2021, p.162) δεν κατέδειξε διαφορές στην περίπτωση αποκλεισμού διμορφικών και εξαρτώμενων από το σχήμα χαρακτηριστικών. Παρόλο που οι ερευνητές προτείνουν τον περαιτέρω αποκλεισμό μετρήσεων που εμφάνισαν μεγάλο σφάλμα μεταξύ των παρατηρήσεων του ίδιου παρατηρητή (intraobserver error), στην παρούσα μελέτη δεν εφαρμόστηκε λόγω έλλειψης χρονικού περιθωρίου. Για να επιλυθεί το πρόβλημα της περιορισμένης παρουσίας αμφίπλευρων οδόντων στα βιοαρχαιολογικά δείγματα οι ερευνητές περιέλαβαν ακόμα και τις μεμονωμένες περιπτώσεις ζευγαρωτών οδόντων με την προϋπόθεση οτι δεν εμφάνιζαν υψηλή Τυπική Απόκλιση-ΤΑ (Standard Deviation-SD). Οι μετρήσεις των νεογιλών υπολογίζονται ως DFA1, των μονίμων ως DFA2 και η σύνθεση όλων των νεογιλών και μονίμων ως DFA3. Οι τιμές κανονικοποιούνται βάσει τιμές z (Milne et al., 2003) για τη διευκόλυνση της ερμηνείας. Τέλος εξετάζουμε κατά πόσο η αυξημένη DFA μεταξύ DFA2 and DFA1 διαφέρει από το DFA3 και κατά πόσο η αυξημένη DFA των νεογιλών αντιστοιχεί σε αυξημένη DFA των μονίμων -και αντίστροφα- εντός του δείγματος DFA3 (O'Donnell & Moes, 2021, p.162,164).

##### Δείκτες Ευρωστίας (Tihanyi et al 2020)

###### Index of robusticity, I1 =\[100× (least circumference of the shaft (M7)/maximum length (M1))\]

###### Diaphysis cross-sectional index, I2 = \[100× (minimum diameter of the shaft (M6)/maximum diameter of the shaft (M5))\]

###### Head cross-sectional index, I3 = \[100× (transverse diameter of the head(M9a)/longitudinal diameter of the head(M10a))\]

###### Trochlea-epicondyle index, I4 = \[100× (medio-lateral breadth of the trochlea(M11)/breadth of the distal epiphysis(M4))\]

##### Φυλετικός Καταμερισμός Εργασίας και Καταπόνηση Άκρων Διαχρονικά

Οι γεωμετρικοί δείκτες εγκάρσιας διατομής των μακρών οστών κατδεικνύουν διαφορετική συμπεριφορά μεταξύ των φύλων. Επιπλέον, παρατηρείται διαφοροποίηση στην καταπόνηση των άκρων διαμέσου των αιώνων.

Όσον αφρορά τον φυλετικό καταμερισμό εργασίας η σχετική μέγιστη δύναμη κάμψης στη διατομή βραχιονίου παρουσιάζει υψηλότερες τιμές <!--# Η τιμή είναι πάντα μεγαλύτερη ή ίση του 1 χωρίς να σχετίζεται με την κατεύθυνση των εξωτερικών δυνάμεων πίεσης. --> στις γυναίκες (αριστερό βραχιόνιο: 1.25 και δεξί βραχιόνιο: 1.26) από ότι στους άνδρες(και οι δύο πλευρές: 1.20). H δύναμη κάμψης του οβελιαίου άξονα αναφορικά με τον στεφανιαίο άξονα του μηριαίου παρουσιάζει ίδιες τιμές <!--#  Η τιμή 1 καταδεικνύει παρόμοια κατανομή δύναμης κάμψης ενώ μεγαλύτερες ή μικρότερες του 1 καταδεικνύουν μεγαλύτερη δύναμη κάμψης στο οβελιαίο ή στεφανιαίο επίπεδο αντίστοιχα. --> μεταξύ των φύλων. Οι γυναίκες παρουσιάζουν στο αριστερό μηριαίο 0,99 και στο δεξί 1,01 και οι αντίστοιχες στιμές στους άνδρες είναι 1,01 και 1,05.

Όσον αφορά την καταπόνηση σε διαχρονικό επίπεδο, οι δύο δείκτες παρουσιάζουν ίδιες τιμές

```{r}
# ---- Osteometry Ratios: Separate Stratifications ----

# STEP 1: Compute ratios
osteodata_ratios <- osteodata_joined %>%
  mutate(
    # Humerus ratios
    Humerus_ratio_L = `H5_Humerus_maximum_diameter_of_midshaft_l` / `H6_Humerus_minimum_diameter_of_midshaft_l`,
    Humerus_ratio_R = `H5_Humerus_maximum_diameter_of_midshaft_r` / `H6_Humerus_minimum_diameter_of_midshaft_r`,
    
    # Femur ratios
    Femur_ratio_L = `F6_Femur_sagittal_diameter_of_midshaft_l` / `F7_Femur_transverse_diameter_of_midshaft_l`,
    Femur_ratio_R = `F6_Femur_sagittal_diameter_of_midshaft_r` / `F7_Femur_transverse_diameter_of_midshaft_r`
  )

# STEP 2: Summary table stratified by Sex_Binary
ratio_summary_sex <- osteodata_ratios %>%
  dplyr::select(Sex_Binary,
                Humerus_ratio_L, Humerus_ratio_R,
                Femur_ratio_L, Femur_ratio_R) %>%
  tbl_summary(
    by = Sex_Binary,
    statistic = all_continuous() ~ "{mean} ({sd})",
    digits = all_continuous() ~ 2,
    label = list(
      Humerus_ratio_L ~ "Humerus Ratio (Left) Imax/Imin",
      Humerus_ratio_R ~ "Humerus Ratio (Right) Imax/Imin",
      Femur_ratio_L ~ "Femur Ratio (Left) Ix/Iy",
      Femur_ratio_R ~ "Femur Ratio (Right) Ix/Iy"
    )
  ) %>%
  add_overall() %>%
  add_p(test = everything() ~ "t.test") %>%
  bold_labels()

ratio_summary_sex

# STEP 3: Summary table stratified by Σχετική Χρονολόγηση
ratio_summary_chrono <- osteodata_ratios %>%
  dplyr::select(`Σχετική Χρονολόγηση`,
                Humerus_ratio_L, Humerus_ratio_R,
                Femur_ratio_L, Femur_ratio_R) %>%
  tbl_summary(
    by = `Σχετική Χρονολόγηση`,
    statistic = all_continuous() ~ "{mean} ({sd})",
    digits = all_continuous() ~ 2,
    label = list(
      Humerus_ratio_L ~ "Humerus Ratio (Left) Imax/Imin",
      Humerus_ratio_R ~ "Humerus Ratio (Right) Imax/Imin",
      Femur_ratio_L ~ "Femur Ratio (Left) Ix/Iy",
      Femur_ratio_R ~ "Femur Ratio (Right) Ix/Iy"
    )
  ) %>%
  add_overall() %>%
  add_p(test = everything() ~ "t.test") %>%
  bold_labels()

ratio_summary_chrono
```

##### Ύψος

Ο υπολογισμός του ύψους αποτελεί μία από τις βασικότερες παραμέτρους στην βιοανθρωπολογική ανάλυση και για αυτό εμφανίστηκε στη βιβλιογραφία πολύ νωρίς (Pearson, 1899; Martin, 1914). Το βασικό πρόβλημα κατά τον υπολογισμό του ύψους έγκειται στη χρήση του σωστού πληθυσμού αναφοράς. Στην παρούσα διατριβή εφαρμόζεται η μέθοδος OLS (Koukli et al., 2023) όπως προσαρμόστηκε στο πλαίσιο της τεχνικής Fully (Raxter et al., 2006; Raxter & Ruff, 2018, p. 107) για αρχαίους πληθυσμούς του Ελλαδικού χώρου. Οι εξισώσεις παρατίθενται στoν πίνακα ?? του παραρτήματος Β

##### Μάζα Σώματος (Βάρος), Δείκτης Μάζας Σώματος-ΔΜΣ (Body Mass index-BMI) και Σωματικές Αναλογίες (Body Proportion Indices)

Το βάρος, ο ΔΜΣ (Siegmund & Papageorgopoulou, 2011) και η επίδραση των Σωματικών αναλογιών (Koukli et al., 2023) αποτελούν σημαντικές παραμέτρους κατά την ανάλυση της αναπτυξιακής εξέλιξης ενός βιοαρχαιολογικού πληθυσμού. Για τον υπολογισμό του βάρους εφαρμόζεται η πρόταση των Siegmund & Papageorgopoulou (2011) για συνυπολογισμό των αριθμητικών μέσων μεταξύ τριών μεθόδων όπου είναι εφικτό. Από το ίδιο άρθρο εφαρμόζεται η εξίσωση υπολογισμού του ΔΜΣ. Για τον υπολογισμό Σωματικών Αναλογιών υπολογίστηκαν τρεις δείκτες (Koukli et al., 2023). Το Σχετικό Μήκος Κάτω Άκρου υπολογίζει την αναλογία των κάτω άκρων προς το ύψος, ο Μηριαιοσφυικός Δείκτης την αναλογία μηριαίου προς το ύψος της οσφυϊκής μοίρας και ο Κνημιαίος Δείκτης την αναλογία κνήμης προς μηριαίο.

Στατιστική μεθοδολογία

Η στατιστική ανάλυση του υλικού έγινε με τη γλώσσα προγραμματισμού R {λόγοι από προήγουμενες μελέτες} Επιπλέον, έχει αρχίσει να συστηματικοποιείται η χρήση της σε βιοαρχαιολογικές μελέτες με διάφορα εγχειρίδια να έχουν εκδοθεί (Nikita et al., 2013; Baxter & Cool, 2016; Carlson, 2017; Nikita, 2020).

Οι κώδικες στατιστικής ανάλυσης προγραμματίστηκαν στο Rstudio (RStudio Team, 2020) το οποίο κρίθηκε ως το πιο φιλικό και πλήρες Ολοκληρωμένο Περιβάλλον Ανάπτυξης (Integrated Development Environment-IDE) κατόπιν δοκιμών με άλλα Γραφικά Περιβάλλοντα Χρήστη (Graphical User Interface-GUI) και IDE (Fox et al., 2003; RStudio Team, 2020; Friedrichsmeier & RKWard Team, 2022; "Microsoft R Open," 2022; The jamovi project, 2025). Τα πακέτα προγραμματισμού που χρησιμοποιούνται παρατίθενται στα scripts στο παράρτημα Γ. Για το συντακτικό της R ακολουθήθηκαν οι οδηγίες των Umit (2021). Για την εισαγωγή των δεδομένων ακολουθείται η διαδικασία όπως περιγράφεται από τη (Nikita, 2020, pp. 17--22).

Η στατιστική ανάλυση θεωρείται ορθή εφόσον πληρεί τις εξής προϋποθέσεις (Nikita, 2020, p. 3):

1\. σχετικότητα των δεδομένων με το υπο εξέταση ερώτημα

2\. αντιπροσωπευτικότητα των δειγμάτων

3\. εφαρμογή των κατάλληλων τύπων στατιστικής ανάλυσης

4\. σαφής ερμηνεία των αποτελεσμάτων βάσει των μαθηματικών αρχών της ανάλυσης και του πλαισίου από όπου προέρχονται τα δεδομένα.

Κατά την στατιστική ανάλυση συγχωνεύτηκε το οστεολογικό υλικό των δύο νεκροταφείων λόγω της χωρικής και χρονικής συμφωνίας με σκοπό την αύξηση του δείγματος και της στατιστικής δύναμης. Ξεχωριστή περιγραφική στατιστική εκπονείται στο προαποικιακό υλικό καθώς απέχει χωρικά και χρονικά από τον πληθυσμό της Αμβρακίας (Rathmann et al., 2017, p. 456).

Στο παράρτημα Β περιγράφονται οι στατιστικές ιδιότητες και η βαθμονόμηση των μεταβλητών ανα πεδίο. Όπου κρίνεται απαραίτητο εκτελείται subsetting για να ξεχωρίσουμε ομάδες περιπτώσεων βάσει συγκεκριμένων χαρακτηριστικών/δεδομένων. Για την αντιμετώπιση των ελλιπών παρατηρήσεων (NAs) χρησιμοποιείται η μέθοδος list-wise deletion (Kinkopf et al., 2021, p. 506).

Μέσοι όροι και διακυμάνσεις των τιμών της οστεομετρίας υπολογίζονται στο σύνολο και ανά φύλο. Οι συχνότητες οδοντικών παθολογιών, οστεοαρθριτικών αλλοιώσεων, οδοντικών παθολογικών αλλοιώσεων εκτιμώνται στο σύνολο, και ανά ηλικία και φύλο. Τέλος εκτιμάται η εξέλιξη των τιμών βάσει των χρονολογικών περιόδων σε όσες περιπτώσεις είναι εφικτή η χρονολόγηση. Εφαρμόζονται στατιστικά τέστ για να ελεγχθούν οι συσχετίσεις μεταξύ των παραμέτρων και οι διαφορές μεταξύ των ομάδων (ηλικιακές και φυλετικές διαφορές).

Κατά την περιγραφική στατιστική των παλαιοπαθολογικών δεδομένων οι μεταβλητές αναλύονται βάσει του Αληθούς Ρυθμού Επιπολασμού (Garcia-Putnam et al., 2021, p. 3) καθώς ανταποκρίνεται καλύτερα στις χρόνιες ή/και μη αναστρέψιμες ασθένειες όπως της παρούσας διατριβής.

Κατά την περιγραφική στατιστική των οστεομετρικών δεδομένων δημιουργούνται πίνακες και γραφήματα που περιέχουν τα εξής σύμφωνα με τις μεταβλητές και τα πεδία μελέτης (Hartnett, 2010, p. 1145; Nikita, 2020):

1\. μετρήσεις κεντρικής τάσης

2\. οι μέσοι όροι (trimmed and untrimmed)

3\. weighted means (Sokal & Rohlf,2009:30)

4\. οι διάμεσοι

5\. οι modes (αν οι κατανομές είναι unimodal, bimodal ή multimodal)

6\. μετρήσεις διασποράς

7\. ποικιλία (variance=s.d.2)

8\. απόκλιση (s.d.)

9\. διάστημα (range)

10\. διάστημα τεταρτημόριων (Q3-Q1))

11\. μετρήσεις σχήματος

12\. skewness

13\. kurtosis

14\. Συχνότητες

15\. συχνότητα

16\. σχετική συχνότητα

17\. ποσοστιαία συχνότητα

Σε όλα τα πεδία δημιουργούνται ραβδογράμματα (bar charts), ιστογράμματα (histograms) και θηκογράμματα (boxplots) όπως ορίζει η βιβλιογραφία (Nikita, 2020).

Ανάλυση Παλινδρόμησης (Regression Analysis)

Δημιουργούνται εξισώσεις πρόβλεψης (αναδρομή) για φυλετικό προσδιορισμό (Beck & Smith, 2019, p. 833). Δημιουργούνται regression equations βάσει των φυλετικά προσδιορισμένων ατόμων και οστεομετρήσεων. Καθώς οι οστεομετρήσεις είναι διαθέσιμες στη πλειονότητα των σκελετικών ατόμων επιτυγχάνεται να προσδιοριστούν τα άτομα με ανεπαρκείς φυλετικούς δείκτες.

Τεστ Σημαντικότητας

Για την στατιστική σημαντικότητα χρησιμοποιούνται τα εξής τέστ (Nikita et al., 2013; Baxter & Cool, 2016; Carlson, 2017; Nikita, 2020):

1\. Pearson Chi-Squared test of independence. Εφαρμόζεται σε δύο κατηγορικές παραμέτρους και εξετάζει δύο υποθέσεις (H0=οι παράμετροι είναι ανεξάρτητες μεταξύ τους, H1=οι παράμετροι βασίζονται η μία στην άλλη). Παρόλο που θεωρείται ανεπαρκές τέστ λόγω της αδυναμίας να ελέγξει την επίδραση άλλων παραμέτρων στη σχέση μεταξύ δύο μεταβλητών (Nikita et al., 2013, p. 105), στην παρούσα διατριβή χρησιμοποιείται ως επικουρικό στo τεστ GLM όπως περιγράφεται παρακάτω.

2\. Fisher's exact test. Ίδια εφαρμογή με το Pearson Chi-Squared χωρίς όμως την προυπόθεση η προσδωκόμενη συχνότητα να είναι μεγαλύτερη ή ίση του πέντε (≥5) και το δείγμα να είναι μεγάλο (Nikita et al., 2013, p. 105). Ομοίως χρησιμοποιείται ως επικουρικό στο τεστ GLM.

3\. Wald statistic. Εφαρμόζεται στο μοντέλο Εξίσωσης Γενικευμένης Εκτίμησης για να ελέγξει τη Μηδενική Υπόθεση όπου οι ομάδες εμφανίζουν παρόμοιες συχνότητες οδοντικών αλλοιώσεων. Παρόλο που δεν θεωρείται τόσο ακριβές όσο το Likelihood Ratio Test είναι επαρκές για τις ανάγκες μελέτης βιοαρχαιολογικών πληθυσμών ενώ η απλότητα της εφαρμογής του θεωρείται ένα ακόμα πλεονέκτημα (Gagnon & Wiesen, 2013, p. 562)

Κατά την ερμηνεία του p value λαμβάνουμε υπόψη διάφορα αξιώματα όπως αναλύονται στη βιβλιογραφία (Valeggia & Fernández-Duque, 2022). Αρχικά, δεν πρέπει να στηρίζουμε τα συμπεράσματα για μία σχέση μεταβλητών ή ένα φαινόμενο μόνο και μόνο επειδή ήταν στατιστικά αξιόλογο. Δεν πρέπει να θεωρούμε οτι μία τέτοια σχέση ή φαινόμενο εμφανίζεται επειδή είναι στατιστικά αξιόλογο ούτε και το αντίστροφο. Δεν πρέπει να θεωρούμε οτι η τιμή p δίνει την πιθανότητα οτι η τυχαιότητα από μόνη της προκάλεσε την σχέση ή το φαινόμενο ή την πιθανότητα οτι το τεστ υπόθεσης είναι αληθές. Τέλος, δεν πρέπει να εξάγουμε συμπερασματα λόγω στατιστικής σημαντικότητας ή ελλειψης αυτής.

Τεστ Κανονικότητας

Κατά την ανάλυση των οστεομετρικών δεδομένων διεξάγονται τεστ κανονικότητας για να ελεγχθεί η κανονικότητα της κατανομής των δεδομένων. Σε περίπτωση κανονικής κατανομής κι όταν δεν υπάρχουν outliers δίνουμε βαρύτητα στους μέσους όρους και τα confidence intervals θεωρούνται ακριβή. Σε περίπτωση μη κανονικής κατανομής οι διάμεσοι και τα IQR είναι πιο αξιόπιστα. Εναλλακτικά μπορούμε εφαρμόσουμε bootstrapping υπολογίζοντας πολλαπλά τυχαία δείγματα από το αρχικό δείγμα για να βελτιώσουμε τα CIs. Για τεστ κανονικότητας εφαρμόζεται το Shapiro-Wilk test και outlier test ελέγχουμε τα θηκογράμματα

Κατά την ανάλυση των παλαιοδημογραφικών και παλαιοπαθολογικών δεδομένων δεν είναι απαραίτητη η εφαρμογή τεστ κανονικότητας λόγω της κατηγορικής φύσης των παραμέτρων.

Έλεγχος t

Ελέγχουμε το μέσο όρο ανα οστό μέταξύ των φύλων για να διαπιστώσουμε διαφοροποίησεις. Εφαρμόζεται two sample t-student test σε περίπτωση που το Shapiro-Wilk test καταδεικνύει κανονικότητα και παρατηρείται ομοιόγένεια διασποράς. Για την ομοιογένεια διασποράς εφαρμόζεται F-test καθώς το δείγμα αφορά δύο ομάδες (άρρεν και θήλυ). Αν δεν πληρούνται οι προϋποθέσεις, εφαρμόζεται Wilcoxon rank-sum test.

Επιπλέον, ελέγχουμε το μέσο όρο ύψους του πληθυσμού της Αμβρακίας με το αντίστοιχο από τους πληθυσμούς του ελλαδικού χώρου ανα χρονική περίοδο όπως προκύπτουν από τους (Koukli et al., 2023). Σε αυτή την περίπτωση, εφαρμόζεται one sample t-student test.

Τέλος, ελέγχουμε μετρήσεις μεταξύ αμφιπλευρικών οστών στο ίδιο για να διαπιστώσουμε διαφοροποιήσεις. Εφαρμόζεται two sample t-student test με τη διαφορά οτι απαιτείται μόνο κανονικότητα κατά το Shapiro-Wilk test. Αν δεν πληρείται η προϋπόθεση, εφαρμόζεται Wilcoxon signed-rank test.

Αν απορριφθεί η μηδενική υπόθεση (H0), συμπεραίνουμε ότι υπάρχει στατιστικά σημαντική διαφορά, δηλαδή ότι ο πληθυσμιακός μέσος διαφέρει από την αναμενόμενη τιμή. Η πιθανότητα σφάλματος α εκφράζει τον κίνδυνο να απορρίψουμε τη H0 ενώ είναι αληθής. Όσο μικρότερη είναι η p-τιμή συγκριτικά με α, τόσο μεγαλύτερη η εμπιστοσύνη μας στην απόρριψη της H0. Αν δεν απορριφθεί η H0, δεν τεκμηριώνεται στατιστικά ότι υπάρχει συστηματική διαφοροποίηση, γεγονός που δεν συνεπάγεται την απουσία διαφοροποίησης, αλλά απλώς ότι αυτή δεν μπορεί να αποδειχθεί με τα διαθέσιμα δεδομένα.

Ανάλυση Διακύμανσης (ANalysis Of VAriance-ANOVA)

Σε όλα τα πεδία γίνεται στατιστική ανάλυση των δεδομένων ομαδοποιημένων ανα χρονική περίοδο για την ιχνηλάτηση της εξέλιξης πληθυσμού από την απαρχή του αποικισμού έως την έλευση των Ρωμαίων στην Αμβρακία. Η ομαδοποίηση κατηγοριοποιήθηκε σε αιώνες ξεκινώντας από τον 6ο έως τον 2ο π.Χ. αιώνα.

Στο πεδίο της οστεομετρίας ελέγχουμε αρχικά την κανονικότητα με Shapiro-Wilks και τη διασπορά με F-test. Αν υπάρχει κανονικότητα και ομοιογένεια διασποράς, εφαρμόζουμε ANOVA για να διαπιστώσουμε αν υπάρχουν στατιστικά σημαντικές διαφορές μεταξύ των μέσων όρων ανά χρονική ομάδα. Όταν υπάρχουν, εφαρμόζουμε Tukey HSD test για να υπολογίσουμε αυτές τις διαφορές. Όταν εξαρχής δεν υπάρχει κανονικότητα ή ομοιογένεια διασποράς, αντί για ANOVA test εφαρμόζουμε Games-Howell test.

Ανάλυση Κύριων Συνιστωσών-ΑΚΣ (Principal Component Analysis-PCA)

Eπιχειρούμε να οπτικοποιήσουμε τις πολυπαραγοντικές συσχετίσεις πολλαπλών μεταβλητών. Εφαρμόζουμε Ανάλυση Κύριων Συνιστωσών-ΑΚΣ (Principal Component Analysis-PCA) με σκοπό να εντοπίσουμε συσχετίσεις μεταξύ οστεομετρικών μεταβλητών και παθολογικών δεικτών με την προϋπόθεση οι τελευταίες να είναι ιεραρχικά κατηγοριοποιημένες και οι κατηγορίες να είναι ισοδύναμες. Συγκεκριμένα, παθολογικές αλλοιώσεις όπως LEH και cribra orbitalia δεν έχουν ισοδύναμη κατηγοριοποίηση των βαθμίδων οπότε αποκλείονται από τη συγκεκριμένη μέθοδο. Αντίθετα οι ΟΑ και ΕΑΑ έχουν ισοδύναμες κατηγοριοποιήσεις αφού χρησιμοποιείται η ποσοστιαία βαθμονόμηση των αλλοιώσεων και συνεπώς μπορούν να εφαρμοστούν σε PCA (Calce et al., 2017, p. 477). Για να διορθωθεί ο confounding factor της ηλικίας στην ανάλυση της οστεοαρθρίτιδας προτείνονται δύο μέθοδοι της επιδημιολογίας:

● age-adjustment. Εφαρμόζεται προσαρμογή στις διαφορές των ηλικιακών δομών ενός πληθυσμού αφού συγκριθούν ενδοπληθυσμιακές υποομάδες.

● logistic regression. Εφαρμόζεται έλεγχος των δεδομένων εντός regression πλαισίου για να ληφθούν υπόψη οι επιδράσεις της ηλικίας και άλλων πιθανών confounding μεταβλητών.

Παρόλο που η logreg είναι πιο επαρκής (αφού διερευνά κι άλους confounding παράγοντες εκτός του ηλικιακού), στην παρούσα διατριβή εφαρμόζεται μόνο το ageadj καθώς είναι πιο ισχυρό όταν σκοπός είναι να ελεγχθεί μόνο το confounding της ηλικίας (Baker & Pearson, 2006:218-220).

Ανάλυση Ιεραρχικών Συστάδων-ΑΙΣ (Hierarchical Cluster Analysis-HCA)

Επιπλέον, για τις παλαιοπαθολογικές αλλοιώσεις εφαρμόζουμε Ανάλυση Ιεραρχικών Συστάδων (Hierarchical Cluster Analysis-HCA) με σκοπό να οπτικοποιήσουμε την ομαδοποίηση σκελετικών ατόμων βάσει πολλαπλών μεταβλητών και να εξαχθούν συμπεράσματα σχετικά με τους δημογραφικούς παράγοντες (φύλο και ηλικία) και τον χρονικό παράγοντα (αρχαιολογικές περίοδοι). Δημιουργούμε δενδρογράμματα όπου οπτικοποιούνται οι ομάδες των ατόμων που εμφανίζουν παρόμοια παθολογικά προφίλ και ελέγχεται η διαφορά μεταξύ φύλων, ηλικίας καθώς και η εξέλιξη των διαφορών μέσα στο χρόνο. Η ΑΙΣ δεν απαιτεί την πλήρωση συγκεκριμένων προϋποθέσεων.

Ανάλυση Πολλαπλών Αντιστοιχιών-ΑΠΑ (Multiple Correspondence Analysis \--MCA)

Η MCA εφαρμόζεται κατά τα πρότυπα της PCA με τη διαφορά οτι ανταποκρίνεται καλύτερα σε κατηγορικά δεδομένα. Συνεπώς, στην παρούσα διατριβή εφαρμόζεται προκαταρκτικά (χωρίς έλεγχο σημαντικότητας) μόνο στις κατηγορικές μεταβλητές της ΟΑ (Kinkopf et al 2021, p.502).

Πίνακες γεννητικότητας και θνησιμότητας (life and mortality tables)

Κατά την παλαιοδημογραφική ανάλυση χρησιμοποιήθηκαν δείκτες και πίνακες γεννητικότητας και θνησιμότητας όπου ελέγχονται το μέγεθος , δομή , δυναμική , πυκνότητα , γεννητικότητα , θνησιμότητα του βιοαρχαιολογικού πληθυσμού με σκοπό την εξαγωγή συμπερασμάτων σχετικών με κινητικότητα των πληθυσμών ανά τους αιώνες (Chamberlain, 2006, p. 2).

Οι όροι του πίνακα γεννητικότητας και θνησιμότητας είναι οι εξής

x , Ηλικία στην αρχή της πενταετούς κοόρτης

Lx , Μέσος όρος ετών που ζει ένα άτομο εντός της κοόρτης

Tx , Σύνολο των μέσων όρων ετών που ζει ένα άτομο στην παρούσα και στις επερχόμενες κοόρτες

lx , Επιβιωσιμότητα (η πιθανότητα ένα άτομο από την υποθετική κοόρτη γέννησης να ζει ακόμη στην αρχή της ηλικιακής κοόρτης

dx , Αναλογία θανάτων dx = lx\\\*qx

qx , Πιθανότητα θανάτου

ex , Μέσος χρόνος ετών που απομένουν (μέσο προσδόκιμο ζωής) ex = Tx / lx

Επιπλέον, εφαρμόζονται μοντέλα θνησιμότητας για να ιχνηλατήσουμε τις ανεπαίσθητες αλλά σημαντικές μεταβατικές διαφορές σε μικρές ομάδες (Goodman et al., 1988:196) που οι πίνακες θνησιμότητας δεν μπορούν να αποτυπώσουν. Συγκεκριμένα, εφαρμόζεται το mixed-Makeham model. Αφορά ένα τροποποιημένο μοντέλο Siler model το οποίο με τη σειρά του τροποποιεί το Gompertz and Makeham Model προσθέτωντας μία παράμετρο για τις ανήλικες ηλικιακές ομάδες στις παραμέτρους Gompertz (όλες οι ηλικιακές ομάδες) και Makeham (ώριμη ηλικιακή ομάδα) (Wood et al., 2002, p. 147). Οι τροποποιήσεις αντιμετωπίζουν τους περιορισμούς του μοντέλου Siler σχετικά με την παράμετρο ανηλίκων και την προϋπόθεση της πληθυσμιακής ομοιογένειας.

Δείκτες Γεννητικότητας-ΔΓ (Fertility Indices-FI)

Στην παλαιοδημογραφική ανάλυση υπάρχει πληθώρα δεικτών γεννητικότητας που ικανοποιούν διάφορες προϋποθέσεις. Εφαρμόζονται οι εξής από την ενδεδειγμένη βιβλιογραφία (Bocquet‐Appel, 2002; Klaus & Tam, 2009, p. 360; Gagnon & Wiesen, 2013, pp. 566--567; McFadden & Oxenham, 2018, p. 2; Taylor et al., 2023):

D30+/D5+ (1)

όπου D30+ ο αριθμός των σκελετικών ατόμων μεγαλύτερων ή ίσων των 30 χρόνων (≥ 30yo) και D5+ ο αριθμός των σκελετικών ατόμων μεγαλύτερων ή ίσων των πέντε χρόνων (≥ 5yo).

D0-14/D (2)

όπου D0-14 ο αριθμός των σκελετικών ατόμων μεταξύ 0 και 14 χρόνων (0-14yo) και D όλος ο πληθυσμός.

D5-19/D5+ (3)

όπου D5-19 ο αριθμός των σκελετικών ατόμων μεταξύ πέντε έως 19 χρόνων (5-19yo) και D5+ ο αριθμός των σκελετικών ατόμων μεγαλύτερων ή ίσων των πέντε χρόνων (≥ 5yo). Θεωρείται οτι λειτουργεί καλύτερα σε πληθυσμούς με υποαντιπροσώπευση των νηπίων λόγω ταφονομικών συνθηκών και πρακτικών.

D5-14/D20+ (4)

όπου D5-14 ο αριθμός των σκελετικών ατόμων μεταξύ πέντε έως 14 χρόνων (5-14yo) και D5+ ο αριθμός των σκελετικών ατόμων μεγαλύτερων ή ίσων των 20 χρόνων (≥ 20yo). Ο δείκτης 4 θεωρείται πως λειτουργεί ικανοποιητικά για τους ίδιους λόγους όπως και ο δείκτης 3.

D15-49/D15+ (5)

όπου D15-49 ο αριθμός των σκελετικών ατόμων μεταξύ 15 έως 49 χρόνων (15-49yo) και D15+ ο αριθμός των σκελετικών ατόμων μεγαλύτερων ή ίσων των 15 χρόνων (≥ 15yo). Αυτός ο δείκτης προσαρμόζεται παρακάτω στο δείκτη TFR σύμφωνα με τους Taylor et al. (2023).

TFR = \\\[8,564\\\*(D15-49/D15+)\\\]+2,508 (6)

Οι δείκτες 5 και 6 είναι καταλληλότεροι για χρήση σε πληθυσμούς όπου παρατηρείται υποαντιπροσώπευση όχι μόνο νηπίων αλλά και παιδιών.

Δείκτης Εξάρτησης (Dependency Ratio)

Οι δείκτες γεννητικότητας αντιπαραβάλλονται με το δείκτη εξάρτησης για να ελεγθεί ο φόρτος εξάρτησης (Dependency Burden) των μη παραγωγικών ατόμων (ανήλικοι και γέροι) από τις παραγωγικές ηλικίες (21-45 ετών) όπως προσαρμόστηκε από τη βιβλιογραφία (Chamberlain, 2006) για τις ανάγκες του πληθυσμού της Αμβρακίας..

(D0-15 + D50+)/D15-50 (7)

όπου D0-15 ο αριθμός των σκελετικών ατόμων μεταξύ 0 και 15 χρόνων (0-15yo), D50+ ο αριθμός των σκελετικών ατόμων μεγαλύτερων ή ίσων των 50 χρόνων (≥50yo) και D15-50 ο αριθμός των σκελετικών ατόμων μεταξύ 15-50 χρόνων (15-50yo).

Δείκτες Θνησιμότητας

Ο Δείκτης Ρυθμού Θνησιμότητας (Death Rate Ratio-DRR) εκφράζει το ρυθμό θνησιμότητας μεταξύ ηλικιακών ομάδων. Αποτελεί αξιόπιστο δείκτη ευπάθειας στο πλαίσιο μελέτης ενός πληθυσμού (Hoppa & Vaupel, 2002b, p. 170). Ενδεικτικά, αναφέρουν το δείκτη συσχέτισης νηπίων έναντι παιδιών και εφήβων:

D5-18/D2-5 (8)

όπου D5-18 είναι ο αριθμός σκελετικών ατόμων μεταξύ 5 και 18 χρόνων (5-18yo) και D2-5 ο αριθμός των σκελετικών ατόμων μεταξύ 2 και 5 χρόνων (2-5yo). Όσο μικρότερο του 1 είναι το πηλίκο τόσο μεγαλύτερη η νηπιακή θνησιμότητα και αντίστροφα. Όταν εφαρμόζεται σε άλλες ηλικιακές ομάδες λαμβάνεται υπόψη το bias της υποαντιπροσώπευσης των ανήλικων στους αρχαιολογικούς πληθυσμούς.

Ο δείκτης θνησιμότητας d όπως προτάθηκε από τους Bocquet‐Appel (2002) και εφαρμόστηκε από τους Barbiera et al. (2018, p. 2054) ιχνηλατεί τις τάσεις θνησιμότητας ενός αρχαιολογικού πληθυσμού. Υπολογίζεται ως εξής:

D5-19/D5+ (9)

όπου D5-1 είναι ο αριθμός σκελετικών ατόμων μεταξύ 5 και 19 χρόνων (5-19yo) και D5+ ο αριθμός των σκελετικών ατόμων μεγαλύτερων ή ίσων των 5 χρόνων (≥5yo).

Εξίσωση Γενικευμένης Εκτίμησης \-- ΕΓΕ (General Estimating Equation- GEE)

Ένα ζήτημα που τίθεται συχνά στην οδοντική παλαιοπαθολογία είναι σε ποιο επίπεδο πρέπει να εφαρμόζεται η ανάλυση. Τα δόντια αποτελούν ένα ιδιαίτερο βιοαρχαιολογικό εύρημα καθώς το κάθε ένα από αυτά αποτελεί μία πλούσια πηγή στατιστικών δεδομένων είτε από μόνο του είτε στο σύνολο του δείγματος. Αποτελεί όμως και βασικό τμήμα του σκελετικού ατόμου δίνοντας πληροφορίες από διαφορετική σκοπιά. Στην παρούσα διατριβή εφαρμόζεται περιγραφική στατιστική για το κάθε τύπο δοντιού μεμονωμένα ενώ η Εξίσωση Γενικευμένης Εκτίμησης (GEE) εφαρμόζεται για την ολιστική προσέγγιση των οδοντικών παθολογικών δεικτών (Nikita et al., 2013, p. 107).

Το GEE προτιμήθηκε στις οδοντικές παθολογικές ενδείξεις (Gagnon & Wiesen, 2013, p. 561) γιατί είναι προσαρμοστικό σε κανονικά κατανεμημένες (normally distributed) παραμέτρους και χειρίζεται τις τιμές που λείπουν (missing values) καλύτερα. Συγκεκριμένα, οι συγγραφείς υποστηρίζουν οτι εφαρμόζοντας την Εξίσωση Γενικευμένης Εκτίμησης με μία «στρατηγική δειγματοληψίας 2-σταδίων» μπορούν να περιορίσουν τα σφάλματα του pooling όλων των οδόντων και να αυξήσουν τη στατιστικη δύναμη της ανάλυσης. Δειγματίζοντας σε πρώτο στάδιο όλα τα δόντια αυξάνεται η στατιστική δύναμη και δειγματίζοντας σε δεύτερο στάδιο ανά άτομο επιτρέπουμε στην εξίσωση να διορθώσει το πρώτο δείγμα. Με σκοπό να χρησιμοποιηθούν τα άτομα ως δείγμα οφείλουμε να παραμετροποιήσουμε τα ίδια τα άτομα ως διωνυμικά (παρουσία-απουσία ένδειξης) αφού ορίσουμε ποσοστιαία το κατώφλι εμφάνισης των παθολογικών ενδείξεων στο σύνολο των παρόντων οδόντων.

Η ΕΓΕ εφαρμόζεται σε μοντέλα λογιστικής παλινδρόμησης για κατηγορικά δεδομένα και γραμμική παλινδρόμηση για αριθμητικά δεδομένα. Αρχικά, εντάσουμε διαφορετικά δεδομένα μέσα σε ένα πλαίσιο συσχέτισης. Στην παρούσα έρευνα, το πλαίσιο συσχέτισης ορίζεται ως ταυτοτικό (identity correlation matrix) γιατί είναι η απλούστερη επιλογή μεταξύ των επιλογών που παρέχει η μέθοδος και έχει αποδειχθεί καταλληλότερη για μελέτη βιοαρχαιολογικού υλικού (χωρίς αυτό να σημαίνει πως οι άλλες επιλογές δίνουν τελείως διαφορετικά αποτελέσματα). (Gagnon & Wiesen, 2013, p. 562). Σε αυτή τη μέθοδο μπορούμε να προσθέσουμε ως επιπλέον μεταβλητή τη θέση του δοντιού στην οδοντοστοιχεία σταθμίζοντας το μοντέλο σύμφωνα με την προσοκώμενη εμφάνιση του κάθε τύπου. Συγκεκριμένα, ορίζουμε τον τύπο οδόντος με τέσσερεις τιμές βάσει θέσης στην οδοντοστοιχεία (άνω πρόσθιοι, κάτω πρόσθιοι, άνω οπίσθιοι και κάτω οπίσθιοι). Στη σχετική μέθοδο της βιβλιογραφίας οι τύποι δεν διαχωρίζονται σε άνω και κάτω αλλά μόνο σε πρόσθιους, προγόμφιους, πρώτους ή και δεύτερους γομφίους, και τρίτους γομφίους. Ωστόσο, στην παρούσα διατριβή επιλέχθηκε ο επιπλεόν διαχωρισμός για να ελεγχθούν πιθανές διαφορές μεταξύ των οδόντων της άνω και κάτω γνάθου. Επιπλέον, ομαδοποιήθηκαν οι προγόμφιοι με τους γομφίους λόγω της σχετικής ομοιομορφίας. Κατά συνέπεια η στάθμιση ορίζεται στο 0,1875 για τους άνω πρόσθιους, 0,3125 για τους άνω οπίσθιους, 0,1875 για τους κάτω πρόσθιους και 0,3125 για τους κάτω οπίσθιους.

Πολυπαραμετρικό Γενικευμένο Γραμμικό Μεικτό Μοντέλο-ΠΓΓΜΜ (Multivariate Generalised Linear Mixed Models-MGLMM)

Το ίδιο σκεπτικό ισχύει και στο MGLMM αφού και αυτό το μοντέλο (όπως και το GEE) βασίζεται στο Γενικευμένο Γραμμικό Μοντέλο (GLM). Η διαφορά είναι πως το GEE ανταποκρίνεται καλύτερα στα δόντια που επιτελούν ίδια εργασία και καταπονούνται πιο ομοιόμορφα έναντι συγκεκριμένων παθήσεων ενώ το ΜGLMM προτιμήθηκε στις κρανιακές και μετακρανιακές παθολογικές ενδείξεις καθώς αντιμετωπίζει καλύτερα τις διαφορές μεταξύ διαφορετικών σκελετικών συστημάτων που υπόκεινται σε διαφορετικό φόρτο εργασίας (Nikita et al., 2013, p. 107; Alonso‐Llamazares et al., 2021, p. 2)

Skeletal Frailty Index-SFI

Στη παρούσα μελέτη εφαρμόζεται το μοντέλο Σκελετικού Δείκτη Ευπάθειας (Skeletal Frailty Index-SFI) των Marklein & Crews (2017) το οποίο καλύπτει όλα τα παραπάνω πεδία. Ο ορισμός Ευπάθεια στην βιοαρχαιολογια δεν ακολουθεί τους αντίστοιχους της σύγχρονης ιατρικής \--η οποία ακόμα δυσκολεύεται να καταλήξει σε ένα κοινά αποδεκτό ορισμό όπως αναφέρεται στον Ανδρέου (2019, p.4)- αλλά ως η κυμαινόμενη σωματική κατάσταση των αθροιστικών δυσλειτουργιών η οποία αυξάνεται με την ηλικία σχετικά ανεξάρτητα από το ρίσκο θνησιμότητας.

1η ΥΠΟΘΕΣΗ

Σύμφωνα με τους Godde & Hens (2021, p.634) οφείλουμε να θέσουμε ερωτήματα που σχετίζονται με την κοινωνικοοικονομική κατάσταση του πληθυσμού. Ποια ήταν τα επίπεδα επιβίωσης των πρώτων αποικιστικών ομάδων; Πόσο ευπαθείς ήταν οι αρχικές γενιές αποίκων συγκριτικά με τις επόμενες γενιές των Αμβρακιωτών;

Σύμφωνα με τους Kubehl & Temple (2020, p.378) τα άτομα με τερηδόνα εμφανίζουν μειωμένη πιθανότητα επιβίωσης σε αντιπαραβολή με τα άτομα χωρίς τερηδόνα. Διευρύνουμε την υπόθεση σε όλες τις οδοντικές ενδείξεις και εφαρμόζουμε σχετικές αναλύσεις επιβίωσης για να διαπιστώσουμε τη συσχέτιση. Σύμφωνα με τους ίδιους (ο.π. , p. 379) οι τιμές της τερηδόνας αλλάζουν αναφορικά με την ηλικία, το φύλο και μία ακόμα οδοντική ασθένεια. Παράλληλα, ελέγχουμε τις διακυμάνσεις των τιμών βάσει ανεξάρτητων παραμέτρων.

2η ΥΠΟΘΕΣΗ

Σύμφωνα με τους Kinkopf et al (2021, p.502) θέτουμε ερωτήματα εργασιακής καταπόνησης του πληθυσμού της Αμβρακίας σε χρονικό και δημογραφικό επίπεδο. Παρατηρούνται διαφορές μεταξύ των φύλων και των ηλικιακών ομάδων που να υποδεικνύουν διαφορετική κατανομή εργασιών; Υπάρχουν διαφορές μεταξύ των χρονικών περιόδων που να υποστηρίζουν κάποιου είδους μεταστροφή στους τύπους απασχόλησης;

Συγκεκριμένα, τα ερωτήματα που απαιτούνται να απαντηθούν είναι

1\. κατά πόσο οι άνω και κάτω οπίσθιες αρθρικές επιφάνειες έχουν διαφορετική κατανομή ΟΑ από τις αντίστοιχες αρθρικές επιφάνειες του σπονδυλικού σώματος. Οι έρευνες υποδεικνύουν μεγαλύτερη συχνότητα στις οπίσθιες στις περιπτώσεις δραστηριοτήτων μεταφοράς φορτίων/βάρους (Kinkopf et al., 2021, p.501).

2\. υπάρχει διαφορά στην κατανομή ΟΑ (Kinkopf et al., 2021, p.501) μεταξύ των σπονδυλικών μοιρών και των φύλων;

3η ΥΠΟΘΕΣΗ

Σύμφωνα με την DeWitte (2014) θέτουμε ερωτήματα σχετικά με το ανοσοποιητικό σύστημα του πληθυσμού της Αμβρακίας. Αρχικά, ελέγχεται η υπόθεση της θετικής συσχέτισης μεταξύ της οδοντικής παθολογίας, Πορώδους Υπερόστωσης, Cribra Orbitalia και Περιοστίτιδας καθώς θεωρείται πως υπάρχει θετική συσχέτιση (DeWitte, 2014, p. 43). Η θετική συσχέτιση μεταξύ των οδοντικών και των περιοστικών αλλοιώσεων θεωρείται ως proxy αδύναμου ανοσοποιητικού συστήματος. Ποιες διαφορές παρατηρούνται μεταξύ των χρονικών περιόδων και ποιοι παράγοντες μπορεί να θεωρηθούν αιτιολογικοί;

4η ΥΠΟΘΕΣΗ

Βάσει της προηγούμενης υπόθεσης ελέγχεται η υπόθεση της συσχέτισης μεταξύ της οδοντικής παθολογίας και της OA για να διαπιστωθεί αρχικά το πρόσημο καθώς δεν έχουν εντοπιστεί μελέτες που να έχουν ελέγξει την εν λόγω υπόθεση (Kinkopf et al., 2021, p.501). Έστω οτι η παρουσία ΟΑ σε νεαρούς και μέσους ενήλικους παρατηρείται σε άτομα ελαφριάς εργασιακής καταπόνησης και η παρουσία τερηδόνας στις ίδιες ομάδες υποδηλώνει διατροφικές συνήθειες υψηλής υδατανθρακικής αξίας. Η θετική συσχέτιση σημαίνει πως άτομα ελαφριάς απασχόλησης και συνεπώς υψηλού κοινωνικού στάτους τρέφονταν συχνότερα με περισσότερους υδατάνθρακες;

Στη παρούσα μελέτη εφαρμόζεται το μοντέλο Σκελετικού Δείκτη Ευπάθειας (Skeletal Frailty Index-SFI) των Marklein & Crews (2017) το οποίο καλύπτει όλα τα παραπάνω πεδία. Ο ορισμός Ευπάθεια στην βιοαρχαιολογια δεν ακολουθεί τους αντίστοιχους της σύγχρονης ιατρικής \--η οποία ακόμα δυσκολεύεται να καταλήξει σε ένα κοινά αποδεκτό ορισμό όπως αναφέρεται στον Ανδρέου (2019, p.4)- αλλά ως η κυμαινόμενη σωματική κατάσταση των αθροιστικών δυσλειτουργιών η οποία αυξάνεται με την ηλικία σχετικά ανεξάρτητα από το ρίσκο θνησιμότητας.
